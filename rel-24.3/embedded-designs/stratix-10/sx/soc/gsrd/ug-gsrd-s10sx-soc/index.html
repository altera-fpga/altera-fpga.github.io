
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://altera-fpga.github.io/rel-24.3/embedded-designs/stratix-10/sx/soc/gsrd/ug-gsrd-s10sx-soc/">
      
      
        <link rel="prev" href="../../../../../agilex-7/m-series/pcie_rp/ug-pcie_rp-agx7m-hbm2e/">
      
      
        <link rel="next" href="../../rsu/ug-rsu-s10sx-soc/">
      
      <link rel="icon" href="../../../../../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.9">
    
    
      
        <title>GSRD User Guide - Altera FPGA Developer Site</title>
      
    
    
      <link rel="stylesheet" href="../../../../../../assets/stylesheets/main.85bb2934.min.css">
      
        
        <link rel="stylesheet" href="../../../../../../assets/stylesheets/palette.a6bdf11c.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../../../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#overview" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../../.." title="Altera FPGA Developer Site" class="md-header__button md-logo" aria-label="Altera FPGA Developer Site" data-md-component="logo">
      
  <img src="../../../../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Altera FPGA Developer Site
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              GSRD User Guide
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/altera-fpga" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    altera-fpga
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../../../.." class="md-tabs__link">
      Welcome
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../driver-list_linux/" class="md-tabs__link">
        Linux Drivers
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../driver-list_zephyr/" class="md-tabs__link">
        Zephyr Drivers
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../driver-list_baremetal/" class="md-tabs__link">
        Baremetal Drivers
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../sw-tools-list/host-attach-tools/" class="md-tabs__link">
        Host Attach Utilities
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../ed-demo-list/ed-list/" class="md-tabs__link md-tabs__link--active">
        Example Designs
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../ed-demo-list/demo-list/" class="md-tabs__link">
        Demos
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../../.." title="Altera FPGA Developer Site" class="md-nav__button md-logo" aria-label="Altera FPGA Developer Site" data-md-component="logo">
      
  <img src="../../../../../../assets/logo.png" alt="logo">

    </a>
    Altera FPGA Developer Site
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/altera-fpga" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    altera-fpga
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../../.." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../../../driver-list_linux/">Linux Drivers</a>
          
            <label for="__nav_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Linux Drivers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
          HPS Host Drivers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          HPS Host Drivers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/hwmon/hwmon/" class="md-nav__link">
        Altera Hardware Monitor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/clock_manager/clock_manager/" class="md-nav__link">
        Clock Manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/dma/dma/" class="md-nav__link">
        DMA Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/edac/edac/" class="md-nav__link">
        Error Detection & Correction (EDAC)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/ptp_tod/ptp_emb_tod/" class="md-nav__link">
        Ethernet 1588 PTP Time of Day Clock
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/emac/emac/" class="md-nav__link">
        Ethernet Media Access Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/hssi/hssi/" class="md-nav__link">
        Ethernet Subsystem FPGA IP MAC Specific Ctrl
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/hssi_xtile/hssi_xtile/" class="md-nav__link">
        Ethernet Subsystem FPGA IP Tile Specific Ctrl
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/apb_timers/apb_timers/" class="md-nav__link">
        General Purpose Timers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/gpio/gpio/" class="md-nav__link">
        General Purpose I/O (GPIO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/i2c/i2c/" class="md-nav__link">
        I2C
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/i3c/i3c/" class="md-nav__link">
        I3C
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/interrupt_controller_GICv3/irq_gic_v3/" class="md-nav__link">
        Interrupt Controller (GICv3)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/msgdma/msgdma/" class="md-nav__link">
        MSGDMA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/nand/nand/" class="md-nav__link">
        NAND Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/qsfp/qsfp/" class="md-nav__link">
        QSFP Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/qspi/qspi/" class="md-nav__link">
        QSPI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/reset_manager/reset_manager/" class="md-nav__link">
        Reset Manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/sd-emmc/sd-emmc/" class="md-nav__link">
        SD/eMMC Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/spi/spi/" class="md-nav__link">
        SPI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/system_manager/system_manager/" class="md-nav__link">
        System Manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/smmu/smmu/" class="md-nav__link">
        System Memory Management Unit
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/uart/uart/" class="md-nav__link">
        UART
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/usb2_0_otg/usb_2_0_otg/" class="md-nav__link">
        USB 2.0 OTG
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/watchdog_timers/watchdog_timers/" class="md-nav__link">
        Watchdog Timers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/zarlink_clock_synchronizer/zarlink_clock_synchronizer/" class="md-nav__link">
        Zarlink Clock Synchronizer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
          PCIe Host Drivers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          PCIe Host Drivers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/uart_16550/uart_16550/" class="md-nav__link">
        Altera 16550 Compatible UART
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/dfl_afu/dfl_afu/" class="md-nav__link">
        Accelerator Functional Unit
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/intel_m10_bmc_core/intel_m10_bmc_core/" class="md-nav__link">
        Board Management Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/dfl/dfl/" class="md-nav__link">
        Device Feature List
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/s10hssi/s10hssi/" class="md-nav__link">
        Ethernet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/ptp_dfl_tod/ptp_dfl_tod/" class="md-nav__link">
        Ethernet 1588 PTP Time of Day Clock
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/dfl_fme/dfl_fme/" class="md-nav__link">
        FPGA Management Engine
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/dfl_pci/dfl_pci/" class="md-nav__link">
        PCIe Subsystem
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/dfl_emif/dfl_emif/" class="md-nav__link">
        Memory Interface
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/intel_m10_bmc_core/intel_m10_bmc_core/" class="md-nav__link">
        MAX 10 Board Management Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/spi_altera_dfl/spi_altera_dfl/" class="md-nav__link">
        SPI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/uio_dfl/uio_dfl/" class="md-nav__link">
        User space I/O (UIO)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../../../driver-list_zephyr/">Zephyr Drivers</a>
          
            <label for="__nav_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Zephyr Drivers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          HPS Zephyr Drivers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          HPS Zephyr Drivers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../zephyr-embedded/clock_manager/clock_manager/" class="md-nav__link">
        Clock Manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../zephyr-embedded/psci/psci/" class="md-nav__link">
        Cold & Warm Reset -Power State Coordination Interface (PSCI)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../zephyr-embedded/dma/dma/" class="md-nav__link">
        DMA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../zephyr-embedded/timer/timer/" class="md-nav__link">
        General Purpose Timer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../zephyr-embedded/gpio/gpio/" class="md-nav__link">
        GPIO
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../zephyr-embedded/qspi/qspi/" class="md-nav__link">
        Quad SPI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../zephyr-embedded/reset_manager/reset_manager/" class="md-nav__link">
        Reset Manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../zephyr-embedded/seu/seu/" class="md-nav__link">
        Single Event Upset (SEU)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../zephyr-embedded/smp/smp/" class="md-nav__link">
        SMP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../zephyr-embedded/uart/uart/" class="md-nav__link">
        UART
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../zephyr-embedded/watchdog/watchdog/" class="md-nav__link">
        Watchdog Timer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../../../driver-list_baremetal/">Baremetal Drivers</a>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Baremetal Drivers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Host Attach Utilities
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Host Attach Utilities
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../sw-tools-list/host-attach-tools/" class="md-nav__link">
        Host Attach Utilities Summary
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/fpgaconf/fpgaconf/" class="md-nav__link">
        fpgaconf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/fpgad/fpgad/" class="md-nav__link">
        fpgad
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/fpgainfo/fpgainfo/" class="md-nav__link">
        fpgainfo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/fpgaport/fpgaport/" class="md-nav__link">
        fpgaport
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/fpgasupdate/fpgasupdate/" class="md-nav__link">
        fpgasupdate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/hssi/hssi/" class="md-nav__link">
        hssi
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/host_exerciser/host_exerciser/" class="md-nav__link">
        host_exerciser
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/hssi_ethernet/hssimac/" class="md-nav__link">
        HSSI ethernet loopback
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/hssi_ethernet/hssistats/" class="md-nav__link">
        HSSI ethernet statistics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/hssi_ethernet/hssimac/" class="md-nav__link">
        HSSI ethernet mac
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/mem_tg/mem_tg/" class="md-nav__link">
        mem_tg
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/mmlink/mmlink/" class="md-nav__link">
        mmlink
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/ofs_uio/ofs_uio/" class="md-nav__link">
        ofs.uio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/opae_io/opae_io/" class="md-nav__link">
        opae.io
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/opaeuio/opaeuio/" class="md-nav__link">
        opaeuio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/opaevfio/opaevfio/" class="md-nav__link">
        opaevfio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/pac_hssi_config/pac_hssi_config/" class="md-nav__link">
        pac_hssi_config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/packager/packager/" class="md-nav__link">
        packager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/pci_device/pci_device/" class="md-nav__link">
        pci_device
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/rsu/rsu/" class="md-nav__link">
        rsu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/userclk/userclk/" class="md-nav__link">
        userclk
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/vabtool/vabtool/" class="md-nav__link">
        vabtool
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Example Designs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Example Designs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../ed-demo-list/ed-list/" class="md-nav__link">
        Summary
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
          Agilex™ 5
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_2">
          <span class="md-nav__icon md-icon"></span>
          Agilex™ 5
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2_1" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_2_1" id="__nav_6_2_1_label" tabindex="0">
          E-Series Premium Development Kit
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_2_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_2_1">
          <span class="md-nav__icon md-icon"></span>
          E-Series Premium Development Kit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-5/e-series/premium/gsrd/ug-gsrd-agx5e-premium/" class="md-nav__link">
        GSRD User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-5/e-series/premium/gsrd_zephyr/ug-zgsrd-agx5e-premium/" class="md-nav__link">
        Zephyr GSRD User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-5/e-series/premium/boot-examples/ug-linux-boot-agx5e-premium/" class="md-nav__link">
        GHRD Linux Boot Examples
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2_1_4" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_2_1_4" id="__nav_6_2_1_4_label" tabindex="0">
          TSN Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_2_1_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_2_1_4">
          <span class="md-nav__icon md-icon"></span>
          TSN Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-5/e-series/premium/tsn/rgmii-hps/ug-tsncfg1-agx5e-premium/" class="md-nav__link">
        TSN - HPS RGMII System
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-5/e-series/premium/tsn/sgmii_xcvr/ug-tsn-sgmii-xcvr-agilex5/" class="md-nav__link">
        TSN - SGMII XCVR System
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-5/e-series/premium/remote-debug/ug-remote-debug-agx5e-premium/" class="md-nav__link">
        FPGA Remote Debug Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-5/e-series/premium/rsu/ug-rsu-agx5e-soc/" class="md-nav__link">
        SoC HPS Remote System Update Example
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2_2" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_2_2" id="__nav_6_2_2_label" tabindex="0">
          E-Series Modular Development Kit
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_2_2">
          <span class="md-nav__icon md-icon"></span>
          E-Series Modular Development Kit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-5/e-series/modular/gsrd/ug-gsrd-agx5e-modular/" class="md-nav__link">
        GSRD User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-5/e-series/modular/boot-examples/ug-linux-boot-agx5e-modular/" class="md-nav__link">
        GHRD Linux Boot Examples
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2_3" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_2_3" id="__nav_6_2_3_label" tabindex="0">
          Intel Simics Virtual Platform Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_2_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_2_3">
          <span class="md-nav__icon md-icon"></span>
          Intel Simics Virtual Platform Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-5/common/virtual-platforms/linux-gsrd/ug-linux-gsrd-agilex5-virtual-platforms/" class="md-nav__link">
        Linux GSRD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-5/common/virtual-platforms/zephyr-gsrd/ug-zephyr-gsrd-agilex5-virtual-platforms/" class="md-nav__link">
        Zephyr GSRD
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
          Agilex™ 7
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_3">
          <span class="md-nav__icon md-icon"></span>
          Agilex™ 7
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3_1" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_3_1" id="__nav_6_3_1_label" tabindex="0">
          F-Series SoC Development Kit
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_3_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_3_1">
          <span class="md-nav__icon md-icon"></span>
          F-Series SoC Development Kit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/f-series/soc/gsrd/ug-gsrd-agx7f-soc/" class="md-nav__link">
        GSRD User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/f-series/soc/rsu/ug-rsu-agx7f-soc/" class="md-nav__link">
        SoC HPS Remote System Update Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/f-series/soc/rsu/ug-rsu-multiqspi-agx7f-soc/" class="md-nav__link">
        SoC HPS Multi-QSPI Remote System Update Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/f-series/soc/remote-debug/ug-remote-debug-agx7f-soc/" class="md-nav__link">
        SoC FPGA Remote Debug Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/f-series/soc/emmc/ug-emmc-agx7f-soc/" class="md-nav__link">
        HPS eMMC Boot Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/f-series/soc/fabric-config/ug-linux-fabric-config-agx7f-soc/" class="md-nav__link">
        SoC Fabric Configuration from Linux Example
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3_2" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_3_2" id="__nav_6_3_2_label" tabindex="0">
          I-Series FPGA Development Kit
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_3_2">
          <span class="md-nav__icon md-icon"></span>
          I-Series FPGA Development Kit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/i-series/soc/gsrd/ug-gsrd-agx7i-soc/" class="md-nav__link">
        GSRD User Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3_3" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_3_3" id="__nav_6_3_3_label" tabindex="0">
          M-Series HBM2e Development Kit
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_3_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6_3_3">
          <span class="md-nav__icon md-icon"></span>
          M-Series HBM2e Development Kit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/m-series/hbm2e/ug-gsrd-agx7m-hbm2e/" class="md-nav__link">
        GSRD User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/m-series/pcie_rp/ug-pcie_rp-agx7m-hbm2e/" class="md-nav__link">
        PCIe Root Port User Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" checked>
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
          Stratix® 10
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_6_4">
          <span class="md-nav__icon md-icon"></span>
          Stratix® 10
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_1" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6_4_1" id="__nav_6_4_1_label" tabindex="0">
          SX SoC Development Kit
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_4_1_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_6_4_1">
          <span class="md-nav__icon md-icon"></span>
          SX SoC Development Kit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          GSRD User Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        GSRD User Guide
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#release-contents" class="md-nav__link">
    Release Contents
  </a>
  
    <nav class="md-nav" aria-label="Release Contents">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#release-notes" class="md-nav__link">
    Release Notes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prebuilt-binaries" class="md-nav__link">
    Prebuilt Binaries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#component-versions" class="md-nav__link">
    Component Versions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ghrd-overview" class="md-nav__link">
    GHRD Overview
  </a>
  
    <nav class="md-nav" aria-label="GHRD Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mpu-address-maps" class="md-nav__link">
    MPU Address Maps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jtag-master-address-map" class="md-nav__link">
    JTAG Master Address Map
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interrupt-routing" class="md-nav__link">
    Interrupt Routing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typical-hps-boot-flow" class="md-nav__link">
    Typical HPS Boot Flow
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-prebuilt-gsrd" class="md-nav__link">
    Exercise Prebuilt GSRD
  </a>
  
    <nav class="md-nav" aria-label="Exercise Prebuilt GSRD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configure-board" class="md-nav__link">
    Configure Board
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-serial-connection" class="md-nav__link">
    Configure Serial Connection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-from-sd-card" class="md-nav__link">
    Boot from SD Card
  </a>
  
    <nav class="md-nav" aria-label="Boot from SD Card">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#write-qspi-image" class="md-nav__link">
    Write QSPI Image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-sd-card-image" class="md-nav__link">
    Write SD Card Image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-linux" class="md-nav__link">
    Boot Linux
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-sample-applications" class="md-nav__link">
    Run Sample Applications
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#register-interrupts" class="md-nav__link">
    Register Interrupts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect-to-web-server" class="md-nav__link">
    Connect to Web Server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect-using-ssh" class="md-nav__link">
    Connect Using SSH
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-from-qspi" class="md-nav__link">
    Boot from QSPI
  </a>
  
    <nav class="md-nav" aria-label="Boot from QSPI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#write-qspi-image_1" class="md-nav__link">
    Write QSPI Image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-linux_1" class="md-nav__link">
    Boot Linux
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-from-nand" class="md-nav__link">
    Boot from NAND
  </a>
  
    <nav class="md-nav" aria-label="Boot from NAND">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nand-daughtercard" class="md-nav__link">
    NAND Daughtercard
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-nand-binaries" class="md-nav__link">
    Write NAND Binaries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-qspi-image_2" class="md-nav__link">
    Write QSPI Image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-linux_2" class="md-nav__link">
    Boot Linux
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partial-reconfiguration" class="md-nav__link">
    Partial Reconfiguration
  </a>
  
    <nav class="md-nav" aria-label="Partial Reconfiguration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reference-information" class="md-nav__link">
    Reference Information
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardware-design" class="md-nav__link">
    Hardware Design
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pr-files" class="md-nav__link">
    PR Files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-pr-scenarios" class="md-nav__link">
    Running PR Scenarios
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rebuild-the-gsrd" class="md-nav__link">
    Rebuild the GSRD
  </a>
  
    <nav class="md-nav" aria-label="Rebuild the GSRD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#boot-from-sd-card_1" class="md-nav__link">
    Boot from SD Card
  </a>
  
    <nav class="md-nav" aria-label="Boot from SD Card">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#build-flow" class="md-nav__link">
    Build Flow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up-environment" class="md-nav__link">
    Set up Environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-hardware-design" class="md-nav__link">
    Build Hardware Design
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-core-rbf" class="md-nav__link">
    Build Core RBF
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up-yocto" class="md-nav__link">
    Set Up Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#customize-yocto" class="md-nav__link">
    Customize Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-yocto" class="md-nav__link">
    Build Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-qspi-image" class="md-nav__link">
    Create QSPI Image
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-from-qspi_1" class="md-nav__link">
    Boot from QSPI
  </a>
  
    <nav class="md-nav" aria-label="Boot from QSPI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qspi-flash-layout" class="md-nav__link">
    QSPI Flash Layout
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-qspi-image_1" class="md-nav__link">
    Create QSPI Image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-programming-file-generator-file" class="md-nav__link">
    Create Programming File Generator File
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-from-nand_1" class="md-nav__link">
    Boot from NAND
  </a>
  
    <nav class="md-nav" aria-label="Boot from NAND">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nand-flash-layout" class="md-nav__link">
    NAND Flash Layout
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up-environment_1" class="md-nav__link">
    Set up Environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-hardware-design_1" class="md-nav__link">
    Build Hardware Design
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-core-rbf_1" class="md-nav__link">
    Build Core RBF
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up-yocto_1" class="md-nav__link">
    Set Up Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#customize-yocto_1" class="md-nav__link">
    Customize Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-yocto_1" class="md-nav__link">
    Build Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-qspi-image_2" class="md-nav__link">
    Create QSPI Image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-nand-binaries" class="md-nav__link">
    Build NAND Binaries
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partial-reconfiguration_1" class="md-nav__link">
    Partial Reconfiguration
  </a>
  
    <nav class="md-nav" aria-label="Partial Reconfiguration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#build-flow_1" class="md-nav__link">
    Build Flow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up-environment_2" class="md-nav__link">
    Set up Environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-hardware-design_2" class="md-nav__link">
    Build Hardware Design
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-core-rbf_2" class="md-nav__link">
    Build Core RBF
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up-yocto_2" class="md-nav__link">
    Set Up Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#customize-yocto_2" class="md-nav__link">
    Customize Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-yocto_2" class="md-nav__link">
    Build Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-qspi-image_3" class="md-nav__link">
    Create QSPI Image
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-from-sd-card-on-dk-soc-1ssx-l-d" class="md-nav__link">
    Boot from SD Card on DK-SOC-1SSX-L-D
  </a>
  
    <nav class="md-nav" aria-label="Boot from SD Card on DK-SOC-1SSX-L-D">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#build-flow_2" class="md-nav__link">
    Build Flow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up-environment_3" class="md-nav__link">
    Set up Environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-hardware-design_3" class="md-nav__link">
    Build Hardware Design
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-core-rbf_3" class="md-nav__link">
    Build Core RBF
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up-yocto_3" class="md-nav__link">
    Set Up Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#customize-yocto_3" class="md-nav__link">
    Customize Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-yocto_3" class="md-nav__link">
    Build Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-qspi-image_4" class="md-nav__link">
    Create QSPI Image
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notices-disclaimers" class="md-nav__link">
    Notices &amp; Disclaimers
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rsu/ug-rsu-s10sx-soc/" class="md-nav__link">
        SoC HPS Remote System Update Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../remote-debug/ug-remote-debug-s10sx-soc/" class="md-nav__link">
        SoC FPGA Remote Debug Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../emmc/ug-emmc-s10sx-soc/" class="md-nav__link">
        HPS eMMC Boot Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fabric-config/ug-linux-fabric-config-s10sx-soc/" class="md-nav__link">
        SoC Fabric Configuration from Linux Example
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Demos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Demos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../ed-demo-list/demo-list/" class="md-nav__link">
        Summary
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
          Agilex™ 5
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_2">
          <span class="md-nav__icon md-icon"></span>
          Agilex™ 5
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2_1" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_2_1" id="__nav_7_2_1_label" tabindex="0">
          E-Series Premium Development Kit
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_2_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_2_1">
          <span class="md-nav__icon md-icon"></span>
          E-Series Premium Development Kit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../baremetal-embedded/agilex-5/e-series/premium/ug-baremetal-agx5e-premium/" class="md-nav__link">
        Baremetal Hello World Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/altera-fpga/agilex5-demo-hps2fpga-interfaces/blob/main/documentation/01_index.md" class="md-nav__link">
        Third Party Boards - HPS-FPGA Interfaces Demos User Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#release-contents" class="md-nav__link">
    Release Contents
  </a>
  
    <nav class="md-nav" aria-label="Release Contents">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#release-notes" class="md-nav__link">
    Release Notes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prebuilt-binaries" class="md-nav__link">
    Prebuilt Binaries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#component-versions" class="md-nav__link">
    Component Versions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ghrd-overview" class="md-nav__link">
    GHRD Overview
  </a>
  
    <nav class="md-nav" aria-label="GHRD Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mpu-address-maps" class="md-nav__link">
    MPU Address Maps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jtag-master-address-map" class="md-nav__link">
    JTAG Master Address Map
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interrupt-routing" class="md-nav__link">
    Interrupt Routing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typical-hps-boot-flow" class="md-nav__link">
    Typical HPS Boot Flow
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-prebuilt-gsrd" class="md-nav__link">
    Exercise Prebuilt GSRD
  </a>
  
    <nav class="md-nav" aria-label="Exercise Prebuilt GSRD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configure-board" class="md-nav__link">
    Configure Board
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-serial-connection" class="md-nav__link">
    Configure Serial Connection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-from-sd-card" class="md-nav__link">
    Boot from SD Card
  </a>
  
    <nav class="md-nav" aria-label="Boot from SD Card">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#write-qspi-image" class="md-nav__link">
    Write QSPI Image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-sd-card-image" class="md-nav__link">
    Write SD Card Image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-linux" class="md-nav__link">
    Boot Linux
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-sample-applications" class="md-nav__link">
    Run Sample Applications
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#register-interrupts" class="md-nav__link">
    Register Interrupts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect-to-web-server" class="md-nav__link">
    Connect to Web Server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect-using-ssh" class="md-nav__link">
    Connect Using SSH
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-from-qspi" class="md-nav__link">
    Boot from QSPI
  </a>
  
    <nav class="md-nav" aria-label="Boot from QSPI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#write-qspi-image_1" class="md-nav__link">
    Write QSPI Image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-linux_1" class="md-nav__link">
    Boot Linux
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-from-nand" class="md-nav__link">
    Boot from NAND
  </a>
  
    <nav class="md-nav" aria-label="Boot from NAND">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nand-daughtercard" class="md-nav__link">
    NAND Daughtercard
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-nand-binaries" class="md-nav__link">
    Write NAND Binaries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-qspi-image_2" class="md-nav__link">
    Write QSPI Image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-linux_2" class="md-nav__link">
    Boot Linux
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partial-reconfiguration" class="md-nav__link">
    Partial Reconfiguration
  </a>
  
    <nav class="md-nav" aria-label="Partial Reconfiguration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reference-information" class="md-nav__link">
    Reference Information
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardware-design" class="md-nav__link">
    Hardware Design
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pr-files" class="md-nav__link">
    PR Files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-pr-scenarios" class="md-nav__link">
    Running PR Scenarios
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rebuild-the-gsrd" class="md-nav__link">
    Rebuild the GSRD
  </a>
  
    <nav class="md-nav" aria-label="Rebuild the GSRD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#boot-from-sd-card_1" class="md-nav__link">
    Boot from SD Card
  </a>
  
    <nav class="md-nav" aria-label="Boot from SD Card">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#build-flow" class="md-nav__link">
    Build Flow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up-environment" class="md-nav__link">
    Set up Environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-hardware-design" class="md-nav__link">
    Build Hardware Design
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-core-rbf" class="md-nav__link">
    Build Core RBF
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up-yocto" class="md-nav__link">
    Set Up Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#customize-yocto" class="md-nav__link">
    Customize Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-yocto" class="md-nav__link">
    Build Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-qspi-image" class="md-nav__link">
    Create QSPI Image
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-from-qspi_1" class="md-nav__link">
    Boot from QSPI
  </a>
  
    <nav class="md-nav" aria-label="Boot from QSPI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qspi-flash-layout" class="md-nav__link">
    QSPI Flash Layout
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-qspi-image_1" class="md-nav__link">
    Create QSPI Image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-programming-file-generator-file" class="md-nav__link">
    Create Programming File Generator File
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-from-nand_1" class="md-nav__link">
    Boot from NAND
  </a>
  
    <nav class="md-nav" aria-label="Boot from NAND">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nand-flash-layout" class="md-nav__link">
    NAND Flash Layout
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up-environment_1" class="md-nav__link">
    Set up Environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-hardware-design_1" class="md-nav__link">
    Build Hardware Design
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-core-rbf_1" class="md-nav__link">
    Build Core RBF
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up-yocto_1" class="md-nav__link">
    Set Up Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#customize-yocto_1" class="md-nav__link">
    Customize Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-yocto_1" class="md-nav__link">
    Build Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-qspi-image_2" class="md-nav__link">
    Create QSPI Image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-nand-binaries" class="md-nav__link">
    Build NAND Binaries
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partial-reconfiguration_1" class="md-nav__link">
    Partial Reconfiguration
  </a>
  
    <nav class="md-nav" aria-label="Partial Reconfiguration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#build-flow_1" class="md-nav__link">
    Build Flow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up-environment_2" class="md-nav__link">
    Set up Environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-hardware-design_2" class="md-nav__link">
    Build Hardware Design
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-core-rbf_2" class="md-nav__link">
    Build Core RBF
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up-yocto_2" class="md-nav__link">
    Set Up Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#customize-yocto_2" class="md-nav__link">
    Customize Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-yocto_2" class="md-nav__link">
    Build Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-qspi-image_3" class="md-nav__link">
    Create QSPI Image
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-from-sd-card-on-dk-soc-1ssx-l-d" class="md-nav__link">
    Boot from SD Card on DK-SOC-1SSX-L-D
  </a>
  
    <nav class="md-nav" aria-label="Boot from SD Card on DK-SOC-1SSX-L-D">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#build-flow_2" class="md-nav__link">
    Build Flow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up-environment_3" class="md-nav__link">
    Set up Environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-hardware-design_3" class="md-nav__link">
    Build Hardware Design
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-core-rbf_3" class="md-nav__link">
    Build Core RBF
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up-yocto_3" class="md-nav__link">
    Set Up Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#customize-yocto_3" class="md-nav__link">
    Customize Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-yocto_3" class="md-nav__link">
    Build Yocto
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-qspi-image_4" class="md-nav__link">
    Create QSPI Image
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notices-disclaimers" class="md-nav__link">
    Notices &amp; Disclaimers
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>GSRD User Guide</h1>

<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>The Golden System Reference Design (GSRD) is a reference design running on the <a href="https://www.intel.com/content/www/us/en/products/details/fpga/development-kits/stratix/10-sx.html">Intel Stratix 10 SX SoC Development Kit</a>.</p>
<p>The GSRD is comprised of the following components:</p>
<ul>
<li>Golden Hardware Reference Design (GHRD)</li>
<li>Reference HPS software including:<ul>
<li>Arm Trusted Firmware</li>
<li>U-Boot</li>
<li>Linux Kernel</li>
<li>Linux Drivers</li>
<li>Sample Applications</li>
</ul>
</li>
</ul>
<p><strong>Note</strong>: This page and associated binaries refers to the current version of the board, with ordering code DK-SOC-1SSX-H-D, aka "H-Tile". There was an older version of this board, ordering code DK-SOC-1SSX-L-D, aka "L-Tile", which is now discontinued. See section <a href="#boot-from-sd-card-on-dk-soc-1ssx-l-d">Boot from SD Card on DK-SOC-1SSX-L-D</a> for an example on how to update the GSRD to target the older board.</p>
<h3 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h3>
<p>The following are required in order to be able to fully exercise the S10 GSRD:</p>
<ul>
<li>Stratix 10 SoC Development Kit, ordering code DK-SOC-1SSX-H-D<ul>
<li>4GB DDR4 HILO memory card</li>
<li>SD/MMC HPS Daughtercard</li>
<li>SDM QSPI Bootcard(MT25QU02G)</li>
<li>Mini USB cable for serial output</li>
<li>Micro USB cable for on-board Intel FPGA Download Cable II</li>
<li>Micro SD card (4GB or greater)</li>
</ul>
</li>
</ul>
<ul>
<li>Host PC with<ul>
<li>Linux - Ubuntu 22.04 was used to create this page, other versions and distributions may work too</li>
<li>Serial terminal (for example Minicom on Linux and TeraTerm or PuTTY on Windows)</li>
<li>Micro SD card slot or Micro SD card writer/reader</li>
<li>Altera&reg; Quartus<sup>&reg;</sup> Prime Pro Edition Version 24.3</li>
<li>Local Ethernet network, with DHCP server (will be used to provide IP address to the board)</li>
</ul>
</li>
</ul>
<h3 id="release-contents">Release Contents<a class="headerlink" href="#release-contents" title="Permanent link">&para;</a></h3>
<h4 id="release-notes">Release Notes<a class="headerlink" href="#release-notes" title="Permanent link">&para;</a></h4>
<p>The Intel FPGA HPS Embedded Software release notes can be accessed from the following link: <a href="https://www.rocketboards.org/foswiki/Documentation/IntelFPGAHPSEmbeddedSoftwareRelease">https://www.rocketboards.org/foswiki/Documentation/IntelFPGAHPSEmbeddedSoftwareRelease</a></p>
<h4 id="prebuilt-binaries">Prebuilt Binaries<a class="headerlink" href="#prebuilt-binaries" title="Permanent link">&para;</a></h4>
<h5>Binaries for SD Card Boot</h5>

<p>The release files are accessible at <a href="https://releases.rocketboards.org/2024.11/gsrd/s10_htile_gsrd/">https://releases.rocketboards.org/2024.11/gsrd/s10_htile_gsrd/</a></p>
<p>The source code is also included on the SD card in the Linux rootfs path <code>/home/root</code>:</p>
<table>
<thead>
<tr>
<th align="left"><strong>File</strong></th>
<th align="left"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">linux-socfpga-v6.6.37-lts-src.tar.gz</td>
<td align="left">Source code for Linux kernel</td>
</tr>
<tr>
<td align="left">u-boot-socfpga-v2024.04-src.tar.gz</td>
<td align="left">Source code for U-Boot</td>
</tr>
<tr>
<td align="left">arm-trusted-firmware-v2.11.0-src.tar.gz</td>
<td align="left">Source code for Arm Trusted Firmware</td>
</tr>
</tbody>
</table>
<p>Before downloading the hardware design please read the agreement in the link <a href="https://www.intel.com/content/www/us/en/programmable/downloads/software/license/lic-prog_lic.html">https://www.intel.com/content/www/us/en/programmable/downloads/software/license/lic-prog_lic.html</a></p>
<h5>Binaries for NAND Boot</h5>

<p>The release files are accessible at <a href="https://releases.rocketboards.org/2024.11/nand/s10_htile_nand/">https://releases.rocketboards.org/2024.11/nand/s10_htile_nand/</a></p>
<h5>Binaries for QSPI Boot</h5>

<p>The release files are accessible at <a href="https://releases.rocketboards.org/2024.11/qspi/s10_htile_qspi/">https://releases.rocketboards.org/2024.11/qspi/s10_htile_qspi/</a></p>
<p><strong>Note</strong>: To boot from QSPI is needed to remove SD card memory as SD Card memory has higher precedence in the boot order.</p>
<h4 id="component-versions">Component Versions<a class="headerlink" href="#component-versions" title="Permanent link">&para;</a></h4>
<p>Altera&reg; Quartus<sup>&reg;</sup> Prime Pro Edition Version 24.3 and the following software component versions are used to build the GSRD: </p>
<table>
<thead>
<tr>
<th align="left"><strong>Component</strong></th>
<th align="left"><strong>Location</strong></th>
<th align="left"><strong>Branch</strong></th>
<th align="left"><strong>Commit ID/Tag</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">GHRD</td>
<td align="left"><a href="https://github.com/altera-opensource/ghrd-socfpga">https://github.com/altera-opensource/ghrd-socfpga</a></td>
<td align="left">master</td>
<td align="left">QPDS24.3_REL_GSRD_PR</td>
</tr>
<tr>
<td align="left">Linux</td>
<td align="left"><a href="https://github.com/altera-opensource/linux-socfpga">https://github.com/altera-opensource/linux-socfpga</a></td>
<td align="left">socfpga-6.6.37-lts</td>
<td align="left">QPDS24.3_REL_GSRD_PR</td>
</tr>
<tr>
<td align="left">Arm Trusted Firmware</td>
<td align="left"><a href="https://github.com/arm-trusted-firmware">https://github.com/arm-trusted-firmware</a></td>
<td align="left">socfpga_v2.11.0</td>
<td align="left">QPDS24.3_REL_GSRD_PR</td>
</tr>
<tr>
<td align="left">U-Boot</td>
<td align="left"><a href="https://github.com/altera-opensource/u-boot-socfpga">https://github.com/altera-opensource/u-boot-socfpga</a></td>
<td align="left">socfpga_v2024.04</td>
<td align="left">QPDS24.3_REL_GSRD_PR</td>
</tr>
<tr>
<td align="left">Yocto Project</td>
<td align="left"><a href="https://git.yoctoproject.org/poky">https://git.yoctoproject.org/poky</a></td>
<td align="left">scarthgap</td>
<td align="left">latest</td>
</tr>
<tr>
<td align="left">Yocto Project: meta-intel-fpga</td>
<td align="left"><a href="https://git.yoctoproject.org/meta-intel-fpga">https://git.yoctoproject.org/meta-intel-fpga</a></td>
<td align="left">scarthgap</td>
<td align="left">latest</td>
</tr>
<tr>
<td align="left">Yocto Project: meta-intel-fpga-refdes</td>
<td align="left"><a href="https://github.com/altera-opensource/meta-intel-fpga-refdes">https://github.com/altera-opensource/meta-intel-fpga-refdes</a></td>
<td align="left">scarthgap</td>
<td align="left">QPDS24.3_REL_GSRD_PR</td>
</tr>
</tbody>
</table>
<h3 id="ghrd-overview">GHRD Overview<a class="headerlink" href="#ghrd-overview" title="Permanent link">&para;</a></h3>
<p>The Golden Hardware Reference Design is an important part of the GSRD and consists of the following components:</p>
<ul>
<li>
<p>Hard Processor System (HPS)</p>
<ul>
<li>Quad Arm Cortex-A53 MPCore Processor</li>
<li>HPS Peripherals connected to Out-of-Box Experience (OOBE) Daughter Card:<ul>
<li>Micro SD for HPS storage</li>
<li>EMAC</li>
<li>HPS JTAG debug</li>
<li>I2C</li>
<li>USB UART</li>
<li>USB 2.0 OTG</li>
<li>Two Push buttons and Three LEDs</li>
</ul>
</li>
</ul>
<ul>
<li>Hard Memory Controller (HMC) for HPS External Memory Interface (EMIF)</li>
</ul>
</li>
</ul>
<ul>
<li>FPGA Peripherals connected to Lightweight HPS-to-FPGA (LWH2F) AXI Bridge and JTAG to Avalon Master Bridge<ul>
<li>Three user LED outputs</li>
<li>Four user DIP switch inputs</li>
<li>Four user push-button inputs</li>
<li>Interrupt Latency Counter</li>
<li>System ID</li>
</ul>
</li>
</ul>
<ul>
<li>FPGA Peripherals connected to HPS-to-FPGA (H2F) AXI Bridge<ul>
<li>256KB of FPGA on-chip memory</li>
</ul>
</li>
</ul>
<ul>
<li>JTAG to Avalon Master Bridges connected to:<ul>
<li>FPGA-to-SDRAM 0/&frac12; Interfaces</li>
<li>FPGA-to-HPS AXI Bridge</li>
</ul>
</li>
</ul>
<p><a class="glightbox" href="../images/s10-ghrd.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/s10-ghrd.png" /></a></p>
<p>The GHRD allows hardware designers to access each peripheral in the FPGA portion of the SoC with System Console, through the JTAG master module. This signal-level access is independent of the driver readiness of each peripheral.</p>
<h4 id="mpu-address-maps">MPU Address Maps<a class="headerlink" href="#mpu-address-maps" title="Permanent link">&para;</a></h4>
<p>This section presents the address maps as seen from the MPU (Cortex-A53) side.</p>
<h5>HPS-to-FPGA Address Map</h5>

<p>The MPU region provide windows of 4 GB into the FPGA slave address space. The lower 1.5 GB of this space is mapped to two separate addresses - firstly from 0x8000_0000 to 0xDFFF_FFFF and secondly from 0x20_0000_0000 to 0x20_5FFF_FFFF. The following table lists the offset of each peripheral from the HPS-to-FPGA bridge in the FPGA portion of the SoC.</p>
<table>
<thead>
<tr>
<th align="left">Peripheral</th>
<th align="left">Address Offset</th>
<th align="left">Size (bytes)</th>
<th align="left">Attribute</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">onchip_memory2_0</td>
<td align="left">0x0</td>
<td align="left">256K</td>
<td align="left">On-chip RAM as scratch pad</td>
</tr>
</tbody>
</table>
<h5>Lightweight HPS-to-FPGA Address Map</h5>

<p>The the memory map of system peripherals in the FPGA portion of the SoC as viewed by the MPU (Cortex-A53), which starts at the lightweight HPS-to-FPGA base address of <strong>0xF900_0000</strong>, is listed in the following table.</p>
<table>
<thead>
<tr>
<th align="left">Peripheral</th>
<th align="left">Address Offset</th>
<th align="left">Size (bytes)</th>
<th align="left">Attribute</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">sysid</td>
<td align="left">0x0000_0000</td>
<td align="left">8</td>
<td align="left">Unique system ID</td>
</tr>
<tr>
<td align="left">led_pio</td>
<td align="left">0x0000_1080</td>
<td align="left">16</td>
<td align="left">LED outputs</td>
</tr>
<tr>
<td align="left">button_pio</td>
<td align="left">0x0000_1060</td>
<td align="left">16</td>
<td align="left">Push button inputs</td>
</tr>
<tr>
<td align="left">dipsw_pio</td>
<td align="left">0x0000_1070</td>
<td align="left">16</td>
<td align="left">DIP switch inputs</td>
</tr>
<tr>
<td align="left">ILC</td>
<td align="left">0x0000_1100</td>
<td align="left">256</td>
<td align="left">Interrupt latency counter (ILC)</td>
</tr>
</tbody>
</table>
<h4 id="jtag-master-address-map">JTAG Master Address Map<a class="headerlink" href="#jtag-master-address-map" title="Permanent link">&para;</a></h4>
<p>There are two JTAG master interfaces in the design, one for accessing non-secure peripherals in the FPGA fabric, and another for accessing secure peripheral in the HPS through the FPGA-to-HPS Interface.</p>
<p>The following table lists the address of each peripheral in the FPGA portion of the SoC, as seen through the non-secure JTAG master interface.</p>
<table>
<thead>
<tr>
<th align="left">Peripheral</th>
<th align="left">Address Offset</th>
<th align="left">Size (bytes)</th>
<th align="left">Attribute</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">onchip_memory2_0</td>
<td align="left">0x0004_0000</td>
<td align="left">256K</td>
<td align="left">On-chip RAM</td>
</tr>
<tr>
<td align="left">sysid</td>
<td align="left">0x0000_0000</td>
<td align="left">8</td>
<td align="left">Unique system ID</td>
</tr>
<tr>
<td align="left">led_pio</td>
<td align="left">0x0000_1080</td>
<td align="left">16</td>
<td align="left">LED outputs</td>
</tr>
<tr>
<td align="left">button_pio</td>
<td align="left">0x0000_1060</td>
<td align="left">16</td>
<td align="left">Push button inputs</td>
</tr>
<tr>
<td align="left">dipsw_pio</td>
<td align="left">0x0000_1070</td>
<td align="left">16</td>
<td align="left">DIP switch inputs</td>
</tr>
<tr>
<td align="left">ILC</td>
<td align="left">0x0000_1100</td>
<td align="left">256</td>
<td align="left">Interrupt latency counter (ILC)</td>
</tr>
</tbody>
</table>
<h4 id="interrupt-routing">Interrupt Routing<a class="headerlink" href="#interrupt-routing" title="Permanent link">&para;</a></h4>
<p>The HPS exposes 64 interrupt inputs for the FPGA logic. The following table lists the interrupt connections from soft IP peripherals to the HPS interrupt input interface.</p>
<table>
<thead>
<tr>
<th align="left">Peripheral</th>
<th align="left">Interrupt Number</th>
<th align="left">Attribute</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">dipsw_pio</td>
<td align="left">f2h_irq0[0]</td>
<td align="left">4 DIP switch inputs</td>
</tr>
<tr>
<td align="left">button_pio</td>
<td align="left">f2h_irq0[1]</td>
<td align="left">4 Push button inputs</td>
</tr>
</tbody>
</table>
<p>The interrupt sources are also connected to an interrupt latency counter (ILC) module in the system, which enables System Console to be aware of the interrupt status of each peripheral in the FPGA portion of the SoC.</p>
<h3 id="typical-hps-boot-flow">Typical HPS Boot Flow<a class="headerlink" href="#typical-hps-boot-flow" title="Permanent link">&para;</a></h3>
<p>The GSRD boot flow includes the following stages:</p>
<p>1. SDM</p>
<p>2. U-Boot SPL</p>
<p>3. ATF</p>
<p>4. U-Boot</p>
<p>5. Linux</p>
<p>6. Application</p>
<p><a class="glightbox" href="../images/s10_agilex_hps_boot_flow.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/s10_agilex_hps_boot_flow.png" /></a></p>
<p>The following table presents a short description of the different boot stages:</p>
<table>
<thead>
<tr>
<th align="left">Stage</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">SDM</td>
<td align="left">Secure Device Manager boots first</td>
</tr>
<tr>
<td align="left">U-Boot SPL</td>
<td align="left">Configures IO, FPGA, brings up SDRAM</td>
</tr>
<tr>
<td align="left">ATF</td>
<td align="left">Arm Trusted Firmware, provides SMC handler</td>
</tr>
<tr>
<td align="left">U-Boot</td>
<td align="left">Loads Linux kernel</td>
</tr>
<tr>
<td align="left">Linux</td>
<td align="left">Operating system</td>
</tr>
<tr>
<td align="left">Application</td>
<td align="left">User application</td>
</tr>
</tbody>
</table>
<p>For more information, please refer to <a href="https://www.intel.com/content/dam/www/programmable/us/en/pdfs/literature/ug/ug-s10-soc-boot.pdf">Intel Stratix 10 SoC Boot User Guide</a> and <a href="https://www.intel.com/content/dam/www/programmable/us/en/pdfs/literature/hb/stratix-10/s10_5v4.pdf">Intel Stratix 10 Hard Processor System Technical Reference Manual</a> (Booting and Configuration chapter).</p>
<h2 id="exercise-prebuilt-gsrd">Exercise Prebuilt GSRD<a class="headerlink" href="#exercise-prebuilt-gsrd" title="Permanent link">&para;</a></h2>
<p>This section presents how to use the prebuilt binaries included with the GSRD release.</p>
<p>The following topics are  included:</p>
<ul>
<li>Configure the board and serial terminal</li>
<li>Boot from SD Card</li>
<li>Boot from QSPI</li>
<li>Boot from NAND</li>
<li>Partial Reconfiguration</li>
</ul>
<p>Most of the applications and features presented in the Boot from SD Card scenario are also available in the other scenarios.</p>
<h3 id="configure-board">Configure Board<a class="headerlink" href="#configure-board" title="Permanent link">&para;</a></h3>
<p>This section presents the necessary board settings in order to run the GSRD on the Intel FPGA Stratix 10 SoC development board.</p>
<p><a class="glightbox" href="../images/s10-soc-board.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/s10-soc-board.png" /></a></p>
<p>First, confirm the following:</p>
<ul>
<li>DDR4 memory card is installed on HPS HiLo memory socket</li>
<li>OOBE Daughter card is installed on HPS Daughter card socket</li>
</ul>
<p>Then the board switches need to be configured as follows:</p>
<ul>
<li>SW1: OFF-OFF-ON-ON-ON-ON-ON-ON</li>
<li>SW2: ON-ON-ON (SW2.4 is not connected)</li>
<li>SW3: All OFF</li>
<li>SW4: ON-OFF-OFF-ON</li>
</ul>
<h3 id="configure-serial-connection">Configure Serial Connection<a class="headerlink" href="#configure-serial-connection" title="Permanent link">&para;</a></h3>
<p>The OOBE Daughter Card has a built-in FTDI USB to Serial converter chip that allows the host computer to see the board as a virtual serial port. Ubuntu and other modern Linux distributions have built-in drivers for the FTDI USB to Serial converter chip, so no driver installation is necessary on those platforms. On Windows, the SoC EDS Pro installer automatically installs the required drivers if necessary.</p>
<p>The serial communication parameters are:</p>
<ul>
<li>Baud-rate: 115,200</li>
<li>Parity: none</li>
<li>Flow control: none</li>
<li>Stop bits: 1</li>
</ul>
<p>On Windows, utilities such as TeraTerm and PuTTY can be used to connect to the board. They are easily configured from the tool menus.</p>
<p>On Linux, the minicom utility can be used. Here is how to configure it:</p>
<p>The virtual serial port is usually named /dev/ttyUSB0. In order to determine the device name associated with the virtual serial port on your host PC, please perform the following:</p>
<ul>
<li>Use the following command to determine which USB serial devices are already installed: ls /dev/ttyUSB*</li>
<li>Connect mini USB cable from J7 to the PC. This will enable the PC to communicate with the board, even if the board is not powered yet.</li>
<li>Use the ls /dev/ttyUSB* command command again to determine which new USB serial device appeared.</li>
<li>Install <strong>minicom</strong> application on host PC, if not installed.</li>
</ul>
<ul>
<li>On Ubuntu, use <em>sudo apt-get install minicom</em></li>
<li>Configure minicom.</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>$<span class="w"> </span>sudo<span class="w"> </span>minicom<span class="w"> </span>-s
</code></pre></div>
<p>Under <strong>Serial Port Setup</strong> choose the following:</p>
<ul>
<li>Serial Device: <strong>/dev/ttyUSB0</strong> (edit to match the system as necessary)</li>
<li>Bps/Par/Bits: <strong>115200 8N1</strong></li>
<li>Hardware Flow Control: <strong>No</strong></li>
<li>Software Flow Control: <strong>No</strong></li>
<li>Hit <strong>[ESC]</strong> to return to the main configuration menu</li>
</ul>
<p>Select <strong>Save Setup as dfl</strong> to save the default setup. Then select <strong>Exit</strong>.</p>
<h3 id="boot-from-sd-card">Boot from SD Card<a class="headerlink" href="#boot-from-sd-card" title="Permanent link">&para;</a></h3>
<p>This section presents how to write the QSPI Flash and SD Card image files, configure the board and boot Linux.</p>
<h4 id="write-qspi-image">Write QSPI Image<a class="headerlink" href="#write-qspi-image" title="Permanent link">&para;</a></h4>
<p>The QSPI JIC image contains the FPGA configuration bitstream, and the U-Boot SPL.</p>
<p>1. Download and extract the image file:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>wget<span class="w"> </span>https://releases.rocketboards.org/2024.11/gsrd/s10_htile_gsrd/ghrd_1sx280hu2f50e1vgas.jic.tar.gz
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>tar<span class="w"> </span>xf<span class="w"> </span>ghrd_1sx280hu2f50e1vgas.jic.tar.gz
</code></pre></div>
<p>2. Configure MSEL to JTAG:</p>
<ul>
<li>SW2: ON-ON-ON (SW2.4 is not connected)</li>
</ul>
<p>3. Power cycle the board</p>
<p>4. Write the image using the following commands:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>quartus_pgm<span class="w"> </span>-c<span class="w"> </span><span class="m">1</span><span class="w"> </span>-m<span class="w"> </span>jtag<span class="w"> </span>-o<span class="w"> </span><span class="s2">&quot;pvi;ghrd_1sx280hu2f50e1vgas.jic&quot;</span>
</code></pre></div>
<p>5. Configure MSEL back to QSPI:</p>
<ul>
<li>SW2: ON-OFF-OFF (SW2.4 is not connected)</li>
</ul>
<h4 id="write-sd-card-image">Write SD Card Image<a class="headerlink" href="#write-sd-card-image" title="Permanent link">&para;</a></h4>
<p>This section explains how to create the SD card necessary to boot Linux, using the SD card image available with the pre-built Linux binaries package. Once the SD card has been created, insert the card into the SD slot of the Micro SD daughter card.</p>
<h5>Write SD Card on Linux</h5>

<p>1. Download the SD card image from <a href="https://releases.rocketboards.org/2024.11/gsrd/s10_htile_gsrd/sdimage.tar.gz">https://releases.rocketboards.org/2024.11/gsrd/s10_htile_gsrd/sdimage.tar.gz</a> and extract it.</p>
<p>The extacted file is named <code>gsrd-console-image-stratix10.wic</code>.</p>
<p>2. Determine the device associated with the SD card on the host by running the following command before and after inserting the card.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>$<span class="w"> </span>cat<span class="w"> </span>/proc/partitions
</code></pre></div>
<p>Let's assume it is /dev/sdx.</p>
<p>3. Use <em>dd</em> utility to write the SD image to the SD card.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>$<span class="w"> </span>sudo<span class="w"> </span>dd<span class="w"> </span><span class="k">if</span><span class="o">=</span>gsrd-console-image-stratix10.wic<span class="w"> </span><span class="nv">of</span><span class="o">=</span>/dev/sdx<span class="w"> </span><span class="nv">bs</span><span class="o">=</span>1M
</code></pre></div>
<p>Note we are using <em>sudo</em> to be able to write to the card.</p>
<p>4. Use <em>sync</em> utility to flush the changes to the SD card.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>$<span class="w"> </span>sudo<span class="w"> </span>sync
</code></pre></div>
<h5>Write SD Card on Windows</h5>

<p>1. Download the SD card image from <a href="https://releases.rocketboards.org/2024.11/gsrd/s10_htile_gsrd/sdimage.tar.gz">https://releases.rocketboards.org/2024.11/gsrd/s10_htile_gsrd/sdimage.tar.gz</a> and extract it.</p>
<p>The extacted file is named <code>gsrd-console-image-stratix10.wic</code>.</p>
<p>2. Rename the wic file as <code>sdcard.img</code></p>
<p>3. Use Win32DiskImager to write the image to the SD card. The tool can be downloaded from <a href="https://sourceforge.net/projects/win32diskimager/files/latest/download">https://sourceforge.net/projects/win32diskimager/files/latest/download</a></p>
<p><a class="glightbox" href="../images/win32diskimager.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/win32diskimager.png" /></a></p>
<h4 id="boot-linux">Boot Linux<a class="headerlink" href="#boot-linux" title="Permanent link">&para;</a></h4>
<p>This section presents how to boot Linux on the board. The required steps are:</p>
<p>1. Start serial terminal (when using Minicom it will connect using the selected settings, for others connect manually).</p>
<p>2. Power up the board.</p>
<p>3. U-Boot SPL is ran</p>
<p>4. U-Boot is ran</p>
<p>5. Linux boots.</p>
<p>6. Login using 'root' and no password.</p>
<p>7. Run 'ifconfig' command to determine the IP of the board</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>root@stratix10:~#<span class="w"> </span>ifconfig
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>eth0:<span class="w"> </span><span class="nv">flags</span><span class="o">=</span><span class="m">4163</span><span class="w"> </span>mtu<span class="w"> </span><span class="m">1500</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w"> </span>inet<span class="w"> </span><span class="m">192</span>.168.1.48<span class="w"> </span>netmask<span class="w"> </span><span class="m">255</span>.255.255.0<span class="w"> </span>broadcast<span class="w"> </span><span class="m">192</span>.168.1.255
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w"> </span>inet6<span class="w"> </span>fe80::d429:5dff:fe20:d6f4<span class="w"> </span>prefixlen<span class="w"> </span><span class="m">64</span><span class="w"> </span>scopeid<span class="w"> </span>0x20
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w"> </span>ether<span class="w"> </span>d6:29:5d:20:d6:f4<span class="w"> </span>txqueuelen<span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="o">(</span>Ethernet<span class="o">)</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w"> </span>RX<span class="w"> </span>packets<span class="w"> </span><span class="m">57</span><span class="w"> </span>bytes<span class="w"> </span><span class="m">9330</span><span class="w"> </span><span class="o">(</span><span class="m">9</span>.1<span class="w"> </span>KiB<span class="o">)</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w"> </span>RX<span class="w"> </span>errors<span class="w"> </span><span class="m">0</span><span class="w"> </span>dropped<span class="w"> </span><span class="m">0</span><span class="w"> </span>overruns<span class="w"> </span><span class="m">0</span><span class="w"> </span>frame<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w"> </span>TX<span class="w"> </span>packets<span class="w"> </span><span class="m">57</span><span class="w"> </span>bytes<span class="w"> </span><span class="m">8062</span><span class="w"> </span><span class="o">(</span><span class="m">7</span>.8<span class="w"> </span>KiB<span class="o">)</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w"> </span>TX<span class="w"> </span>errors<span class="w"> </span><span class="m">0</span><span class="w"> </span>dropped<span class="w"> </span><span class="m">0</span><span class="w"> </span>overruns<span class="w"> </span><span class="m">0</span><span class="w"> </span>carrier<span class="w"> </span><span class="m">0</span><span class="w"> </span>collisions<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w"> </span>device<span class="w"> </span>interrupt<span class="w"> </span><span class="m">21</span><span class="w"> </span>base<span class="w"> </span>0x2000
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>eth1:<span class="w"> </span><span class="nv">flags</span><span class="o">=</span><span class="m">4099</span><span class="w"> </span>mtu<span class="w"> </span><span class="m">1500</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="w"> </span>ether<span class="w"> </span>8a:c5:fe:e4:b5:97<span class="w"> </span>txqueuelen<span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="o">(</span>Ethernet<span class="o">)</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="w"> </span>RX<span class="w"> </span>packets<span class="w"> </span><span class="m">0</span><span class="w"> </span>bytes<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span><span class="m">0</span>.0<span class="w"> </span>B<span class="o">)</span>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="w"> </span>RX<span class="w"> </span>errors<span class="w"> </span><span class="m">0</span><span class="w"> </span>dropped<span class="w"> </span><span class="m">0</span><span class="w"> </span>overruns<span class="w"> </span><span class="m">0</span><span class="w"> </span>frame<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="w"> </span>TX<span class="w"> </span>packets<span class="w"> </span><span class="m">0</span><span class="w"> </span>bytes<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span><span class="m">0</span>.0<span class="w"> </span>B<span class="o">)</span>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="w"> </span>TX<span class="w"> </span>errors<span class="w"> </span><span class="m">0</span><span class="w"> </span>dropped<span class="w"> </span><span class="m">0</span><span class="w"> </span>overruns<span class="w"> </span><span class="m">0</span><span class="w"> </span>carrier<span class="w"> </span><span class="m">0</span><span class="w"> </span>collisions<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="w"> </span>device<span class="w"> </span>interrupt<span class="w"> </span><span class="m">22</span><span class="w"> </span>base<span class="w"> </span>0xc000
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>eth2:<span class="w"> </span><span class="nv">flags</span><span class="o">=</span><span class="m">4099</span><span class="w"> </span>mtu<span class="w"> </span><span class="m">1500</span>
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="w"> </span>ether<span class="w"> </span><span class="m">66</span>:fd:43:7f:bc:66<span class="w"> </span>txqueuelen<span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="o">(</span>Ethernet<span class="o">)</span>
<a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="w"> </span>RX<span class="w"> </span>packets<span class="w"> </span><span class="m">0</span><span class="w"> </span>bytes<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span><span class="m">0</span>.0<span class="w"> </span>B<span class="o">)</span>
<a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a><span class="w"> </span>RX<span class="w"> </span>errors<span class="w"> </span><span class="m">0</span><span class="w"> </span>dropped<span class="w"> </span><span class="m">0</span><span class="w"> </span>overruns<span class="w"> </span><span class="m">0</span><span class="w"> </span>frame<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a><span class="w"> </span>TX<span class="w"> </span>packets<span class="w"> </span><span class="m">0</span><span class="w"> </span>bytes<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span><span class="m">0</span>.0<span class="w"> </span>B<span class="o">)</span>
<a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a><span class="w"> </span>TX<span class="w"> </span>errors<span class="w"> </span><span class="m">0</span><span class="w"> </span>dropped<span class="w"> </span><span class="m">0</span><span class="w"> </span>overruns<span class="w"> </span><span class="m">0</span><span class="w"> </span>carrier<span class="w"> </span><span class="m">0</span><span class="w"> </span>collisions<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a><span class="w"> </span>device<span class="w"> </span>interrupt<span class="w"> </span><span class="m">23</span><span class="w"> </span>base<span class="w"> </span>0xe000
<a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a>
<a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a>lo:<span class="w"> </span><span class="nv">flags</span><span class="o">=</span><span class="m">73</span><span class="w"> </span>mtu<span class="w"> </span><span class="m">65536</span>
<a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a><span class="w"> </span>inet<span class="w"> </span><span class="m">127</span>.0.0.1<span class="w"> </span>netmask<span class="w"> </span><span class="m">255</span>.0.0.0
<a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a><span class="w"> </span>inet6<span class="w"> </span>::1<span class="w"> </span>prefixlen<span class="w"> </span><span class="m">128</span><span class="w"> </span>scopeid<span class="w"> </span>0x10
<a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a><span class="w"> </span>loop<span class="w"> </span>txqueuelen<span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="o">(</span>Local<span class="w"> </span>Loopback<span class="o">)</span>
<a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a><span class="w"> </span>RX<span class="w"> </span>packets<span class="w"> </span><span class="m">100</span><span class="w"> </span>bytes<span class="w"> </span><span class="m">8440</span><span class="w"> </span><span class="o">(</span><span class="m">8</span>.2<span class="w"> </span>KiB<span class="o">)</span>
<a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a><span class="w"> </span>RX<span class="w"> </span>errors<span class="w"> </span><span class="m">0</span><span class="w"> </span>dropped<span class="w"> </span><span class="m">0</span><span class="w"> </span>overruns<span class="w"> </span><span class="m">0</span><span class="w"> </span>frame<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a><span class="w"> </span>TX<span class="w"> </span>packets<span class="w"> </span><span class="m">100</span><span class="w"> </span>bytes<span class="w"> </span><span class="m">8440</span><span class="w"> </span><span class="o">(</span><span class="m">8</span>.2<span class="w"> </span>KiB<span class="o">)</span>
<a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a><span class="w"> </span>TX<span class="w"> </span>errors<span class="w"> </span><span class="m">0</span><span class="w"> </span>dropped<span class="w"> </span><span class="m">0</span><span class="w"> </span>overruns<span class="w"> </span><span class="m">0</span><span class="w"> </span>carrier<span class="w"> </span><span class="m">0</span><span class="w"> </span>collisions<span class="w"> </span><span class="m">0</span>
</code></pre></div>
<p><strong>Note</strong>: there are three network cards, one connected to the Ethernet port on the HPS Daughtercard, and two to the Ethernet ports on the DevKit, which are connected throgh SGMII.</p>
<h4 id="run-sample-applications">Run Sample Applications<a class="headerlink" href="#run-sample-applications" title="Permanent link">&para;</a></h4>
<p>The GSRD includes a number of sample Linux applications that help demonstrate some of the features of the platform:</p>
<ul>
<li>Display Hello World message</li>
<li>Control LEDs</li>
<li>Detect interrupts from push buttons and DIP switches</li>
</ul>
<p>The sample applications can be used as a starting point for users to write their own applications that interact with software IP through Linux drivers.</p>
<h5>Prerequisites</h5>

<p>1. Boot Linux on the target board as described in <a href="https://www.rocketboards.org/foswiki/Documentation/Stratix10SoCGSRD#BootingLinux">Booting Linux</a>. You will not need to use the serial terminal if you plan on using ssh connection.</p>
<p>2. Connect to the board using one of the following options:</p>
<ul>
<li>Connect using serial console, as described in <a href="https://www.rocketboards.org/foswiki/Documentation/Stratix10SoCGSRD#BootingLinux">Booting Linux</a></li>
<li>Connect using ssh, as described in <a href="https://www.rocketboards.org/foswiki/Documentation/Stratix10SoCGSRD#ConnectSSH">Connect Using SSH</a></li>
</ul>
<p>3. In serial console, or ssh client console, change current folder to be <em>/home/root/intelFPGA</em>. This is where the application binaries are stored.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>root@stratix10:~#<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>/home/root/intelFPGA/
</code></pre></div>
<h5>Display Hello World Message</h5>

<p>Run the following command to display the Hello World message on the console:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>root@stratix10:~/intelFPGA#<span class="w"> </span>./hello
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>Hello<span class="w"> </span>SoC<span class="w"> </span>FPGA!
</code></pre></div>
<h5>Exercise Soft PIO Driver for LED Control</h5>

<p>The following LEDs are exercised:</p>
<table>
<thead>
<tr>
<th align="left">User FPGA LED Number</th>
<th align="left">Corresponding Board LED</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">0</td>
<td align="left">D21</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">D23</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">D25</td>
</tr>
</tbody>
</table>
<p>Note: User FPGA LED #3 / D27 is quickly blinking, and cannot be controlled from software.</p>
<p>1. In order to blink an LED in a loop, with a specific delay in ms, run the following command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>./blink<span class="w"> </span>&lt;led_number&gt;<span class="w"> </span>&lt;delay_ms&gt;
</code></pre></div>
<ul>
<li>The <strong>led_number</strong> specifies the desired LED, and is a value between 0 and 3.</li>
<li>The <strong>delay_ms</strong> is a number that specifies the desired delay in ms between turning the LED on and off.</li>
</ul>
<p>2. In order to turn an individual LED on or off, run the following command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>./toggle<span class="w"> </span>&lt;led_number&gt;<span class="w"> </span>&lt;state&gt;
</code></pre></div>
<ul>
<li>The <strong>led_number</strong> specifies the desired LED, and is a value between 0 and 3.</li>
<li>The <strong>state</strong> needs to be 0 to turn the LED off, and 1 to turn the LED on.</li>
</ul>
<p>3. In order to scroll the FPGA LEDs with a specific delay, please run the following command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>./scroll_client<span class="w"> </span>&lt;delay&gt;
</code></pre></div>
<p>The <strong>delay</strong> specifies the desired scrolling behavior:</p>
<ul>
<li><strong>delay &gt; 0</strong> - specify new scrolling delay in ms, and start scrolling</li>
<li><strong>delay &lt; 0</strong> - stop scrolling</li>
<li><strong>delay = 0</strong> - display current scroll delay</li>
</ul>
<h5>System Check Application</h5>

<p>System check application provides a glance of system status of basic peripherals such as:</p>
<ul>
<li><strong>USB</strong>: USB device driver</li>
<li><strong>Network IP (IPv4)</strong>: Network IP address</li>
<li><strong>HPS LEDs</strong>: HPS LED state</li>
<li><strong>FPGA LEDs</strong>: FPGA LED state</li>
</ul>
<p>Run the application by issuing the following command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>root@stratix10:~/intelFPGA#<span class="w"> </span>./syschk
</code></pre></div>
<p>The window will look as shown below - press 'q' to exit:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="w"> </span>ALTERA<span class="w"> </span>SYSTEM<span class="w"> </span>CHECK
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>IPv4<span class="w"> </span>Address<span class="w"> </span>:<span class="w"> </span><span class="m">192</span>.168.1.48<span class="w"> </span>usb1<span class="w"> </span>:<span class="w"> </span>DWC<span class="w"> </span>OTG<span class="w"> </span>Controller
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>fpga_led2<span class="w"> </span>:<span class="w"> </span>OFF<span class="w"> </span>serial1@ffc02100<span class="w"> </span>:<span class="w"> </span>disabled
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>hps_led2<span class="w"> </span>:<span class="w"> </span>OFF<span class="w"> </span>serial0@ffc02000<span class="w"> </span>:<span class="w"> </span>okay
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>fpga_led0<span class="w"> </span>:<span class="w"> </span>OFF
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>hps_led0<span class="w"> </span>:<span class="w"> </span>OFF
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>fpga_led3<span class="w"> </span>:<span class="w"> </span>OFF
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>fpga_led1<span class="w"> </span>:<span class="w"> </span>OFF
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>hps_led1<span class="w"> </span>:<span class="w"> </span>OFF
</code></pre></div>
<h4 id="register-interrupts">Register Interrupts<a class="headerlink" href="#register-interrupts" title="Permanent link">&para;</a></h4>
<p>The following are exercised:</p>
<ul>
<li>User FPGA DIP switches<ul>
<li>SW3.1</li>
<li>SW3.2</li>
<li>SW3.3</li>
<li>SW3.4</li>
</ul>
</li>
</ul>
<ul>
<li>User FPGA push buttons<ul>
<li>0: S4</li>
<li>1: S5</li>
<li>2: S6</li>
<li>3: S7</li>
</ul>
</li>
</ul>
<p>In order to register an interrupt handler to a specific GPIO, you will first need to determine the GPIO number used.</p>
<p>1. Open the Linux Device Tree <a href="https://raw.githubusercontent.com/altera-opensource/meta-intel-fpga-refdes/scarthgap/recipes-bsp/device-tree/files/socfpga_stratix10_qse_sgmii_ghrd.dtsi">socfpga_stratix10_qse_pcie_sgmii_ghrd.dtsi</a> file and look up the labels for the DIP switches and Push button GPIOs:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="w"> </span>button_pio:<span class="w"> </span>gpio@f9001060<span class="w"> </span><span class="o">{</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="w"> </span><span class="nv">compatible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;altr,pio-1.0&quot;</span><span class="p">;</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w"> </span><span class="nv">reg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>&lt;0xf9001060<span class="w"> </span>0x10&gt;<span class="p">;</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w"> </span>interrupt-parent<span class="w"> </span><span class="o">=</span><span class="w"> </span>&lt;<span class="p">&amp;</span>intc&gt;<span class="p">;</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w"> </span><span class="nv">interrupts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>&lt;<span class="m">0</span><span class="w"> </span><span class="m">18</span><span class="w"> </span><span class="m">4</span>&gt;<span class="p">;</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="w"> </span>altr,gpio-bank-width<span class="w"> </span><span class="o">=</span><span class="w"> </span>&lt;<span class="m">4</span>&gt;<span class="p">;</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="w"> </span>altr,interrupt-type<span class="w"> </span><span class="o">=</span><span class="w"> </span>&lt;<span class="m">2</span>&gt;<span class="p">;</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="w"> </span>altr,interrupt_type<span class="w"> </span><span class="o">=</span><span class="w"> </span>&lt;<span class="m">2</span>&gt;<span class="p">;</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="w"> </span><span class="c1">#gpio-cells = &lt;2&gt;;</span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="w"> </span>gpio-controller<span class="p">;</span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="w"> </span><span class="o">}</span><span class="p">;</span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="w"> </span>dipsw_pio:<span class="w"> </span>gpio@f9001070<span class="w"> </span><span class="o">{</span>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="w"> </span><span class="nv">compatible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;altr,pio-1.0&quot;</span><span class="p">;</span>
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="w"> </span><span class="nv">reg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>&lt;0xf9001070<span class="w"> </span>0x10&gt;<span class="p">;</span>
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="w"> </span>interrupt-parent<span class="w"> </span><span class="o">=</span><span class="w"> </span>&lt;<span class="p">&amp;</span>intc&gt;<span class="p">;</span>
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a><span class="w"> </span><span class="nv">interrupts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>&lt;<span class="m">0</span><span class="w"> </span><span class="m">17</span><span class="w"> </span><span class="m">4</span>&gt;<span class="p">;</span>
<a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a><span class="w"> </span>altr,gpio-bank-width<span class="w"> </span><span class="o">=</span><span class="w"> </span>&lt;<span class="m">4</span>&gt;<span class="p">;</span>
<a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a><span class="w"> </span>altr,interrupt-type<span class="w"> </span><span class="o">=</span><span class="w"> </span>&lt;<span class="m">3</span>&gt;<span class="p">;</span>
<a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a><span class="w"> </span>altr,interrupt_type<span class="w"> </span><span class="o">=</span><span class="w"> </span>&lt;<span class="m">3</span>&gt;<span class="p">;</span>
<a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a><span class="w"> </span><span class="c1">#gpio-cells = &lt;2&gt;;</span>
<a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a><span class="w"> </span>gpio-controller<span class="p">;</span>
<a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a><span class="w"> </span><span class="o">}</span><span class="p">;</span>
</code></pre></div>
<p>2. Run the following to determine the GPIO numbers for the DIP switches</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>root@stratix10:~/intelFPGA#<span class="w"> </span>grep<span class="w"> </span>-r<span class="w"> </span><span class="s2">&quot;gpio@f9001070&quot;</span><span class="w"> </span>/sys/class/gpio/gpiochip*/label
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>/sys/class/gpio/gpiochip1928/label:/soc/gpio@f9001070
</code></pre></div>
<p>This means that the GPIOs 1928 .. 1931 are allocated to the DIP switches (there are 4 of them).</p>
<p>3. Run the followinig to determine the GPIO numbers for the pushbuttons</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>root@stratix10:~/intelFPGA#<span class="w"> </span>grep<span class="w"> </span>-r<span class="w"> </span><span class="s2">&quot;gpio@f9001060&quot;</span><span class="w"> </span>/sys/class/gpio/gpiochip*/label
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>/sys/class/gpio/gpiochip1960/label:/soc/gpio@f9001060
</code></pre></div>
<p>This means that the GPIOs 1960 … 1963 are allocated to the push buttons (there are 4 of them).</p>
<p>4. Register interrupt for one of the dipswiches, using the appropriate GPIO number, as determined in a previous step:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>root@stratix10:~/intelFPGA#<span class="w"> </span>modprobe<span class="w"> </span>gpio_interrupt<span class="w"> </span><span class="nv">gpio_number</span><span class="o">=</span><span class="m">1928</span><span class="w"> </span><span class="nv">intr_type</span><span class="o">=</span><span class="m">3</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="o">[</span><span class="w"> </span><span class="m">1090</span>.973366<span class="o">]</span><span class="w"> </span>Interrupt<span class="w"> </span><span class="k">for</span><span class="w"> </span>GPIO:1928
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="o">[</span><span class="w"> </span><span class="m">1090</span>.973366<span class="o">]</span><span class="w"> </span>registered
</code></pre></div>
<p>5. Toggle the dipswitch a few times, you will see messages from the interrupt handler</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="o">[</span><span class="w"> </span><span class="m">1096</span>.537830<span class="o">]</span><span class="w"> </span>Interrupt<span class="w"> </span>happened<span class="w"> </span>at<span class="w"> </span>gpio:1928
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="o">[</span><span class="w"> </span><span class="m">1096</span>.547744<span class="o">]</span><span class="w"> </span>Interrupt<span class="w"> </span>happened<span class="w"> </span>at<span class="w"> </span>gpio:1928
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="o">[</span><span class="w"> </span><span class="m">1098</span>.736386<span class="o">]</span><span class="w"> </span>Interrupt<span class="w"> </span>happened<span class="w"> </span>at<span class="w"> </span>gpio:1928
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="o">[</span><span class="w"> </span><span class="m">1098</span>.740482<span class="o">]</span><span class="w"> </span>Interrupt<span class="w"> </span>happened<span class="w"> </span>at<span class="w"> </span>gpio:1928
</code></pre></div>
<p>6. Remove the driver</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>root@stratix10:~/intelFPGA#<span class="w"> </span>rmmod<span class="w"> </span>gpio_interrupt
</code></pre></div>
<p>7. Register the pushbutton interrupt, using the appropriate GPIO number as determine on a previous step</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>rroot@stratix10:~/intelFPGA#<span class="w"> </span>modprobe<span class="w"> </span>gpio_interrupt<span class="w"> </span><span class="nv">gpio_number</span><span class="o">=</span><span class="m">1960</span><span class="w"> </span><span class="nv">intr_type</span><span class="o">=</span><span class="m">2</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="o">[</span><span class="w"> </span><span class="m">1138</span>.025297<span class="o">]</span><span class="w"> </span>Interrupt<span class="w"> </span><span class="k">for</span><span class="w"> </span>GPIO:1960
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="o">[</span><span class="w"> </span><span class="m">1138</span>.025297<span class="o">]</span><span class="w"> </span>registered
</code></pre></div>
<p>8. Push the pusbutton a few times, you will see interrupt handler messages</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="o">[</span><span class="w"> </span><span class="m">1141</span>.672192<span class="o">]</span><span class="w"> </span>Interrupt<span class="w"> </span>happened<span class="w"> </span>at<span class="w"> </span>gpio:1960
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="o">[</span><span class="w"> </span><span class="m">1142</span>.110673<span class="o">]</span><span class="w"> </span>Interrupt<span class="w"> </span>happened<span class="w"> </span>at<span class="w"> </span>gpio:1960
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="o">[</span><span class="w"> </span><span class="m">1142</span>.499468<span class="o">]</span><span class="w"> </span>Interrupt<span class="w"> </span>happened<span class="w"> </span>at<span class="w"> </span>gpio:1960
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="o">[</span><span class="w"> </span><span class="m">1142</span>.884199<span class="o">]</span><span class="w"> </span>Interrupt<span class="w"> </span>happened<span class="w"> </span>at<span class="w"> </span>gpio:1960
</code></pre></div>
<p>9. Once done, remove the handler</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>root@stratix10:~/intelFPGA#<span class="w"> </span>rmmod<span class="w"> </span>gpio_interrupt
</code></pre></div>
<p><strong>Note</strong>: If you are on the ssh console, you will need to run the program <em>dmesg</em> after pressing the button in order to see the messages:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>root@stratix10:~/intelFPGA#<span class="w"> </span>dmesg
</code></pre></div>
<h4 id="connect-to-web-server">Connect to Web Server<a class="headerlink" href="#connect-to-web-server" title="Permanent link">&para;</a></h4>
<p>The GSRD includes a web server running on the target board that can be used to exercise some of the board features:</p>
<ul>
<li>Turning LEDs ON and OFF</li>
<li>Scrolling LEDs in a sequence</li>
<li>Displaying the current status of the LEDs</li>
</ul>
<p>The web page served by the web server also contains links to some relevant information on the Intel website.</p>
<p>Perform the following steps to connect to the board web server:</p>
<p>1. Boot Linux as described in <a href="https://www.rocketboards.org/foswiki/Documentation/Stratix10SoCGSRD#BootingLinux">Booting Linux</a>.</p>
<p>2. Determine the IP address of the board using 'ifconfig' as shown above. Note there will be three network interfaces, you can use anyone which is connected to the local network and gets an IP from the DHCP server.</p>
<p>Note: There are instances where the DHCP have not assigned an IP to the board before the timeout happens, in which case you may check the IP address via the UART by running <em>ifconfig</em>.</p>
<p>3. Open a web browser on the host PC and type <em>http://</em> on the address box, then type the IP of your board and hit Enter.</p>
<p><a class="glightbox" href="../images/s10-gsrd-webserver.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/s10-gsrd-webserver.png" /></a></p>
<p>4. Scroll the webpage down to the section named <strong>Interacting with Stratix 10 SoC Development Kit</strong>.</p>
<p><a class="glightbox" href="../images/s10-gsrd-webserver-interact.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/s10-gsrd-webserver-interact.png" /></a></p>
<p>You will be able to perform the following actions:</p>
<ul>
<li>See which LEDs are ON and which are off in the <strong>LED Status</strong>. Note that if the LEDs are setup to be scrolling, the displayed scrolling speed will not match the actual scrolling speed on the board.</li>
<li>Stop LEDs from scrolling, by clicking <strong>START</strong> and <strong>STOP</strong> buttons. The delay between LEDs turning ON and OFF is set in the <strong>LED Lightshow</strong> box.</li>
<li>Turn individual LEDs ON and OFF with the <strong>ON</strong> and <strong>OFF</strong> buttons. Note that this action is only available when the LED scrolling/lightshow is stopped.</li>
<li>Blink individual LEDs by typing a delay value in ms then clicking the corresponding <strong>BLINK</strong> button. Note that this action is only available when the LED scrolling/lightshow is stopped.</li>
</ul>
<h4 id="connect-using-ssh">Connect Using SSH<a class="headerlink" href="#connect-using-ssh" title="Permanent link">&para;</a></h4>
<p>1. The lower bottom of the web page presents instructions on how to connect to the board using an SSH connection.</p>
<p><a class="glightbox" href="../images/s10-gsrd-webserver-ssh.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/s10-gsrd-webserver-ssh.png" /></a></p>
<p>2. If the SSH client is not installed on your host computer, you can install it by running the following command on CentOS:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>$<span class="w"> </span>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>openssh-clients
</code></pre></div>
<p>or the following command on Ubuntu:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>openssh-client
</code></pre></div>
<p>3. Connect to the board, and run some commands, such as <strong>pwd</strong>, <strong>ls</strong> and <strong>uname</strong> to see Linux in action.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>radu@ubuntu:~$<span class="w"> </span>ssh<span class="w"> </span>root@192.168.1.48
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>The<span class="w"> </span>authenticity<span class="w"> </span>of<span class="w"> </span>host<span class="w"> </span><span class="s1">&#39;192.168.1.40 (192.168.1.40)&#39;</span><span class="w"> </span>can<span class="s1">&#39;t be established.</span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="s1">ECDSA key fingerprint is SHA256:fTZa4u/xMgLj7LB0YbeVG0qDumxD2yKCLPsObHqcVXQ.</span>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="s1">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="s1">Warning: Permanently added &#39;</span><span class="m">192</span>.168.1.40<span class="err">&#39;</span><span class="w"> </span><span class="o">(</span>ECDSA<span class="o">)</span><span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>known<span class="w"> </span>hosts.
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>Last<span class="w"> </span>login:<span class="w"> </span>Wed<span class="w"> </span>Jan<span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">22</span>:12:53<span class="w"> </span><span class="m">2023</span>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>root@stratix10:~#<span class="w"> </span><span class="nb">pwd</span>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>/home/root
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>root@stratix10:~#<span class="w"> </span>ls
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>README<span class="w"> </span>linux-socfpga-v5.15.70-lts-src.tar.gz
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>arm-trusted-firmware-v2.7-src.tar.gz<span class="w"> </span>u-boot-socfpga-v2022.07-src.tar.gz
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>intelFPGA
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a>root@stratix10:~#<span class="w"> </span>uname<span class="w"> </span>-a
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a>Linux<span class="w"> </span>stratix10<span class="w"> </span><span class="m">5</span>.15.70-altera<span class="w"> </span><span class="c1">#1 SMP PREEMPT Thu Dec 15 08:50:33 UTC 2022 aarch64 GNU/Linux</span>
<a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a>root@stratix10:~#
</code></pre></div>
<h3 id="boot-from-qspi">Boot from QSPI<a class="headerlink" href="#boot-from-qspi" title="Permanent link">&para;</a></h3>
<p>This section presents how to boot HPS from QSPI. In this scenario, in addition to the initial FPGA configuration bitstream and the HPS FSBL, the QSPI also contains the rest of the HPS software: U-Boot, Linux and Linux rootfs.</p>
<h4 id="write-qspi-image_1">Write QSPI Image<a class="headerlink" href="#write-qspi-image_1" title="Permanent link">&para;</a></h4>
<p>1. Configure MSEL to JTAG:</p>
<ul>
<li>SW2: ON-ON-ON (SW2.4 is not connected)</li>
</ul>
<p>2. Power cycle the board</p>
<p>3. Retrieve the QSPI image from the prebuilt location:</p>
<p>4. Write the image using the following commands:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>quartus_pgm<span class="w"> </span>-c<span class="w"> </span><span class="m">1</span><span class="w"> </span>-m<span class="w"> </span>jtag<span class="w"> </span>-o<span class="w"> </span><span class="s2">&quot;pvi;flash_image.hps.jic&quot;</span>
</code></pre></div>
<h4 id="boot-linux_1">Boot Linux<a class="headerlink" href="#boot-linux_1" title="Permanent link">&para;</a></h4>
<p>1. Configure MSEL back to QSPI:</p>
<ul>
<li>SW2: ON-OFF-OFF (SW2.4 is not connected)</li>
</ul>
<p>2. <strong>Important!</strong> Remove SD card, otherwise U-Boot may try to boot from it.</p>
<p>3. Power cycle. Board will boot up to Linux prompt, where you can login as 'root' without a password.</p>
<p><strong>Note</strong>: First time Linux is booted, the UBIFS rootfs will be initialized, the step taking approximately 3 minutes, as shown in the log below:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="o">[</span><span class="w"> </span><span class="m">12</span>.523260<span class="o">]</span><span class="w"> </span>platform<span class="w"> </span>soc:leds:<span class="w"> </span>deferred<span class="w"> </span>probe<span class="w"> </span>pending
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="w"> </span>…<span class="w"> </span><span class="m">3</span><span class="w"> </span>minute<span class="w"> </span><span class="s1">&#39;gap&#39;</span><span class="w"> </span>here<span class="w"> </span>...
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="o">[</span><span class="w"> </span><span class="m">205</span>.105071<span class="o">]</span><span class="w"> </span>UBIFS<span class="w"> </span><span class="o">(</span>ubi0:4<span class="o">)</span>:<span class="w"> </span>free<span class="w"> </span>space<span class="w"> </span>fixup<span class="w"> </span><span class="nb">complete</span>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="o">[</span><span class="w"> </span><span class="m">205</span>.234501<span class="o">]</span><span class="w"> </span>UBIFS<span class="w"> </span><span class="o">(</span>ubi0:4<span class="o">)</span>:<span class="w"> </span>UBIFS:<span class="w"> </span>mounted<span class="w"> </span>UBI<span class="w"> </span>device<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>volume<span class="w"> </span><span class="m">4</span>,<span class="w"> </span>name<span class="w"> </span><span class="s2">&quot;rootfs&quot;</span>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="o">[</span><span class="w"> </span><span class="m">205</span>.241896<span class="o">]</span><span class="w"> </span>UBIFS<span class="w"> </span><span class="o">(</span>ubi0:4<span class="o">)</span>:<span class="w"> </span>LEB<span class="w"> </span>size:<span class="w"> </span><span class="m">65408</span><span class="w"> </span>bytes<span class="w"> </span><span class="o">(</span><span class="m">63</span><span class="w"> </span>KiB<span class="o">)</span>,<span class="w"> </span>min./max.<span class="w"> </span>I/O<span class="w"> </span>unit<span class="w"> </span>sizes:<span class="w"> </span><span class="m">8</span><span class="w"> </span>bytes/256<span class="w"> </span>bytes
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="o">[</span><span class="w"> </span><span class="m">205</span>.251273<span class="o">]</span><span class="w"> </span>UBIFS<span class="w"> </span><span class="o">(</span>ubi0:4<span class="o">)</span>:<span class="w"> </span>FS<span class="w"> </span>size:<span class="w"> </span><span class="m">167117440</span><span class="w"> </span>bytes<span class="w"> </span><span class="o">(</span><span class="m">159</span><span class="w"> </span>MiB,<span class="w"> </span><span class="m">2555</span><span class="w"> </span>LEBs<span class="o">)</span>,<span class="w"> </span>max<span class="w"> </span><span class="m">6500</span><span class="w"> </span>LEBs,<span class="w"> </span>journal<span class="w"> </span>size<span class="w"> </span><span class="m">8650240</span><span class="w"> </span>bytes<span class="w"> </span><span class="o">(</span><span class="m">8</span><span class="w"> </span>MiB,<span class="w"> </span><span class="m">133</span><span class="w"> </span>LEBs<span class="o">)</span>
</code></pre></div>
<p>On the first boot empty pages are identifies and erased, to ensure all pages are 0xFF and avoid problematic non-0xFF empty page. This is controlled by the "-F" parameter passed when creating the rootfs.ubifs image. The next boots will not have this this step. Refer to http://www.linux-mtd.infradead.org/faq/ubifs.html for more details.</p>
<h3 id="boot-from-nand">Boot from NAND<a class="headerlink" href="#boot-from-nand" title="Permanent link">&para;</a></h3>
<p>This section presents how to exercise the boot from NAND scenario for the GSRD.</p>
<h4 id="nand-daughtercard">NAND Daughtercard<a class="headerlink" href="#nand-daughtercard" title="Permanent link">&para;</a></h4>
<p>The NAND/eMMC HPS daughtercard that comes with the S10 SoC DevKit supports both NAND and eMMC.</p>
<p>To configure the card for NAND operation, please set the jumpers as shown below:</p>
<table>
<thead>
<tr>
<th align="left">Jumper</th>
<th align="left">Setting</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">J2</td>
<td align="left">unpopulated</td>
</tr>
<tr>
<td align="left">J9</td>
<td align="left">unpopulated</td>
</tr>
<tr>
<td align="left">J10</td>
<td align="left">populated 2-3</td>
</tr>
<tr>
<td align="left">J11</td>
<td align="left">populated 1-1</td>
</tr>
</tbody>
</table>
<p>For reference, the NAND/eMMC schematic is available at https://www.intel.com/content/dam/altera-www/global/en_US/support/boards-kits/arria10/soc/hps_io48_nand_dc.pdf.</p>
<h4 id="write-nand-binaries">Write NAND Binaries<a class="headerlink" href="#write-nand-binaries" title="Permanent link">&para;</a></h4>
<p>1. Copy files to your TFTP server folder:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>cp<span class="w"> </span>-f<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/gsrd_socfpga/stratix10_htile-gsrd-images/u-boot-stratix10-socdk-gsrd-atf/u-boot.itb&lt;your-tftp-server-folder&gt;
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>cp<span class="w"> </span>-f<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/nand-bin/root.ubi<span class="w"> </span>&lt;your-tftp-server-folder&gt;
</code></pre></div>
<p>2. Run U-Boot with the debugger, similar to how it is described at <a href="https://rocketboards.org/foswiki/Documentation/BuildingBootloader#Stratix_10_SOC_45_Run_U_45Boot_from_Debugger">https://rocketboards.org/foswiki/Documentation/BuildingBootloader#Stratix_10_SOC_45_Run_U_45Boot_from_Debugger</a> just change the script to use the binaries directly from <code>$TOP_FOLDER/gsrd_socfpga/stratix10_htile-gsrd-images/u-boot-stratix10-socdk-gsrd-atf/</code>.</p>
<p>3. Stop at U-Boot prompt, and run the following instructions to download and write NAND binaries to flash:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>setenv<span class="w"> </span>autoload<span class="w"> </span>no
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>dhcp
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>setenv<span class="w"> </span>serverip<span class="w"> </span>&lt;your-tftp-server-ip&gt;
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>tftp<span class="w"> </span><span class="nv">$loadaddr</span><span class="w"> </span>u-boot.itb
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>nand<span class="w"> </span>erase.part<span class="w"> </span>u-boot
<a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a>nand<span class="w"> </span>write<span class="w"> </span><span class="nv">$loadaddr</span><span class="w"> </span>u-boot<span class="w"> </span><span class="nv">$filesize</span>
<a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a>
<a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a>tftp<span class="w"> </span><span class="nv">$loadaddr</span><span class="w"> </span>root.ubi
<a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a>nand<span class="w"> </span>erase.part<span class="w"> </span>clean<span class="w"> </span>root
<a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a>nand<span class="w"> </span>write.trimffs<span class="w"> </span><span class="nv">$loadaddr</span><span class="w"> </span>root<span class="w"> </span><span class="nv">$filesize</span>
</code></pre></div>
<h4 id="write-qspi-image_2">Write QSPI Image<a class="headerlink" href="#write-qspi-image_2" title="Permanent link">&para;</a></h4>
<p>1. Power off board</p>
<p>2. Set MSEL to JTAG</p>
<p>3. Power on board</p>
<p>4. Write jic image to QSPI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>quartus_pgm<span class="w"> </span>-c<span class="w"> </span><span class="m">1</span><span class="w"> </span>-m<span class="w"> </span>jtag<span class="w"> </span>-o<span class="w"> </span><span class="s2">&quot;pvi;ghrd_1sx280hu2f50e1vgas.hps.jic&quot;</span>
</code></pre></div>
<h4 id="boot-linux_2">Boot Linux<a class="headerlink" href="#boot-linux_2" title="Permanent link">&para;</a></h4>
<p>1. Power off the board. Make sure MSEL is set to QSPI.</p>
<p>2. Power on the board.</p>
<p>3. Linux will boot, use 'root' as username, with no password.</p>
<h3 id="partial-reconfiguration">Partial Reconfiguration<a class="headerlink" href="#partial-reconfiguration" title="Permanent link">&para;</a></h3>
<p>Partial reconfiguration (PR) allows you to reconfigure a portion of the FPGA dynamically, while the rest of the FPGA design continues to function. This section presents how to run the PR scenarios included with the GSRD.</p>
<h4 id="reference-information">Reference Information<a class="headerlink" href="#reference-information" title="Permanent link">&para;</a></h4>
<p>Refer to the following fore more details about Partial Reconfiguration</p>
<ul>
<li>User Guide<ul>
<li><a href="https://www.intel.com/content/dam/altera-www/global/en_US/pdfs/literature/ug/ug-qpp-pr.pdf">Intel Quartus Prime Pro Edition User Guide: Partial Reconfiguration</a></li>
</ul>
</li>
</ul>
<ul>
<li>Partial Reconfiguration for Intel FPGA Devices YouTube videos:<ul>
<li><a href="https://www.youtube.com/watch?v=NAdn39EKWA0">Part1: Introduction &amp; Project Assignments</a></li>
<li><a href="https://www.youtube.com/watch?v=drb0cB_TZ3Y">Part2: Design Guidelines &amp; Host Requirements</a></li>
<li><a href="https://www.youtube.com/watch?v=DS4_xeLNG1c">Part3: PR Host IP &amp; Implementations</a></li>
<li><a href="https://www.youtube.com/watch?v=K-h5FfFrqes">Part4: Output Files &amp; Demonstration</a></li>
</ul>
</li>
</ul>
<h4 id="hardware-design">Hardware Design<a class="headerlink" href="#hardware-design" title="Permanent link">&para;</a></h4>
<p>The GHRD contains the following components which enable PR:</p>
<ul>
<li>A PR region was created in the FPGA fabric, with the following associated IP<ul>
<li>PR Freeze Controller - to help control the PR</li>
<li>Avalon-MM PR Freeze Bridge - to help isolate the IP in the PR region during the PR process</li>
</ul>
</li>
</ul>
<ul>
<li>The base revision of the project has the following in the PR region:<ul>
<li>SysID located at 0xF900_0800: with id=0xfacecafe</li>
<li>OCRAM located at 0xF900_0900</li>
</ul>
</li>
</ul>
<ul>
<li>An alternate revision of the project contains the following in the PR region:<ul>
<li>SysID located at 0xF900_0900: with id=0xcafeface</li>
<li>OCRAM located at 0xF900_0800</li>
</ul>
</li>
</ul>
<p>The following diagram presents an overview of the PR region and associated IP and how it is connected to HPS:</p>
<p><a class="glightbox" href="../images/pr-hwdesign.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/pr-hwdesign.png" /></a></p>
<p>Throughout this page, the content of the PR region for the base revision is called "persona0" while the content of the PR region for the other revision is called "persona1". The diagram below illustrates the differences between the two personas:</p>
<p><a class="glightbox" href="../images/pr-personas.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/pr-personas.png" /></a></p>
<h4 id="pr-files">PR Files<a class="headerlink" href="#pr-files" title="Permanent link">&para;</a></h4>
<p>The files on the Linux rootfs used for running the PR scenarios are shown below:</p>
<table>
<thead>
<tr>
<th align="left">File</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">/sbin/dtbt</td>
<td align="left">Tool used for managing the overlays. Available at https://github.com/altera-opensource/dtbt</td>
</tr>
<tr>
<td align="left">/boot/devicetree/stratix10_htile_pr_fpga_static_region.dtbo</td>
<td align="left">overlay for the static region, needs to be applied before persona overlays</td>
</tr>
<tr>
<td align="left">/boot/devicetree/stratix10_htile_pr_persona0.dtbo</td>
<td align="left">overlay for persona0</td>
</tr>
<tr>
<td align="left">/boot/devicetree/stratix10_htile_pr_persona1.dtbo</td>
<td align="left">overlay for persona1</td>
</tr>
<tr>
<td align="left">/lib/firmware/persona0.rbf</td>
<td align="left">bitstream used by persona0 overlay</td>
</tr>
<tr>
<td align="left">/lib/firmware/persona1.rbf</td>
<td align="left">bitstream used by persona1 overlay</td>
</tr>
</tbody>
</table>
<p>The DTS files for the overlays are available at https://github.com/altera-opensource/meta-intel-fpga-refdes/tree/scarthgap/recipes-bsp/device-tree/files:</p>
<ul>
<li>stratix10_htile_pr_fpga_static_region.dts</li>
<li>stratix10_htile_pr_persona0.dts</li>
<li>stratix10_htile_pr_persona1.dts</li>
</ul>
<h4 id="running-pr-scenarios">Running PR Scenarios<a class="headerlink" href="#running-pr-scenarios" title="Permanent link">&para;</a></h4>
<p>1. Boot Linux</p>
<p>2. Add the overlay for the static region:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>root@stratix10:~#<span class="w"> </span>dtbt<span class="w"> </span>-a<span class="w"> </span>stratix10_htile_pr_fpga_static_region.dtbo<span class="w"> </span>-p<span class="w"> </span>/boot/devicetree
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>Set<span class="w"> </span>dtbo<span class="w"> </span>search<span class="w"> </span>path<span class="w"> </span>to<span class="w"> </span>/boot
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>Applying<span class="w"> </span>dtbo:<span class="w"> </span>fpga_static_region.dtbo
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="o">[</span><span class="w"> </span><span class="m">141</span>.686353<span class="o">]</span><span class="w"> </span>OF:<span class="w"> </span>overlay:<span class="w"> </span>WARNING:<span class="w"> </span>memory<span class="w"> </span>leak<span class="w"> </span>will<span class="w"> </span>occur<span class="w"> </span><span class="k">if</span><span class="w"> </span>overlay<span class="w"> </span>removed,<span class="w"> </span>property:<span class="w"> </span>/soc/base_fpga_region/ranges
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="o">[</span><span class="w"> </span><span class="m">141</span>.698256<span class="o">]</span><span class="w"> </span>OF:<span class="w"> </span>overlay:<span class="w"> </span>WARNING:<span class="w"> </span>memory<span class="w"> </span>leak<span class="w"> </span>will<span class="w"> </span>occur<span class="w"> </span><span class="k">if</span><span class="w"> </span>overlay<span class="w"> </span>removed,<span class="w"> </span>property:<span class="w"> </span>/soc/base_fpga_region/external-fpga-config
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="o">[</span><span class="w"> </span><span class="m">141</span>.709907<span class="o">]</span><span class="w"> </span>OF:<span class="w"> </span>overlay:<span class="w"> </span>WARNING:<span class="w"> </span>memory<span class="w"> </span>leak<span class="w"> </span>will<span class="w"> </span>occur<span class="w"> </span><span class="k">if</span><span class="w"> </span>overlay<span class="w"> </span>removed,<span class="w"> </span>property:<span class="w"> </span>/soc/base_fpga_region/clocks
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="o">[</span><span class="w"> </span><span class="m">141</span>.720335<span class="o">]</span><span class="w"> </span>OF:<span class="w"> </span>overlay:<span class="w"> </span>WARNING:<span class="w"> </span>memory<span class="w"> </span>leak<span class="w"> </span>will<span class="w"> </span>occur<span class="w"> </span><span class="k">if</span><span class="w"> </span>overlay<span class="w"> </span>removed,<span class="w"> </span>property:<span class="w"> </span>/soc/base_fpga_region/clock-names
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="o">[</span><span class="w"> </span><span class="m">141</span>.731276<span class="o">]</span><span class="w"> </span>OF:<span class="w"> </span>overlay:<span class="w"> </span>WARNING:<span class="w"> </span>memory<span class="w"> </span>leak<span class="w"> </span>will<span class="w"> </span>occur<span class="w"> </span><span class="k">if</span><span class="w"> </span>overlay<span class="w"> </span>removed,<span class="w"> </span>property:<span class="w"> </span>/__symbols__/clk_0
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="o">[</span><span class="w"> </span><span class="m">141</span>.740852<span class="o">]</span><span class="w"> </span>OF:<span class="w"> </span>overlay:<span class="w"> </span>WARNING:<span class="w"> </span>memory<span class="w"> </span>leak<span class="w"> </span>will<span class="w"> </span>occur<span class="w"> </span><span class="k">if</span><span class="w"> </span>overlay<span class="w"> </span>removed,<span class="w"> </span>property:<span class="w"> </span>/__symbols__/freeze_controller_0
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="o">[</span><span class="w"> </span><span class="m">141</span>.756396<span class="o">]</span><span class="w"> </span>of-fpga-region<span class="w"> </span>soc:base_fpga_region:fpga_pr_region0:<span class="w"> </span>FPGA<span class="w"> </span>Region<span class="w"> </span>probed
<a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="o">[</span><span class="w"> </span><span class="m">141</span>.780483<span class="o">]</span><span class="w"> </span>altera_freeze_br<span class="w"> </span>f9000450.freeze_controller:<span class="w"> </span>fpga<span class="w"> </span>bridge<span class="w"> </span><span class="o">[</span>freeze<span class="o">]</span><span class="w"> </span>registered
</code></pre></div>
<p>3. Add the overlay for persona0:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>root@stratix10:~#<span class="w"> </span>dtbt<span class="w"> </span>-a<span class="w"> </span>stratix10_htile_pr_persona0.dtbo<span class="w"> </span>-p<span class="w"> </span>/boot/devicetree
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>Set<span class="w"> </span>dtbo<span class="w"> </span>search<span class="w"> </span>path<span class="w"> </span>to<span class="w"> </span>/boot
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>Applying<span class="w"> </span>dtbo:<span class="w"> </span>persona0.dtbo
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="o">[</span><span class="w"> </span><span class="m">190</span>.741610<span class="o">]</span><span class="w"> </span>fpga_manager<span class="w"> </span>fpga0:<span class="w"> </span>writing<span class="w"> </span>persona0.rbf<span class="w"> </span>to<span class="w"> </span>Stratix10<span class="w"> </span>SOC<span class="w"> </span>FPGA<span class="w"> </span>Manager
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="o">[</span><span class="w"> </span><span class="m">191</span>.251227<span class="o">]</span><span class="w"> </span>svc_normal_to_secure_thread:<span class="w"> </span>STATUS_ERROR
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="o">[</span><span class="w"> </span><span class="m">191</span>.251871<span class="o">]</span><span class="w"> </span>OF:<span class="w"> </span>overlay:<span class="w"> </span>WARNING:<span class="w"> </span>memory<span class="w"> </span>leak<span class="w"> </span>will<span class="w"> </span>occur<span class="w"> </span><span class="k">if</span><span class="w"> </span>overlay<span class="w"> </span>removed,<span class="w"> </span>property:<span class="w"> </span>/__symbols__/pr_region_0_pr_clk_100
<a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a><span class="o">[</span><span class="w"> </span><span class="m">191</span>.266963<span class="o">]</span><span class="w"> </span>svc_normal_to_secure_thread:<span class="w"> </span>STATUS_ERROR
<a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a><span class="o">[</span><span class="w"> </span><span class="m">191</span>.267349<span class="o">]</span><span class="w"> </span>OF:<span class="w"> </span>overlay:<span class="w"> </span>WARNING:<span class="w"> </span>memory<span class="w"> </span>leak<span class="w"> </span>will<span class="w"> </span>occur<span class="w"> </span><span class="k">if</span><span class="w"> </span>overlay<span class="w"> </span>removed,<span class="w"> </span>property:<span class="w"> </span>/__symbols__/pr_region_0_pr_sysid_qsys_0
<a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a><span class="o">[</span><span class="w"> </span><span class="m">191</span>.282704<span class="o">]</span><span class="w"> </span>svc_normal_to_secure_thread:<span class="w"> </span>STATUS_ERROR
</code></pre></div>
<p>4. Locate the sysid and display the associated id:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>root@stratix10:~#<span class="w"> </span>find<span class="w"> </span>/<span class="w"> </span>-name<span class="w"> </span>sysid
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>/sys/devices/platform/soc/soc:base_fpga_region/soc:base_fpga_region:fpga_pr_region0/f9000800.sysid/sysid
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>root@stratix10:~#<span class="w"> </span>cat<span class="w"> </span>/sys/devices/platform/soc/soc:base_fpga_region/soc:base_fpga_region:fpga_pr_region0/f9000800.sysid/sysid/id<span class="w"> </span><span class="p">|</span><span class="w"> </span>xargs<span class="w"> </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;0x%08x\n&quot;</span>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>0xcafeface
</code></pre></div>
<p>5. List the applied overlays:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>root@stratix10:~#<span class="w"> </span>dtbt<span class="w"> </span>-l
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="m">2</span><span class="w"> </span>persona0.dtbo<span class="w"> </span>applied<span class="w"> </span>/sys/kernel/config/device-tree/overlays/2-persona0.dtbo
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="m">1</span><span class="w"> </span>fpga_static_region.dtbo<span class="w"> </span>applied<span class="w"> </span>/sys/kernel/config/device-tree/overlays/1-fpga_static_region.dtbo
</code></pre></div>
<p>6. Remove persona0 overlay:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>root@stratix10:~#<span class="w"> </span>dtbt<span class="w"> </span>-r<span class="w"> </span>stratix10_htile_pr_persona0.dtbo<span class="w"> </span>-p<span class="w"> </span>/boot/devicetree
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>Set<span class="w"> </span>dtbo<span class="w"> </span>search<span class="w"> </span>path<span class="w"> </span>to<span class="w"> </span>/boot
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>Removing<span class="w"> </span>dtbo:<span class="w"> </span><span class="m">2</span>-persona0.dtbo
</code></pre></div>
<p>7. Add the persona1 overlay:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>root@stratix10:~#<span class="w"> </span>dtbt<span class="w"> </span>-a<span class="w"> </span>stratix10_htile_pr_persona1.dtbo<span class="w"> </span>-p<span class="w"> </span>/boot/devicetree
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>Set<span class="w"> </span>dtbo<span class="w"> </span>search<span class="w"> </span>path<span class="w"> </span>to<span class="w"> </span>/boot
<a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>Applying<span class="w"> </span>dtbo:<span class="w"> </span>persona1.dtbo
<a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a><span class="o">[</span><span class="w"> </span><span class="m">343</span>.885073<span class="o">]</span><span class="w"> </span>fpga_manager<span class="w"> </span>fpga0:<span class="w"> </span>writing<span class="w"> </span>persona1.rbf<span class="w"> </span>to<span class="w"> </span>Stratix10<span class="w"> </span>SOC<span class="w"> </span>FPGA<span class="w"> </span>Manager
<a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a><span class="o">[</span><span class="w"> </span><span class="m">344</span>.385019<span class="o">]</span><span class="w"> </span>OF:<span class="w"> </span>overlay:<span class="w"> </span>WARNING:<span class="w"> </span>memory<span class="w"> </span>leak<span class="w"> </span>will<span class="w"> </span>occur<span class="w"> </span><span class="k">if</span><span class="w"> </span>overlay<span class="w"> </span>removed,<span class="w"> </span>property:<span class="w"> </span>/__symbols__/pr_region_0_pr_clk_100
<a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a><span class="o">[</span><span class="w"> </span><span class="m">344</span>.396098<span class="o">]</span><span class="w"> </span>OF:<span class="w"> </span>overlay:<span class="w"> </span>WARNING:<span class="w"> </span>memory<span class="w"> </span>leak<span class="w"> </span>will<span class="w"> </span>occur<span class="w"> </span><span class="k">if</span><span class="w"> </span>overlay<span class="w"> </span>removed,<span class="w"> </span>property:<span class="w"> </span>/__symbols__/pr_region_0_pr_sysid_qsys_0
</code></pre></div>
<p>8. Locate the sysid and display the associated id:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>root@stratix10:~#<span class="w"> </span>find<span class="w"> </span>/<span class="w"> </span>-name<span class="w"> </span>sysid
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>/sys/devices/platform/soc/soc:base_fpga_region/soc:base_fpga_region:fpga_pr_region0/f9000900.sysid/sysid
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a>root@stratix10:~#<span class="w"> </span>cat<span class="w"> </span>/sys/devices/platform/soc/soc:base_fpga_region/soc:base_fpga_region:fpga_pr_region0/f9000900.sysid/sysid/id<span class="w"> </span><span class="p">|</span><span class="w"> </span>xargs<span class="w"> </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;0x%08x\n&quot;</span>
<a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>0xfacecafe
</code></pre></div>
<p>9. Remove persona1:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>root@stratix10:~#<span class="w"> </span>dtbt<span class="w"> </span>-r<span class="w"> </span>stratix10_htile_pr_persona1.dtbo<span class="w"> </span>-p<span class="w"> </span>/boot/devicetree
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>Set<span class="w"> </span>dtbo<span class="w"> </span>search<span class="w"> </span>path<span class="w"> </span>to<span class="w"> </span>/boot
<a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>Removing<span class="w"> </span>dtbo:<span class="w"> </span><span class="m">2</span>-persona1.dtbo
</code></pre></div>
<p>10. List the applied overlays:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>root@stratix10:~#<span class="w"> </span>dtbt<span class="w"> </span>-l
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="m">1</span><span class="w"> </span>fpga_static_region.dtbo<span class="w"> </span>applied<span class="w"> </span>/sys/kernel/config/device-tree/overlays/1-fpga_static_region.dtbo
</code></pre></div>
<h2 id="rebuild-the-gsrd">Rebuild the GSRD<a class="headerlink" href="#rebuild-the-gsrd" title="Permanent link">&para;</a></h2>
<p>This section presents how to rebuild the GSRD for various scenarios covered by this release.</p>
<h3 id="boot-from-sd-card_1">Boot from SD Card<a class="headerlink" href="#boot-from-sd-card_1" title="Permanent link">&para;</a></h3>
<h4 id="build-flow">Build Flow<a class="headerlink" href="#build-flow" title="Permanent link">&para;</a></h4>
<p>The following diagram illustrates the full build flow for the GSRD based on source code from GitHub.</p>
<p><a class="glightbox" href="../images/s10-gsrd-build-flow.svg" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/s10-gsrd-build-flow.svg" /></a></p>
<p>The current build flow creates a single boot image which is able to boot in different board configurations (either using OOBE or eMMC/NAND daughter card). For more information about how this single boot image is created, please refer to the following article: https://rocketboards.org/foswiki/Documentation/SingleImageBoot</p>
<h4 id="set-up-environment">Set up Environment<a class="headerlink" href="#set-up-environment" title="Permanent link">&para;</a></h4>
<p>Create a top folder for this example, as the rest of the commands assume this location:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>sudo<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>stratix10_gsrd
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>mkdir<span class="w"> </span>stratix10_gsrd
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="nb">cd</span><span class="w"> </span>stratix10_gsrd
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a><span class="nb">export</span><span class="w"> </span><span class="nv">TOP_FOLDER</span><span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>
</code></pre></div>
<p>Download the compiler toolchain, add it to the PATH variable, to be used by the GHRD makefile to build the HPS Debug FSBL:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>wget<span class="w"> </span>https://developer.arm.com/-/media/Files/downloads/gnu/11.2-2022.02/binrel/<span class="se">\</span>
<a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a>gcc-arm-11.2-2022.02-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a>tar<span class="w"> </span>xf<span class="w"> </span>gcc-arm-11.2-2022.02-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a>rm<span class="w"> </span>-f<span class="w"> </span>gcc-arm-11.2-2022.02-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>/gcc-arm-11.2-2022.02-x86_64-aarch64-none-linux-gnu/bin:<span class="nv">$PATH</span>
<a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a><span class="nb">export</span><span class="w"> </span><span class="nv">ARCH</span><span class="o">=</span>arm64
<a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a><span class="nb">export</span><span class="w"> </span><span class="nv">CROSS_COMPILE</span><span class="o">=</span>aarch64-none-linux-gnu-
</code></pre></div>
<p>Enable Quartus tools to be called from command line:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_ROOTDIR</span><span class="o">=</span>~/intelFPGA_pro/24.3/quartus/
<a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>/bin:<span class="nv">$QUARTUS_ROOTDIR</span>/linux64:<span class="nv">$QUARTUS_ROOTDIR</span>/../qsys/bin:<span class="nv">$PATH</span>
</code></pre></div>
<h4 id="build-hardware-design">Build Hardware Design<a class="headerlink" href="#build-hardware-design" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>ghrd-socfpga<span class="w"> </span>s10_soc_devkit_ghrd
<a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS24.3_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-opensource/ghrd-socfpga
<a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a>mv<span class="w"> </span>ghrd-socfpga/s10_soc_devkit_ghrd<span class="w"> </span>.
<a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a>rm<span class="w"> </span>-rf<span class="w"> </span>ghrd-socfpga
<a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a><span class="nb">cd</span><span class="w"> </span>s10_soc_devkit_ghrd
<a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_DEVICE</span><span class="o">=</span>1SX280HU2F50E1VGAS
<a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a>make<span class="w"> </span>scrub_clean_all
<a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a>make<span class="w"> </span>generate_from_tcl
<a id="__codelineno-44-10" name="__codelineno-44-10" href="#__codelineno-44-10"></a>make<span class="w"> </span>all
<a id="__codelineno-44-11" name="__codelineno-44-11" href="#__codelineno-44-11"></a><span class="nb">unset</span><span class="w"> </span>QUARTUS_DEVICE
<a id="__codelineno-44-12" name="__codelineno-44-12" href="#__codelineno-44-12"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<p>The following files are created in $TOP_FOLDER/s10_soc_devkit_ghrd/output_files:</p>
<ul>
<li>ghrd_1sx280hu2f50e1vgas.sof - FPGA SOF file, without HPS FSBL</li>
<li>ghrd_1sx280hu2f50e1vgas_hps_debug.sof - FPGA SOF, with HPS Debug FSBL</li>
</ul>
<h4 id="build-core-rbf">Build Core RBF<a class="headerlink" href="#build-core-rbf" title="Permanent link">&para;</a></h4>
<p>Create the Core RBF file to be used in the rootfs created by Yocto by using the HPS Debug SOF built by the GHRD makefile:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>s10_soc_devkit_ghrd/output_files/ghrd_1sx280hu2f50e1vgas_hps_debug.sof<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a><span class="w"> </span>ghrd_1sx280hu2f50e1vgas.jic<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">device</span><span class="o">=</span>MT25QU02G<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">flash_loader</span><span class="o">=</span>1SX280HU2<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">mode</span><span class="o">=</span>ASX4<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">hps</span><span class="o">=</span><span class="m">1</span>
<a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a>rm<span class="w"> </span>ghrd_1sx280hu2f50e1vgas.hps.jic
</code></pre></div>
<p>The following files will be created:</p>
<ul>
<li>$TOP_FOLDER/ghrd_1sx280hu2f50e1vgas.core.rbf - HPS First configuration bitstream, phase 2: FPGA fabric</li>
</ul>
<p>Note we are also creating an HPS JIC file, but we are discarding it, as it has the HPS Debug FSBL, while the final image needs to have the U-Boot SPL created by the Yocto recipes.</p>
<h4 id="set-up-yocto">Set Up Yocto<a class="headerlink" href="#set-up-yocto" title="Permanent link">&para;</a></h4>
<p>1. Make sure you have Yocto system requirements met: https://docs.yoctoproject.org/5.0.1/ref-manual/system-requirements.html#supported-linux-distributions.</p>
<p>The command to install the required packages on Ubuntu 22.04 is:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>update
<a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>upgrade
<a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>openssh-server<span class="w"> </span>mc<span class="w"> </span>libgmp3-dev<span class="w"> </span>libmpc-dev<span class="w"> </span>gawk<span class="w"> </span>wget<span class="w"> </span>git<span class="w"> </span>diffstat<span class="w"> </span>unzip<span class="w"> </span>texinfo<span class="w"> </span>gcc<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a>build-essential<span class="w"> </span>chrpath<span class="w"> </span>socat<span class="w"> </span>cpio<span class="w"> </span>python3<span class="w"> </span>python3-pip<span class="w"> </span>python3-pexpect<span class="w"> </span>xz-utils<span class="w"> </span>debianutils<span class="w"> </span>iputils-ping<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a>python3-git<span class="w"> </span>python3-jinja2<span class="w"> </span>libegl1-mesa<span class="w"> </span>libsdl1.2-dev<span class="w"> </span>pylint<span class="w"> </span>xterm<span class="w"> </span>python3-subunit<span class="w"> </span>mesa-common-dev<span class="w"> </span>zstd<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a>liblz4-tool<span class="w"> </span>git<span class="w"> </span>fakeroot<span class="w"> </span>build-essential<span class="w"> </span>ncurses-dev<span class="w"> </span>xz-utils<span class="w"> </span>libssl-dev<span class="w"> </span>bc<span class="w"> </span>flex<span class="w"> </span>libelf-dev<span class="w"> </span>bison<span class="w"> </span>xinetd<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a>tftpd<span class="w"> </span>tftp<span class="w"> </span>nfs-kernel-server<span class="w"> </span>libncurses5<span class="w"> </span>libc6-i386<span class="w"> </span>libstdc++6:i386<span class="w"> </span>libgcc++1:i386<span class="w"> </span>lib32z1<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a>device-tree-compiler<span class="w"> </span>curl<span class="w"> </span>mtd-utils<span class="w"> </span>u-boot-tools<span class="w"> </span>net-tools<span class="w"> </span>swig<span class="w"> </span>-y
</code></pre></div>
<p>On Ubuntu 22.04 you will also need to point the /bin/sh to /bin/bash, as the default is a link to /bin/dash:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="w"> </span>sudo<span class="w"> </span>ln<span class="w"> </span>-sf<span class="w"> </span>/bin/bash<span class="w"> </span>/bin/sh
</code></pre></div>
<p><strong>Note</strong>: You can also use a Docker container to build the Yocto recipes, refer to https://rocketboards.org/foswiki/Documentation/DockerYoctoBuild for details. When using a Docker container, it does not matter what Linux distribution or packages you have installed on your host, as all dependencies are provided by the Docker container.</p>
<p>2. Clone the Yocto script and prepare the build:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>gsrd_socfpga
<a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS24.3_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-opensource/gsrd_socfpga
<a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a><span class="nb">cd</span><span class="w"> </span>gsrd_socfpga
<a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a>.<span class="w"> </span>stratix10_htile-gsrd-build.sh
<a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a>build_setup
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>/gsrd_socfpga
<a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a>.<span class="w"> </span>./poky/oe-init-build-env<span class="w"> </span>stratix10-gsrd-rootfs/
</code></pre></div>
<h4 id="customize-yocto">Customize Yocto<a class="headerlink" href="#customize-yocto" title="Permanent link">&para;</a></h4>
<p>1. Copy the rebuilt files to <code>$WORKSPACE/meta-intel-fpga-refdes/recipes-bsp/ghrd/files</code> using the following names, as expected by the yocto recipes:</p>
<ul>
<li>stratix10_htile_gsrd_ghrd.core.rbf</li>
<li>stratix10_htile_pr_persona0.rbf: not applicable, PR not enabled in this scenario</li>
<li>stratix10_htile_pr_persona1.rbf: not applicable, PR not enabled in this scenario</li>
<li>stratix10_htile_nand_ghrd.core.rbf: not applicable, as we have not rebuilt the NAND version</li>
</ul>
<p>This can be accomplished using the following instructions:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="nv">GHRD_LOC</span><span class="o">=</span><span class="nv">$WORKSPACE</span>/meta-intel-fpga-refdes/recipes-bsp/ghrd/files
<a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="nv">CORE_RBF</span><span class="o">=</span><span class="nv">$GHRD_LOC</span>/stratix10_htile_gsrd_ghrd.core.rbf
<a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a>cp<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/ghrd_1sx280hu2f50e1vgas.core.rbf<span class="w"> </span><span class="nv">$CORE_RBF</span>
</code></pre></div>
<p>2. Update the Yocto recipe at <code>$WORKSPACE/meta-intel-fpga-refdes/recipes-bsp/ghrd/hw-ref-design.bb</code> to change the <code>SRC_URI:stratix10</code> from the orginal value:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a>SRC_URI:stratix10<span class="w"> </span>?<span class="o">=</span><span class="w"> </span><span class="s2">&quot;\</span>
<a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a><span class="s2"> </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_htile_gsrd_</span><span class="si">${</span><span class="nv">ARM64_GHRD_CORE_RBF</span><span class="si">}</span><span class="s2">;name=stratix10_htile_gsrd_core \</span>
<a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a><span class="s2"> </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_htile_nand_</span><span class="si">${</span><span class="nv">ARM64_GHRD_CORE_RBF</span><span class="si">}</span><span class="s2">;name=stratix10_htile_nand_core \</span>
<a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a><span class="s2"> </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_htile_pr_persona0.rbf;name=stratix10_htile_pr_persona0 \</span>
<a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a><span class="s2"> </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_htile_pr_persona1.rbf;name=stratix10_htile_pr_persona1 \</span>
<a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a><span class="s2"> &quot;</span>
</code></pre></div>
<p>to be:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a>SRC_URI:stratix10<span class="w"> </span>?<span class="o">=</span><span class="w"> </span><span class="s2">&quot;\</span>
<a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a><span class="s2"> file://stratix10_htile_gsrd_ghrd.core.rbf \</span>
<a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a><span class="s2"> </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_htile_nand_</span><span class="si">${</span><span class="nv">ARM64_GHRD_CORE_RBF</span><span class="si">}</span><span class="s2">;name=stratix10_htile_nand_core \</span>
<a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a><span class="s2"> </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_htile_pr_persona0.rbf;name=stratix10_htile_pr_persona0 \</span>
<a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a><span class="s2"> </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_htile_pr_persona1.rbf;name=stratix10_htile_pr_persona1 \</span>
<a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a><span class="s2"> &quot;</span>
</code></pre></div>
<p>using the following commands from the console:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="nv">OLD_CORE_URI</span><span class="o">=</span><span class="s2">&quot;\${GHRD_REPO}\/stratix10_htile_gsrd_\${ARM64_GHRD_CORE_RBF};name=stratix10_htile_gsrd_core&quot;</span>
<a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a><span class="nv">NEW_CORE_URI</span><span class="o">=</span><span class="s2">&quot;file:\/\/stratix10_htile_gsrd_ghrd.core.rbf&quot;</span>
<a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a><span class="nv">RECIPE</span><span class="o">=</span><span class="nv">$WORKSPACE</span>/meta-intel-fpga-refdes/recipes-bsp/ghrd/hw-ref-design.bb
<a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/</span><span class="nv">$OLD_CORE_URI</span><span class="s2">/</span><span class="nv">$NEW_CORE_URI</span><span class="s2">/g&quot;</span><span class="w"> </span><span class="nv">$RECIPE</span>
</code></pre></div>
<p>Note we have left the PR and NAND files alone, that will be downloaded from rocketboards.</p>
<p>3. Update the same Yocto recipe to change the SHA checksums for the new files:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>SRC_URI<span class="o">[</span>stratix10_htile_gsrd_core.sha256sum<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;ea26a77ebc1b3141193de6dd32e22f332785e05c956de85118c3790392141d3c&quot;</span>
</code></pre></div>
<p>to the new values using the following commands:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="nv">CORE_SHA</span><span class="o">=</span><span class="k">$(</span>sha256sum<span class="w"> </span><span class="nv">$CORE_RBF</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-f1<span class="w"> </span>-d<span class="s2">&quot; &quot;</span><span class="k">)</span>
<a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a><span class="nv">OLD_CORE_SHA</span><span class="o">=</span><span class="s2">&quot;SRC_URI\[stratix10_htile_gsrd_core\.sha256sum\] = .*&quot;</span>
<a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a><span class="nv">NEW_CORE_SHA</span><span class="o">=</span><span class="s2">&quot;SRC_URI[stratix10_htile_gsrd_core.sha256sum] = \&quot;</span><span class="nv">$CORE_SHA</span><span class="s2">\&quot;&quot;</span>
<a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/</span><span class="nv">$OLD_CORE_SHA</span><span class="s2">/</span><span class="nv">$NEW_CORE_SHA</span><span class="s2">/g&quot;</span><span class="w"> </span><span class="nv">$RECIPE</span>
</code></pre></div>
<p>4. Optionally change the following files in <code>$WORKSPACE/meta-intel-fpga-refdes/recipes-bsp/u-boot/files/</code>:</p>
<ul>
<li><a href="https://github.com/altera-opensource/meta-intel-fpga-refdes/blob/master/recipes-bsp/u-boot/files/uboot.txt">uboot.txt</a> - distroboot script</li>
<li><a href="https://github.com/altera-opensource/meta-intel-fpga-refdes/blob/master/recipes-bsp/u-boot/files/uboot_script.its">uboot_script.its</a> - its file for creating FIT image from the above script</li>
</ul>
<p>5. Optionally change the following file in <code>$WORKSPACE/meta-intel-fpga-refdes/recipes-kernel/linux/linux-socfpga-lts</code>:</p>
<ul>
<li>
<p>fit_kernel_stratix10.its - its file for creating the kernel.itb image, containing by default:</p>
<ul>
<li>Kernel</li>
<li>Device trees for SD and NAND board configurations</li>
<li>Core RBF files for SD and NAND board configurations</li>
<li>Board configurations for SD and NAND cases</li>
</ul>
</li>
</ul>
<h4 id="build-yocto">Build Yocto<a class="headerlink" href="#build-yocto" title="Permanent link">&para;</a></h4>
<p>Build Yocto:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a>bitbake_image
</code></pre></div>
<p>Gather files:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a>package
</code></pre></div>
<p>Once the build is completed successfully, you will see the following two folders are created:</p>
<ul>
<li><code>stratix10_htile_gsrd_rootfs</code>: area used by OpenEmbedded build system for builds. Description of build directory structure - https://docs.yoctoproject.org/ref-manual/structure.html#the-build-directory-build</li>
<li><code>stratix10_htile_gsrd_images</code>: the build script copies here relevant files built by Yocto from the <code>stratix10_htile_gsrd_rootfs/tmp/deploy/images/agilex</code> folder, but also other relevant files.</li>
</ul>
<p>The two most relevant files created in the <code>$TOP_FOLDER/gsrd_socfpga/stratix10_htile-gsrd-images</code> folder are:</p>
<table>
<thead>
<tr>
<th align="left">File</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">sdimage.tar.gz</td>
<td align="left">SD Card Image</td>
</tr>
<tr>
<td align="left">u-boot-stratix10-socdk-gsrd-atf/u-boot-spl-dtb.hex</td>
<td align="left">U-Boot SPL Hex file</td>
</tr>
</tbody>
</table>
<h4 id="create-qspi-image">Create QSPI Image<a class="headerlink" href="#create-qspi-image" title="Permanent link">&para;</a></h4>
<p>The QSPI image will contain the FPGA configuration data and the HPS FSBL and it can be built using the following command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>s10_soc_devkit_ghrd/output_files/ghrd_1sx280hu2f50e1vgas.sof<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a><span class="w"> </span>ghrd_1sx280hu2f50e1vgas.jic<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">device</span><span class="o">=</span>MT25QU02G<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-58-5" name="__codelineno-58-5" href="#__codelineno-58-5"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">flash_loader</span><span class="o">=</span>1SX280HU2<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-58-6" name="__codelineno-58-6" href="#__codelineno-58-6"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">hps_path</span><span class="o">=</span>gsrd_socfpga/stratix10_htile-gsrd-images/u-boot-stratix10-socdk-gsrd-atf/u-boot-spl-dtb.hex<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-58-7" name="__codelineno-58-7" href="#__codelineno-58-7"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">mode</span><span class="o">=</span>ASX4<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-58-8" name="__codelineno-58-8" href="#__codelineno-58-8"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">hps</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
<p>The following files will be created:</p>
<ul>
<li>$TOP_FOLDER/ghrd_1sx280hu2f50e1vgas.hps.jic - Flash image for HPS First configuration bitstream, phase 1: HPS and DDR</li>
<li>$TOP_FOLDER/ghrd_1sx280hu2f50e1vgas.core.rbf - HPS First configuration bitstream, phase 2: FPGA fabric. We already have the same file on the SD card.</li>
</ul>
<h3 id="boot-from-qspi_1">Boot from QSPI<a class="headerlink" href="#boot-from-qspi_1" title="Permanent link">&para;</a></h3>
<p>This section presents how to boot the Stratix 10 SoC from QSPI, using the rebuilt GSRD binaries.</p>
<p>The same binaries as when booting from SD card can be used to boot from QSPI, because:</p>
<ul>
<li>The QSPI resides on the DevKit board, and not on the HPS daughtercard, so there are no board changes:</li>
<li>The same GHRD configuration can be used</li>
<li>The same U-Boot devce tree can be used</li>
<li>The same Linux device tree can be used</li>
<li>U-Boot uses distroboot, which will try first booting from SD/MMC, then from QSPI, then from NAND, so the same U-Boot can be used.</li>
</ul>
<p><strong>Note</strong>: As the QSPI has a much smaller size than the SD card (256MB vs 2GB) the rootfs is smaller, and less functionality is provided. The purpose of this section is just to show Linux booting.</p>
<p><strong>Note</strong>: The HPS speed for accessing SDM QSPI is limited to ~4MB/s. It is up to you to decide whether this level of performance is sufficient for your application. If not, it is recommended you use an SD card or eMMC device to store the HPS components such as the rootfs. Note that the QSPI speed limitation does not apply when SDM accesses the QSPI, it is just for HPS accessing SDM QSPI.</p>
<h4 id="qspi-flash-layout">QSPI Flash Layout<a class="headerlink" href="#qspi-flash-layout" title="Permanent link">&para;</a></h4>
<table>
  <thead>
    <tr><th>MTD Partition</th><th>UBI Volume</th><th>Volume Name</th><th>Type</th><th>Image/File</th><th>Size</th></tr>
  </thead>
  <tbody>
    <tr><td rowspan="2">0 (bitstream &amp; uboot)</td><td>N/A</td><td>N/A</td><td>RAW</td><td>bitstream (FPGA image, SDM firmware)</td><td>64MB</td></tr>
    <tr><td>N/A</td><td>N/A</td><td>RAW</td><td>u-boot.itb</td><td>2MB</td></tr>
    <tr><td rowspan="5">1 (root.ubi)</td><td>0</td><td>env</td><td>UBI</td><td>u-boot.env</td><td>256KB</td></tr>
    <tr><td>1</td><td>script</td><td>UBI</td><td>u-boot.scr</td><td>128KB</td></tr>
    <tr><td>2</td><td>kernel</td><td>UBI</td><td>kernel.itb</td><td>24MB</td></tr>
    <tr><td>3</td><td>dtb</td><td>UBI</td><td>kernel.dtb</td><td>256KB</td></tr>
    <tr><td>4</td><td>rootfs</td><td>UBIFS</td><td>rootfs.ubifs</td><td>160MB</td></tr>
  </tbody>
</table>

<h4 id="create-qspi-image_1">Create QSPI Image<a class="headerlink" href="#create-qspi-image_1" title="Permanent link">&para;</a></h4>
<p>1. Create a folder to contain all the qspi binaries, and create symlinks to actual location for all files:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>qspi-boot<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>qspi-boot<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>qspi-boot
<a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a>ln<span class="w"> </span>-s<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/s10_soc_devkit_ghrd/output_files/ghrd_1sx280hu2f50e1vgas.sof<span class="w"> </span>fpga.sof
<a id="__codelineno-59-4" name="__codelineno-59-4" href="#__codelineno-59-4"></a>ln<span class="w"> </span>-s<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/gsrd_socfpga/stratix10_htile-gsrd-images/u-boot-stratix10-socdk-gsrd-atf/u-boot-spl-dtb.hex<span class="w"> </span>spl.hex
<a id="__codelineno-59-5" name="__codelineno-59-5" href="#__codelineno-59-5"></a>ln<span class="w"> </span>-s<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/gsrd_socfpga/stratix10_htile-gsrd-images/u-boot-stratix10-socdk-gsrd-atf/boot.scr.uimg<span class="w"> </span>.
<a id="__codelineno-59-6" name="__codelineno-59-6" href="#__codelineno-59-6"></a>ln<span class="w"> </span>-s<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/gsrd_socfpga/stratix10_htile-gsrd-images/kernel.itb<span class="w"> </span>.
<a id="__codelineno-59-7" name="__codelineno-59-7" href="#__codelineno-59-7"></a>ln<span class="w"> </span>-s<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/gsrd_socfpga/stratix10_htile-gsrd-images/console-image-minimal-stratix10_nor.ubifs<span class="w"> </span>rootfs.ubifs
</code></pre></div>
<p>2. Create U-Boot image:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>/qspi-boot
<a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a>cp<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/gsrd_socfpga/stratix10_htile-gsrd-images/u-boot-stratix10-socdk-gsrd-atf/u-boot.itb<span class="w"> </span>.
<a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a><span class="nv">uboot_part_size</span><span class="o">=</span><span class="m">2</span>*1024*1024
<a id="__codelineno-60-4" name="__codelineno-60-4" href="#__codelineno-60-4"></a><span class="nv">uboot_size</span><span class="o">=</span><span class="sb">`</span>wc<span class="w"> </span>-c<span class="w"> </span>&lt;<span class="w"> </span>u-boot.itb<span class="sb">`</span>
<a id="__codelineno-60-5" name="__codelineno-60-5" href="#__codelineno-60-5"></a><span class="nv">uboot_pad</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$((</span><span class="nv">uboot_part_size</span><span class="o">-</span><span class="nv">uboot_size</span><span class="k">))</span><span class="s2">&quot;</span>
<a id="__codelineno-60-6" name="__codelineno-60-6" href="#__codelineno-60-6"></a>truncate<span class="w"> </span>-s<span class="w"> </span>+<span class="nv">$uboot_pad</span><span class="w"> </span>u-boot.itb
<a id="__codelineno-60-7" name="__codelineno-60-7" href="#__codelineno-60-7"></a>mv<span class="w"> </span>u-boot.itb<span class="w"> </span>u-boot.bin
</code></pre></div>
<p>4. Create hps.ubi file:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>/qspi-boot
<a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a>cat<span class="w"> </span><span class="s">&lt;&lt;EOT &gt;ubinize.cfg</span>
<a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a><span class="s">[env]</span>
<a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a><span class="s">mode=ubi</span>
<a id="__codelineno-61-5" name="__codelineno-61-5" href="#__codelineno-61-5"></a><span class="s">vol_id=0</span>
<a id="__codelineno-61-6" name="__codelineno-61-6" href="#__codelineno-61-6"></a><span class="s">vol_name=env</span>
<a id="__codelineno-61-7" name="__codelineno-61-7" href="#__codelineno-61-7"></a><span class="s">vol_size=256KiB</span>
<a id="__codelineno-61-8" name="__codelineno-61-8" href="#__codelineno-61-8"></a><span class="s">vol_type=dynamic</span>
<a id="__codelineno-61-9" name="__codelineno-61-9" href="#__codelineno-61-9"></a>
<a id="__codelineno-61-10" name="__codelineno-61-10" href="#__codelineno-61-10"></a><span class="s">[script]</span>
<a id="__codelineno-61-11" name="__codelineno-61-11" href="#__codelineno-61-11"></a><span class="s">mode=ubi</span>
<a id="__codelineno-61-12" name="__codelineno-61-12" href="#__codelineno-61-12"></a><span class="s">image=boot.scr.uimg</span>
<a id="__codelineno-61-13" name="__codelineno-61-13" href="#__codelineno-61-13"></a><span class="s">vol_id=1</span>
<a id="__codelineno-61-14" name="__codelineno-61-14" href="#__codelineno-61-14"></a><span class="s">vol_name=script</span>
<a id="__codelineno-61-15" name="__codelineno-61-15" href="#__codelineno-61-15"></a><span class="s">vol_size=128KiB</span>
<a id="__codelineno-61-16" name="__codelineno-61-16" href="#__codelineno-61-16"></a><span class="s">vol_type=dynamic</span>
<a id="__codelineno-61-17" name="__codelineno-61-17" href="#__codelineno-61-17"></a>
<a id="__codelineno-61-18" name="__codelineno-61-18" href="#__codelineno-61-18"></a><span class="s">[kernel]</span>
<a id="__codelineno-61-19" name="__codelineno-61-19" href="#__codelineno-61-19"></a><span class="s">mode=ubi</span>
<a id="__codelineno-61-20" name="__codelineno-61-20" href="#__codelineno-61-20"></a><span class="s">image=kernel.itb</span>
<a id="__codelineno-61-21" name="__codelineno-61-21" href="#__codelineno-61-21"></a><span class="s">vol_id=2</span>
<a id="__codelineno-61-22" name="__codelineno-61-22" href="#__codelineno-61-22"></a><span class="s">vol_name=kernel</span>
<a id="__codelineno-61-23" name="__codelineno-61-23" href="#__codelineno-61-23"></a><span class="s">vol_size=24MiB</span>
<a id="__codelineno-61-24" name="__codelineno-61-24" href="#__codelineno-61-24"></a><span class="s">vol_type=dynamic</span>
<a id="__codelineno-61-25" name="__codelineno-61-25" href="#__codelineno-61-25"></a>
<a id="__codelineno-61-26" name="__codelineno-61-26" href="#__codelineno-61-26"></a><span class="s">[dtb]</span>
<a id="__codelineno-61-27" name="__codelineno-61-27" href="#__codelineno-61-27"></a><span class="s">mode=ubi</span>
<a id="__codelineno-61-28" name="__codelineno-61-28" href="#__codelineno-61-28"></a><span class="s">vol_id=3</span>
<a id="__codelineno-61-29" name="__codelineno-61-29" href="#__codelineno-61-29"></a><span class="s">vol_name=dtb</span>
<a id="__codelineno-61-30" name="__codelineno-61-30" href="#__codelineno-61-30"></a><span class="s">vol_size=256KiB</span>
<a id="__codelineno-61-31" name="__codelineno-61-31" href="#__codelineno-61-31"></a><span class="s">vol_type=dynamic</span>
<a id="__codelineno-61-32" name="__codelineno-61-32" href="#__codelineno-61-32"></a>
<a id="__codelineno-61-33" name="__codelineno-61-33" href="#__codelineno-61-33"></a><span class="s">[rootfs]</span>
<a id="__codelineno-61-34" name="__codelineno-61-34" href="#__codelineno-61-34"></a><span class="s">mode=ubi</span>
<a id="__codelineno-61-35" name="__codelineno-61-35" href="#__codelineno-61-35"></a><span class="s">image=rootfs.ubifs</span>
<a id="__codelineno-61-36" name="__codelineno-61-36" href="#__codelineno-61-36"></a><span class="s">vol_id=4</span>
<a id="__codelineno-61-37" name="__codelineno-61-37" href="#__codelineno-61-37"></a><span class="s">vol_name=rootfs</span>
<a id="__codelineno-61-38" name="__codelineno-61-38" href="#__codelineno-61-38"></a><span class="s">vol_type=dynamic</span>
<a id="__codelineno-61-39" name="__codelineno-61-39" href="#__codelineno-61-39"></a><span class="s">vol_size=160MiB</span>
<a id="__codelineno-61-40" name="__codelineno-61-40" href="#__codelineno-61-40"></a><span class="s">vol_flag=autoresize</span>
<a id="__codelineno-61-41" name="__codelineno-61-41" href="#__codelineno-61-41"></a>
<a id="__codelineno-61-42" name="__codelineno-61-42" href="#__codelineno-61-42"></a><span class="s">EOT</span>
<a id="__codelineno-61-43" name="__codelineno-61-43" href="#__codelineno-61-43"></a>ubinize<span class="w"> </span>-o<span class="w"> </span>root.ubi<span class="w"> </span>-p<span class="w"> </span><span class="m">65536</span><span class="w"> </span>-m<span class="w"> </span><span class="m">1</span><span class="w"> </span>-s<span class="w"> </span><span class="m">1</span><span class="w"> </span>ubinize.cfg
<a id="__codelineno-61-44" name="__codelineno-61-44" href="#__codelineno-61-44"></a>ln<span class="w"> </span>-s<span class="w"> </span>root.ubi<span class="w"> </span>hps.bin
</code></pre></div>
<p>5. Create the QSPI image using the provided Quartus Programming File Generator (PFG) file:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>/qspi-boot
<a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a>wget<span class="w"> </span>https://altera-fpga.github.io/rel-24.3/embedded-designs/stratix-10/sx/soc/gsrd/collateral/stratix10_gsrd.pfg
<a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>stratix10_gsrd.pfg
</code></pre></div>
<p>The following files will be generated:</p>
<ul>
<li>$TOP_FOLDER/qspi-boot/flash_image.hps.jic - JIC QSPI flash image</li>
<li>$TOP_FOLDER/qspi-boot/s10_flash_image.core.rbf - fabric configuration file, already generated previously with the debug HPS FSBL</li>
</ul>
<h4 id="create-programming-file-generator-file">Create Programming File Generator File<a class="headerlink" href="#create-programming-file-generator-file" title="Permanent link">&para;</a></h4>
<p>This section presents how to manually re-create the PFG file provided at <a href="https://altera-fpga.github.io/rel-24.3/embedded-designs/stratix-10/sx/soc/gsrd/collateral/stratix10_gsrd.pfg">https://altera-fpga.github.io/rel-24.3/embedded-designs/stratix-10/sx/soc/gsrd/collateral/stratix10_gsrd.pfg</a></p>
<p>1. Start Quartus Programming File Generator GUI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>/qspi-boot
<a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a>qpfgw<span class="w"> </span><span class="p">&amp;</span>
</code></pre></div>
<p>2. In PFG <strong>Output Files</strong> tab:</p>
<ul>
<li>Select <strong>Device Family</strong> as "Stratix 10"</li>
<li>Select <strong>Configuration Mode</strong> as "Active Serial x4"</li>
<li>Edit <strong>Name</strong> as "flash_image"</li>
<li>Check <strong>Raw Binary File for HPS Core Configuration (.rbf)</strong> option</li>
<li>Check the following sub-options:</li>
<li>Check <strong>JTAG Indirect Configuration File (.jic)</strong></li>
<li>Check <strong>Memory Map File (.map)</strong></li>
</ul>
<p><a class="glightbox" href="../images/s10-qspi-boot-output-files.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/s10-qspi-boot-output-files.png" /></a></p>
<p>3. In PFG <strong>Input Files</strong> tab:</p>
<ul>
<li>Click <strong>Add Bitstream", then browse to "fpga.sof" link, and add click *Open</strong> to add it.</li>
<li>Click <strong>Bitstream_1&gt;fpga.sof</strong> then click <strong>Properties</strong> the click <strong>HPS Bootloader</strong>, browse to "spl.hex" then click <strong>Open</strong> to add it.
 Note: By the time the fpga.sof file is read the following error is displayed, this was addressed by adding the spl.hex file to the Bitstream:
  File fpga.sof is incomplete- HPS is present but bootloader information is missing.</li>
<li>Click <strong>Add Raw Data</strong> then change the extension filter to <strong>.bin</strong> then browse to "u-boot.bin" and click <strong>Open</strong> to add it.</li>
<li>Click on the "u-boot.bin" then click "<em>Properties</em>" then select <strong>Bit swap</strong> option to "On"</li>
<li>Repeat the above 2 steps for the following file:</li>
<li>hps.bin</li>
</ul>
<p>The <strong>Input Files</strong> tab will now look something like this:</p>
<p><a class="glightbox" href="../images/s10-qspi-boot-input-files.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/s10-qspi-boot-input-files.png" /></a></p>
<p>4. In the PFG <strong>Configuration Device</strong> tab:</p>
<ul>
<li>Click <strong>Add Device</strong>, select the Micron MT25QU02G device then click <strong>Add</strong></li>
<li>Click the <strong>MT25QU02G</strong> device, then click <strong>Add Partition</strong>, select the options as following then click <strong>OK</strong>:</li>
</ul>
<p><a class="glightbox" href="../images/s10-qspi-boot-add-bitstream-partition.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/s10-qspi-boot-add-bitstream-partition.png" /></a></p>
<ul>
<li>Click the <strong>MT25QU02G</strong> device, then click <strong>Add Partition</strong>, select the options as following then click <strong>OK</strong>:</li>
</ul>
<p><a class="glightbox" href="../images/s10-qspi-boot-add-u-boot-partition.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/s10-qspi-boot-add-u-boot-partition.png" /></a></p>
<ul>
<li>Repeat the above step for the rest of binary files, choosing the following offsets:</li>
<li>hps: 0x04200000</li>
<li>Click <strong>Flash Loader</strong> &gt; <strong>Select</strong> then browse to the device used on the devkit then click <strong>OK</strong>:</li>
</ul>
<p><a class="glightbox" href="../images/s10-qspi-boot-flash-loader.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/s10-qspi-boot-flash-loader.png" /></a></p>
<p>The <strong>Configuration Device</strong> tab will now look something like this:</p>
<p><a class="glightbox" href="../images/s10-qspi-boot-configuration-device.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/s10-qspi-boot-configuration-device.png" /></a></p>
<p>3. Go to <strong>File</strong> &gt; <strong>Save As</strong> and save the configuration file as "s10_flash_image_qspi.pfg".</p>
<p>4. [Optional] Open the file "stratix10_gsrd.pfg" with a text editor and change absolute paths to relative paths.</p>
<p>The file will look like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a><span class="nt">&lt;pfg</span><span class="w"> </span><span class="na">version=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
<a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a><span class="w">    </span><span class="nt">&lt;settings</span><span class="w"> </span><span class="na">custom_db_dir=</span><span class="s">&quot;./&quot;</span><span class="w"> </span><span class="na">mode=</span><span class="s">&quot;ASX4&quot;</span><span class="nt">/&gt;</span>
<a id="__codelineno-64-3" name="__codelineno-64-3" href="#__codelineno-64-3"></a><span class="w">    </span><span class="nt">&lt;output_files&gt;</span>
<a id="__codelineno-64-4" name="__codelineno-64-4" href="#__codelineno-64-4"></a><span class="w">        </span><span class="nt">&lt;output_file</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;flash_image&quot;</span><span class="w"> </span><span class="na">hps=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">directory=</span><span class="s">&quot;./&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;PERIPH_JIC&quot;</span><span class="nt">&gt;</span>
<a id="__codelineno-64-5" name="__codelineno-64-5" href="#__codelineno-64-5"></a><span class="w">            </span><span class="nt">&lt;file_options/&gt;</span>
<a id="__codelineno-64-6" name="__codelineno-64-6" href="#__codelineno-64-6"></a><span class="w">            </span><span class="nt">&lt;secondary_file</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;MAP&quot;</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;flash_image_jic&quot;</span><span class="nt">&gt;</span>
<a id="__codelineno-64-7" name="__codelineno-64-7" href="#__codelineno-64-7"></a><span class="w">                </span><span class="nt">&lt;file_options/&gt;</span>
<a id="__codelineno-64-8" name="__codelineno-64-8" href="#__codelineno-64-8"></a><span class="w">            </span><span class="nt">&lt;/secondary_file&gt;</span>
<a id="__codelineno-64-9" name="__codelineno-64-9" href="#__codelineno-64-9"></a><span class="w">            </span><span class="nt">&lt;flash_device_id&gt;</span>Flash_Device_1<span class="nt">&lt;/flash_device_id&gt;</span>
<a id="__codelineno-64-10" name="__codelineno-64-10" href="#__codelineno-64-10"></a><span class="w">        </span><span class="nt">&lt;/output_file&gt;</span>
<a id="__codelineno-64-11" name="__codelineno-64-11" href="#__codelineno-64-11"></a><span class="w">    </span><span class="nt">&lt;/output_files&gt;</span>
<a id="__codelineno-64-12" name="__codelineno-64-12" href="#__codelineno-64-12"></a><span class="w">    </span><span class="nt">&lt;bitstreams&gt;</span>
<a id="__codelineno-64-13" name="__codelineno-64-13" href="#__codelineno-64-13"></a><span class="w">        </span><span class="nt">&lt;bitstream</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;Bitstream_1&quot;</span><span class="nt">&gt;</span>
<a id="__codelineno-64-14" name="__codelineno-64-14" href="#__codelineno-64-14"></a><span class="w">            </span><span class="nt">&lt;path</span><span class="w"> </span><span class="na">signing=</span><span class="s">&quot;OFF&quot;</span><span class="w"> </span><span class="na">finalize_encryption=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">hps_path=</span><span class="s">&quot;spl.hex&quot;</span><span class="nt">&gt;</span>fpga.sof<span class="nt">&lt;/path&gt;</span>
<a id="__codelineno-64-15" name="__codelineno-64-15" href="#__codelineno-64-15"></a><span class="w">        </span><span class="nt">&lt;/bitstream&gt;</span>
<a id="__codelineno-64-16" name="__codelineno-64-16" href="#__codelineno-64-16"></a><span class="w">    </span><span class="nt">&lt;/bitstreams&gt;</span>
<a id="__codelineno-64-17" name="__codelineno-64-17" href="#__codelineno-64-17"></a><span class="w">    </span><span class="nt">&lt;raw_files&gt;</span>
<a id="__codelineno-64-18" name="__codelineno-64-18" href="#__codelineno-64-18"></a><span class="w">        </span><span class="nt">&lt;raw_file</span><span class="w"> </span><span class="na">bitswap=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;RBF&quot;</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;Raw_File_1&quot;</span><span class="nt">&gt;</span>u-boot.bin<span class="nt">&lt;/raw_file&gt;</span>
<a id="__codelineno-64-19" name="__codelineno-64-19" href="#__codelineno-64-19"></a><span class="w">        </span><span class="nt">&lt;raw_file</span><span class="w"> </span><span class="na">bitswap=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;RBF&quot;</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;Raw_File_2&quot;</span><span class="nt">&gt;</span>hps.bin<span class="nt">&lt;/raw_file&gt;</span>
<a id="__codelineno-64-20" name="__codelineno-64-20" href="#__codelineno-64-20"></a><span class="w">    </span><span class="nt">&lt;/raw_files&gt;</span>
<a id="__codelineno-64-21" name="__codelineno-64-21" href="#__codelineno-64-21"></a><span class="w">    </span><span class="nt">&lt;flash_devices&gt;</span>
<a id="__codelineno-64-22" name="__codelineno-64-22" href="#__codelineno-64-22"></a><span class="w">        </span><span class="nt">&lt;flash_device</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;MT25QU02G&quot;</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;Flash_Device_1&quot;</span><span class="nt">&gt;</span>
<a id="__codelineno-64-23" name="__codelineno-64-23" href="#__codelineno-64-23"></a><span class="w">            </span><span class="nt">&lt;partition</span><span class="w"> </span><span class="na">reserved=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">fixed_s_addr=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">s_addr=</span><span class="s">&quot;0x00000000&quot;</span><span class="w"> </span><span class="na">e_addr=</span><span class="s">&quot;0x000FFFFF&quot;</span><span class="w"> </span><span class="na">fixed_e_addr=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;BOOT_INFO&quot;</span><span class="w"> </span><span class="na">size=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
<a id="__codelineno-64-24" name="__codelineno-64-24" href="#__codelineno-64-24"></a><span class="w">            </span><span class="nt">&lt;partition</span><span class="w"> </span><span class="na">reserved=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">fixed_s_addr=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">s_addr=</span><span class="s">&quot;auto&quot;</span><span class="w"> </span><span class="na">e_addr=</span><span class="s">&quot;auto&quot;</span><span class="w"> </span><span class="na">fixed_e_addr=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;P1&quot;</span><span class="w"> </span><span class="na">size=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
<a id="__codelineno-64-25" name="__codelineno-64-25" href="#__codelineno-64-25"></a><span class="w">            </span><span class="nt">&lt;partition</span><span class="w"> </span><span class="na">reserved=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">fixed_s_addr=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">s_addr=</span><span class="s">&quot;0x04000000&quot;</span><span class="w"> </span><span class="na">e_addr=</span><span class="s">&quot;auto&quot;</span><span class="w"> </span><span class="na">fixed_e_addr=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;u-boot&quot;</span><span class="w"> </span><span class="na">size=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
<a id="__codelineno-64-26" name="__codelineno-64-26" href="#__codelineno-64-26"></a><span class="w">            </span><span class="nt">&lt;partition</span><span class="w"> </span><span class="na">reserved=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">fixed_s_addr=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">s_addr=</span><span class="s">&quot;0x04200000&quot;</span><span class="w"> </span><span class="na">e_addr=</span><span class="s">&quot;auto&quot;</span><span class="w"> </span><span class="na">fixed_e_addr=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;hps&quot;</span><span class="w"> </span><span class="na">size=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
<a id="__codelineno-64-27" name="__codelineno-64-27" href="#__codelineno-64-27"></a><span class="w">        </span><span class="nt">&lt;/flash_device&gt;</span>
<a id="__codelineno-64-28" name="__codelineno-64-28" href="#__codelineno-64-28"></a><span class="w">        </span><span class="nt">&lt;flash_loader&gt;</span>1SX280HU2<span class="nt">&lt;/flash_loader&gt;</span>
<a id="__codelineno-64-29" name="__codelineno-64-29" href="#__codelineno-64-29"></a><span class="w">    </span><span class="nt">&lt;/flash_devices&gt;</span>
<a id="__codelineno-64-30" name="__codelineno-64-30" href="#__codelineno-64-30"></a><span class="w">    </span><span class="nt">&lt;assignments&gt;</span>
<a id="__codelineno-64-31" name="__codelineno-64-31" href="#__codelineno-64-31"></a><span class="w">        </span><span class="nt">&lt;assignment</span><span class="w"> </span><span class="na">page=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">partition_id=</span><span class="s">&quot;P1&quot;</span><span class="nt">&gt;</span>
<a id="__codelineno-64-32" name="__codelineno-64-32" href="#__codelineno-64-32"></a><span class="w">            </span><span class="nt">&lt;bitstream_id&gt;</span>Bitstream_1<span class="nt">&lt;/bitstream_id&gt;</span>
<a id="__codelineno-64-33" name="__codelineno-64-33" href="#__codelineno-64-33"></a><span class="w">        </span><span class="nt">&lt;/assignment&gt;</span>
<a id="__codelineno-64-34" name="__codelineno-64-34" href="#__codelineno-64-34"></a><span class="w">        </span><span class="nt">&lt;assignment</span><span class="w"> </span><span class="na">page=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">partition_id=</span><span class="s">&quot;u-boot&quot;</span><span class="nt">&gt;</span>
<a id="__codelineno-64-35" name="__codelineno-64-35" href="#__codelineno-64-35"></a><span class="w">            </span><span class="nt">&lt;raw_file_id&gt;</span>Raw_File_1<span class="nt">&lt;/raw_file_id&gt;</span>
<a id="__codelineno-64-36" name="__codelineno-64-36" href="#__codelineno-64-36"></a><span class="w">        </span><span class="nt">&lt;/assignment&gt;</span>
<a id="__codelineno-64-37" name="__codelineno-64-37" href="#__codelineno-64-37"></a><span class="w">        </span><span class="nt">&lt;assignment</span><span class="w"> </span><span class="na">page=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">partition_id=</span><span class="s">&quot;hps&quot;</span><span class="nt">&gt;</span>
<a id="__codelineno-64-38" name="__codelineno-64-38" href="#__codelineno-64-38"></a><span class="w">            </span><span class="nt">&lt;raw_file_id&gt;</span>Raw_File_2<span class="nt">&lt;/raw_file_id&gt;</span>
<a id="__codelineno-64-39" name="__codelineno-64-39" href="#__codelineno-64-39"></a><span class="w">        </span><span class="nt">&lt;/assignment&gt;</span>
<a id="__codelineno-64-40" name="__codelineno-64-40" href="#__codelineno-64-40"></a><span class="w">    </span><span class="nt">&lt;/assignments&gt;</span>
<a id="__codelineno-64-41" name="__codelineno-64-41" href="#__codelineno-64-41"></a><span class="nt">&lt;/pfg&gt;</span>
</code></pre></div>
<h3 id="boot-from-nand_1">Boot from NAND<a class="headerlink" href="#boot-from-nand_1" title="Permanent link">&para;</a></h3>
<p>This section presents how to boot the Stratix 10 SoC from NAND, including how to build all binaries.</p>
<p>Build instructions are the same as for standard SD or QSPI boot. The U-Boot, ATF and Linux binaries are all the same. The only differences are:</p>
<ul>
<li>GHRD is configured for the NAND HPS Daughtercard, then recompiled</li>
<li>The PR persona.rbf files are the ones compiled by the GHRD configured for NAND</li>
</ul>
<p><strong>Note</strong>: As the NAND used on the devkit has a smaller size than the SD card (1GB vs 2GB) the rootfs is smaller, and less functionality is provided. The purpose of this section is just to show Linux booting.</p>
<h4 id="nand-flash-layout">NAND Flash Layout<a class="headerlink" href="#nand-flash-layout" title="Permanent link">&para;</a></h4>
<table>
  <thead>
    <tr><th>MTD Partition</th><th>UBI Volume</th><th>Volume Name</th><th>Type</th><th>Image/File</th><th>Flash Offset</th><th>Size</th><th>Size in Hex</th></tr>
  </thead>
  <tbody>
    <tr><td rowspan="1">0 (u-boot)</td><td>N/A</td><td>N/A</td><td>RAW</td><td>u-boot.itb</td><td>0x00000000</td><td>2MB</td><td>0x00200000</td></tr>
    <tr><td rowspan="5">1 (root.ubi)</td><td>0</td><td>env</td><td>UBI</td><td>u-boot.env</td><td>0x00200000</td><td>256KB</td><td>0x40000</td></tr>
    <tr><td>1</td><td>script</td><td>UBI</td><td>u-boot.scr</td><td>0x00240000</td><td>128KB</td><td>0x0020000</td></tr>
    <tr><td>2</td><td>kernel</td><td>UBI</td><td>kernel.itb</td><td>0x00260000 onwards</td><td>64MB</td><td>0x04000000</td></tr>
    <tr><td>3</td><td>dtb</td><td>UBI</td><td>kernel.dtb</td><td></td><td>256KB</td><td>0x0004000</td></tr>
    <tr><td>4</td><td>rootfs</td><td>UBIFS</td><td>rootfs.ubifs</td><td></td><td>&lt;957MB</td><td>&lt;0x3BD70000</td></tr>
  </tbody>
</table>

<h4 id="set-up-environment_1">Set up Environment<a class="headerlink" href="#set-up-environment_1" title="Permanent link">&para;</a></h4>
<p>Create a top folder for this example, as the rest of the commands assume this location:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a>sudo<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>stratix10_gsrd.nand
<a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a>mkdir<span class="w"> </span>stratix10_gsrd.nand
<a id="__codelineno-65-3" name="__codelineno-65-3" href="#__codelineno-65-3"></a><span class="nb">cd</span><span class="w"> </span>stratix10_gsrd.nand
<a id="__codelineno-65-4" name="__codelineno-65-4" href="#__codelineno-65-4"></a><span class="nb">export</span><span class="w"> </span><span class="nv">TOP_FOLDER</span><span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>
</code></pre></div>
<p>Download the compiler toolchain, add it to the PATH variable, to be used by the GHRD makefile to build the HPS Debug FSBL:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a>wget<span class="w"> </span>https://developer.arm.com/-/media/Files/downloads/gnu/11.2-2022.02/binrel/<span class="se">\</span>
<a id="__codelineno-66-3" name="__codelineno-66-3" href="#__codelineno-66-3"></a>gcc-arm-11.2-2022.02-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-66-4" name="__codelineno-66-4" href="#__codelineno-66-4"></a>tar<span class="w"> </span>xf<span class="w"> </span>gcc-arm-11.2-2022.02-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-66-5" name="__codelineno-66-5" href="#__codelineno-66-5"></a>rm<span class="w"> </span>-f<span class="w"> </span>gcc-arm-11.2-2022.02-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-66-6" name="__codelineno-66-6" href="#__codelineno-66-6"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>/gcc-arm-11.2-2022.02-x86_64-aarch64-none-linux-gnu/bin:<span class="nv">$PATH</span>
<a id="__codelineno-66-7" name="__codelineno-66-7" href="#__codelineno-66-7"></a><span class="nb">export</span><span class="w"> </span><span class="nv">ARCH</span><span class="o">=</span>arm64
<a id="__codelineno-66-8" name="__codelineno-66-8" href="#__codelineno-66-8"></a><span class="nb">export</span><span class="w"> </span><span class="nv">CROSS_COMPILE</span><span class="o">=</span>aarch64-none-linux-gnu-
</code></pre></div>
<p>Enable Quartus tools to be called from command line:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_ROOTDIR</span><span class="o">=</span>~/intelFPGA_pro/24.3/quartus/
<a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>/bin:<span class="nv">$QUARTUS_ROOTDIR</span>/linux64:<span class="nv">$QUARTUS_ROOTDIR</span>/../qsys/bin:<span class="nv">$PATH</span>
</code></pre></div>
<h4 id="build-hardware-design_1">Build Hardware Design<a class="headerlink" href="#build-hardware-design_1" title="Permanent link">&para;</a></h4>
<p>Build the GHRD targeting the NAND HPS daughtercard, by passing the correct parameter to the make utility:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>ghrd-socfpga<span class="w"> </span>s10_soc_devkit_ghrd
<a id="__codelineno-68-3" name="__codelineno-68-3" href="#__codelineno-68-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS24.3_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-opensource/ghrd-socfpga
<a id="__codelineno-68-4" name="__codelineno-68-4" href="#__codelineno-68-4"></a>mv<span class="w"> </span>ghrd-socfpga/s10_soc_devkit_ghrd<span class="w"> </span>.
<a id="__codelineno-68-5" name="__codelineno-68-5" href="#__codelineno-68-5"></a>rm<span class="w"> </span>-rf<span class="w"> </span>ghrd-socfpga
<a id="__codelineno-68-6" name="__codelineno-68-6" href="#__codelineno-68-6"></a><span class="nb">cd</span><span class="w"> </span>s10_soc_devkit_ghrd
<a id="__codelineno-68-7" name="__codelineno-68-7" href="#__codelineno-68-7"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_DEVICE</span><span class="o">=</span>1SX280HU2F50E1VGAS
<a id="__codelineno-68-8" name="__codelineno-68-8" href="#__codelineno-68-8"></a><span class="nb">export</span><span class="w"> </span><span class="nv">DAUGHTER_CARD</span><span class="o">=</span>devkit_dc_nand
<a id="__codelineno-68-9" name="__codelineno-68-9" href="#__codelineno-68-9"></a>make<span class="w"> </span>scrub_clean_all
<a id="__codelineno-68-10" name="__codelineno-68-10" href="#__codelineno-68-10"></a>make<span class="w"> </span>generate_from_tcl
<a id="__codelineno-68-11" name="__codelineno-68-11" href="#__codelineno-68-11"></a>make<span class="w"> </span>all
<a id="__codelineno-68-12" name="__codelineno-68-12" href="#__codelineno-68-12"></a><span class="nb">unset</span><span class="w"> </span>QUARTUS_DEVICE
<a id="__codelineno-68-13" name="__codelineno-68-13" href="#__codelineno-68-13"></a><span class="nb">unset</span><span class="w"> </span>DAUGHTER_CARD
<a id="__codelineno-68-14" name="__codelineno-68-14" href="#__codelineno-68-14"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<p>The following files are created in $TOP_FOLDER/s10_soc_devkit_ghrd/output_files:</p>
<ul>
<li>ghrd_1sx280hu2f50e1vgas.sof - FPGA SOF file, without HPS FSBL</li>
<li>ghrd_1sx280hu2f50e1vgas_hps_debug.sof - FPGA SOF, with HPS Debug FSBL</li>
</ul>
<h4 id="build-core-rbf_1">Build Core RBF<a class="headerlink" href="#build-core-rbf_1" title="Permanent link">&para;</a></h4>
<p>Create the Core RBF file to be used in the rootfs created by Yocto by using the HPS Debug SOF built by the GHRD makefile:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-69-2" name="__codelineno-69-2" href="#__codelineno-69-2"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>s10_soc_devkit_ghrd/output_files/ghrd_1sx280hu2f50e1vgas_hps_debug.sof<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-69-3" name="__codelineno-69-3" href="#__codelineno-69-3"></a><span class="w"> </span>ghrd_1sx280hu2f50e1vgas.jic<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-69-4" name="__codelineno-69-4" href="#__codelineno-69-4"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">device</span><span class="o">=</span>MT25QU02G<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-69-5" name="__codelineno-69-5" href="#__codelineno-69-5"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">flash_loader</span><span class="o">=</span>1SX280HU2<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-69-6" name="__codelineno-69-6" href="#__codelineno-69-6"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">mode</span><span class="o">=</span>ASX4<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-69-7" name="__codelineno-69-7" href="#__codelineno-69-7"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">hps</span><span class="o">=</span><span class="m">1</span>
<a id="__codelineno-69-8" name="__codelineno-69-8" href="#__codelineno-69-8"></a>rm<span class="w"> </span>ghrd_1sx280hu2f50e1vgas.hps.jic
</code></pre></div>
<p>The following files will be created:</p>
<ul>
<li><code>$TOP_FOLDER/ghrd_1sx280hu2f50e1vgas.core.rbf</code> - HPS First configuration bitstream, phase 2: FPGA fabric</li>
</ul>
<p>Note we are also creating an HPS JIC file, but we are discarding it, as it has the HPS Debug FSBL, while the final image needs to have the U-Boot SPL created by the Yocto recipes.</p>
<h4 id="set-up-yocto_1">Set Up Yocto<a class="headerlink" href="#set-up-yocto_1" title="Permanent link">&para;</a></h4>
<p>1. Make sure you have Yocto system requirements met: https://docs.yoctoproject.org/5.0.1/ref-manual/system-requirements.html#supported-linux-distributions.</p>
<p>The command to install the required packages on Ubuntu 22.04 is:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>update
<a id="__codelineno-70-2" name="__codelineno-70-2" href="#__codelineno-70-2"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>upgrade
<a id="__codelineno-70-3" name="__codelineno-70-3" href="#__codelineno-70-3"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>openssh-server<span class="w"> </span>mc<span class="w"> </span>libgmp3-dev<span class="w"> </span>libmpc-dev<span class="w"> </span>gawk<span class="w"> </span>wget<span class="w"> </span>git<span class="w"> </span>diffstat<span class="w"> </span>unzip<span class="w"> </span>texinfo<span class="w"> </span>gcc<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-70-4" name="__codelineno-70-4" href="#__codelineno-70-4"></a>build-essential<span class="w"> </span>chrpath<span class="w"> </span>socat<span class="w"> </span>cpio<span class="w"> </span>python3<span class="w"> </span>python3-pip<span class="w"> </span>python3-pexpect<span class="w"> </span>xz-utils<span class="w"> </span>debianutils<span class="w"> </span>iputils-ping<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-70-5" name="__codelineno-70-5" href="#__codelineno-70-5"></a>python3-git<span class="w"> </span>python3-jinja2<span class="w"> </span>libegl1-mesa<span class="w"> </span>libsdl1.2-dev<span class="w"> </span>pylint<span class="w"> </span>xterm<span class="w"> </span>python3-subunit<span class="w"> </span>mesa-common-dev<span class="w"> </span>zstd<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-70-6" name="__codelineno-70-6" href="#__codelineno-70-6"></a>liblz4-tool<span class="w"> </span>git<span class="w"> </span>fakeroot<span class="w"> </span>build-essential<span class="w"> </span>ncurses-dev<span class="w"> </span>xz-utils<span class="w"> </span>libssl-dev<span class="w"> </span>bc<span class="w"> </span>flex<span class="w"> </span>libelf-dev<span class="w"> </span>bison<span class="w"> </span>xinetd<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-70-7" name="__codelineno-70-7" href="#__codelineno-70-7"></a>tftpd<span class="w"> </span>tftp<span class="w"> </span>nfs-kernel-server<span class="w"> </span>libncurses5<span class="w"> </span>libc6-i386<span class="w"> </span>libstdc++6:i386<span class="w"> </span>libgcc++1:i386<span class="w"> </span>lib32z1<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-70-8" name="__codelineno-70-8" href="#__codelineno-70-8"></a>device-tree-compiler<span class="w"> </span>curl<span class="w"> </span>mtd-utils<span class="w"> </span>u-boot-tools<span class="w"> </span>net-tools<span class="w"> </span>swig<span class="w"> </span>-y
</code></pre></div>
<p>On Ubuntu 22.04 you will also need to point the /bin/sh to /bin/bash, as the default is a link to /bin/dash:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a><span class="w"> </span>sudo<span class="w"> </span>ln<span class="w"> </span>-sf<span class="w"> </span>/bin/bash<span class="w"> </span>/bin/sh
</code></pre></div>
<p><strong>Note</strong>: You can also use a Docker container to build the Yocto recipes, refer to https://rocketboards.org/foswiki/Documentation/DockerYoctoBuild for details. When using a Docker container, it does not matter what Linux distribution or packages you have installed on your host, as all dependencies are provided by the Docker container.</p>
<p>2. Clone the Yocto script and prepare the build:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-72-2" name="__codelineno-72-2" href="#__codelineno-72-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>gsrd_socfpga
<a id="__codelineno-72-3" name="__codelineno-72-3" href="#__codelineno-72-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS24.3_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-opensource/gsrd_socfpga
<a id="__codelineno-72-4" name="__codelineno-72-4" href="#__codelineno-72-4"></a><span class="nb">cd</span><span class="w"> </span>gsrd_socfpga
<a id="__codelineno-72-5" name="__codelineno-72-5" href="#__codelineno-72-5"></a>.<span class="w"> </span>stratix10_htile-gsrd-build.sh
<a id="__codelineno-72-6" name="__codelineno-72-6" href="#__codelineno-72-6"></a>build_setup
</code></pre></div>
<p><strong>Note</strong>: Run the following commands to set up again the yocto build environments, if you closed the current window (for example when rebooting the Linux host) and want to resume the next steps:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>/gsrd_socfpga
<a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a>.<span class="w"> </span>./poky/oe-init-build-env<span class="w"> </span>stratix10-gsrd-rootfs/
</code></pre></div>
<h4 id="customize-yocto_1">Customize Yocto<a class="headerlink" href="#customize-yocto_1" title="Permanent link">&para;</a></h4>
<p>1. Copy the rebuilt files to <code>$WORKSPACE/meta-intel-fpga-refdes/recipes-bsp/ghrd/files</code> using the following names, as expected by the yocto recipes:</p>
<ul>
<li>stratix10_htile_gsrd_ghrd.core.rbf: not applicable, as we have not rebuilt the standard GSRD version supporting SD card in this case</li>
<li>stratix10_htile_pr_persona0.rbf: not applicable, PR not enabled in this scenario</li>
<li>stratix10_htile_pr_persona1.rbf: not applicable, PR not enabled in this scenario</li>
<li>stratix10_htile_nand_ghrd.core.rbf</li>
</ul>
<p>This can be accomplished using the following instructions:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a><span class="nv">GHRD_LOC</span><span class="o">=</span><span class="nv">$WORKSPACE</span>/meta-intel-fpga-refdes/recipes-bsp/ghrd/files
<a id="__codelineno-74-2" name="__codelineno-74-2" href="#__codelineno-74-2"></a><span class="nv">CORE_RBF</span><span class="o">=</span><span class="nv">$GHRD_LOC</span>/stratix10_htile_nand_ghrd.core.rbf
<a id="__codelineno-74-3" name="__codelineno-74-3" href="#__codelineno-74-3"></a>cp<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/ghrd_1sx280hu2f50e1vgas.core.rbf<span class="w"> </span><span class="nv">$CORE_RBF</span>
</code></pre></div>
<p>2. Update the Yocto recipe at <code>$WORKSPACE/meta-intel-fpga-refdes/recipes-bsp/ghrd/hw-ref-design.bb</code> to change the <code>SRC_URI:stratix10</code> from the orginal value:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a>SRC_URI:stratix10<span class="w"> </span>?<span class="o">=</span><span class="w"> </span><span class="s2">&quot;\</span>
<a id="__codelineno-75-2" name="__codelineno-75-2" href="#__codelineno-75-2"></a><span class="s2"> </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_htile_gsrd_</span><span class="si">${</span><span class="nv">ARM64_GHRD_CORE_RBF</span><span class="si">}</span><span class="s2">;name=stratix10_htile_gsrd_core \</span>
<a id="__codelineno-75-3" name="__codelineno-75-3" href="#__codelineno-75-3"></a><span class="s2"> </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_htile_nand_</span><span class="si">${</span><span class="nv">ARM64_GHRD_CORE_RBF</span><span class="si">}</span><span class="s2">;name=stratix10_htile_nand_core \</span>
<a id="__codelineno-75-4" name="__codelineno-75-4" href="#__codelineno-75-4"></a><span class="s2"> </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_htile_pr_persona0.rbf;name=stratix10_htile_pr_persona0 \</span>
<a id="__codelineno-75-5" name="__codelineno-75-5" href="#__codelineno-75-5"></a><span class="s2"> </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_htile_pr_persona1.rbf;name=stratix10_htile_pr_persona1 \</span>
<a id="__codelineno-75-6" name="__codelineno-75-6" href="#__codelineno-75-6"></a><span class="s2"> &quot;</span>
</code></pre></div>
<p>to be:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a>SRC_URI:stratix10<span class="w"> </span>?<span class="o">=</span><span class="w"> </span><span class="s2">&quot;\</span>
<a id="__codelineno-76-2" name="__codelineno-76-2" href="#__codelineno-76-2"></a><span class="s2"> </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_htile_gsrd_</span><span class="si">${</span><span class="nv">ARM64_GHRD_CORE_RBF</span><span class="si">}</span><span class="s2">;name=stratix10_htile_gsrd_core \</span>
<a id="__codelineno-76-3" name="__codelineno-76-3" href="#__codelineno-76-3"></a><span class="s2"> file://stratix10_htile_nand_ghrd.core.rbf \</span>
<a id="__codelineno-76-4" name="__codelineno-76-4" href="#__codelineno-76-4"></a><span class="s2"> </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_htile_pr_persona0.rbf;name=stratix10_htile_pr_persona0 \</span>
<a id="__codelineno-76-5" name="__codelineno-76-5" href="#__codelineno-76-5"></a><span class="s2"> </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_htile_pr_persona1.rbf;name=stratix10_htile_pr_persona1 \</span>
<a id="__codelineno-76-6" name="__codelineno-76-6" href="#__codelineno-76-6"></a><span class="s2"> &quot;</span>
</code></pre></div>
<p>using the following commands from the console:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a><span class="nv">OLD_CORE_URI</span><span class="o">=</span><span class="s2">&quot;\${GHRD_REPO}\/stratix10_htile_nand_\${ARM64_GHRD_CORE_RBF};name=stratix10_htile_nand_core&quot;</span>
<a id="__codelineno-77-2" name="__codelineno-77-2" href="#__codelineno-77-2"></a><span class="nv">NEW_CORE_URI</span><span class="o">=</span><span class="s2">&quot;file:\/\/stratix10_htile_nand_ghrd.core.rbf&quot;</span>
<a id="__codelineno-77-3" name="__codelineno-77-3" href="#__codelineno-77-3"></a><span class="nv">RECIPE</span><span class="o">=</span><span class="nv">$WORKSPACE</span>/meta-intel-fpga-refdes/recipes-bsp/ghrd/hw-ref-design.bb
<a id="__codelineno-77-4" name="__codelineno-77-4" href="#__codelineno-77-4"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/</span><span class="nv">$OLD_CORE_URI</span><span class="s2">/</span><span class="nv">$NEW_CORE_URI</span><span class="s2">/g&quot;</span><span class="w"> </span><span class="nv">$RECIPE</span>
</code></pre></div>
<p>Note we have left the NAND file alone, that will be downloaded from rocketboards.</p>
<p>3. Update the same Yocto recipe to change the SHA checksums for the new files:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a>SRC_URI<span class="o">[</span>stratix10_htile_gsrd_core.sha256sum<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;ea26a77ebc1b3141193de6dd32e22f332785e05c956de85118c3790392141d3c&quot;</span>
<a id="__codelineno-78-2" name="__codelineno-78-2" href="#__codelineno-78-2"></a>SRC_URI<span class="o">[</span>stratix10_htile_nand_core.sha256sum<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;d782c05085f8f13cb792b687fd002773e0897e4d7ecf5451994b1823d62cdc92&quot;</span>
</code></pre></div>
<p>to the new values using the following commands:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a><span class="nv">CORE_SHA</span><span class="o">=</span><span class="k">$(</span>sha256sum<span class="w"> </span><span class="nv">$CORE_RBF</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-f1<span class="w"> </span>-d<span class="s2">&quot; &quot;</span><span class="k">)</span>
<a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a><span class="nv">OLD_CORE_SHA</span><span class="o">=</span><span class="s2">&quot;SRC_URI\[stratix10_htile_nand_core\.sha256sum\] = .*&quot;</span>
<a id="__codelineno-79-3" name="__codelineno-79-3" href="#__codelineno-79-3"></a><span class="nv">NEW_CORE_SHA</span><span class="o">=</span><span class="s2">&quot;SRC_URI[stratix10_htile_nand_core.sha256sum] = \&quot;</span><span class="nv">$CORE_SHA</span><span class="s2">\&quot;&quot;</span>
<a id="__codelineno-79-4" name="__codelineno-79-4" href="#__codelineno-79-4"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/</span><span class="nv">$OLD_CORE_SHA</span><span class="s2">/</span><span class="nv">$NEW_CORE_SHA</span><span class="s2">/g&quot;</span><span class="w"> </span><span class="nv">$RECIPE</span>
</code></pre></div>
<p>4. Optionally change the following files in <code>$WORKSPACE/meta-intel-fpga-refdes/recipes-bsp/u-boot/files/</code>:</p>
<ul>
<li><a href="https://github.com/altera-opensource/meta-intel-fpga-refdes/blob/master/recipes-bsp/u-boot/files/uboot.txt">uboot.txt</a> - distroboot script</li>
<li><a href="https://github.com/altera-opensource/meta-intel-fpga-refdes/blob/master/recipes-bsp/u-boot/files/uboot_script.its">uboot_script.its</a> - its file for creating FIT image from the above script</li>
</ul>
<p>5. Optionally change the following file in <code>$WORKSPACE/meta-intel-fpga-refdes/recipes-kernel/linux/linux-socfpga-lts</code>:</p>
<ul>
<li>
<p>fit_kernel_stratix10.its - its file for creating the kernel.itb image, containing by default:</p>
<ul>
<li>Kernel</li>
<li>Device trees for SD and NAND board configurations</li>
<li>Core RBF files for SD and NAND board configurations</li>
<li>Board configurations for SD and NAND cases</li>
</ul>
</li>
</ul>
<h4 id="build-yocto_1">Build Yocto<a class="headerlink" href="#build-yocto_1" title="Permanent link">&para;</a></h4>
<p>Build Yocto:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a>bitbake_image
</code></pre></div>
<p>Gather files:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a>package
</code></pre></div>
<p>Once the build is completed successfully, you will see the following two folders are created:</p>
<ul>
<li><code>stratix10_htile_gsrd_rootfs</code>: area used by OpenEmbedded build system for builds. Description of build directory structure - https://docs.yoctoproject.org/ref-manual/structure.html#the-build-directory-build</li>
<li><code>stratix10_htile_gsrd_images</code>: the build script copies here relevant files built by Yocto from the <code>stratix10_htile_gsrd_rootfs/tmp/deploy/images/agilex</code> folder, but also other relevant files.</li>
</ul>
<p>The two most relevant files created in the <code>$TOP_FOLDER/gsrd_socfpga/stratix10_htile-gsrd-images</code> folder are:</p>
<table>
<thead>
<tr>
<th align="left">File</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">gsrd-console-image-stratix10_htile_nand.ubifs</td>
<td align="left">UBI root partition image</td>
</tr>
<tr>
<td align="left">u-boot-stratix10-socdk-gsrd-atf/u-boot.itb</td>
<td align="left">U-Boot FIT image</td>
</tr>
<tr>
<td align="left">u-boot-stratix10-socdk-gsrd-atf/u-boot-spl-dtb.hex</td>
<td align="left">U-Boot SPL Hex file</td>
</tr>
</tbody>
</table>
<h4 id="create-qspi-image_2">Create QSPI Image<a class="headerlink" href="#create-qspi-image_2" title="Permanent link">&para;</a></h4>
<p>The QSPI image will contain the FPGA configuration data and the HPS FSBL and it can be built using the following command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-82-2" name="__codelineno-82-2" href="#__codelineno-82-2"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>s10_soc_devkit_ghrd/output_files/ghrd_1sx280hu2f50e1vgas.sof<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-82-3" name="__codelineno-82-3" href="#__codelineno-82-3"></a><span class="w"> </span>ghrd_1sx280hu2f50e1vgas.jic<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-82-4" name="__codelineno-82-4" href="#__codelineno-82-4"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">device</span><span class="o">=</span>MT25QU02G<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-82-5" name="__codelineno-82-5" href="#__codelineno-82-5"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">flash_loader</span><span class="o">=</span>1SX280HU2<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-82-6" name="__codelineno-82-6" href="#__codelineno-82-6"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">hps_path</span><span class="o">=</span>gsrd_socfpga/stratix10_htile-gsrd-images/u-boot-stratix10-socdk-gsrd-atf/u-boot-spl-dtb.hex<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-82-7" name="__codelineno-82-7" href="#__codelineno-82-7"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">mode</span><span class="o">=</span>ASX4<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-82-8" name="__codelineno-82-8" href="#__codelineno-82-8"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">hps</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
<p>The following files will be created:</p>
<ul>
<li>$TOP_FOLDER/ghrd_1sx280hu2f50e1vgas.hps.jic - Flash image for HPS First configuration bitstream, phase 1: HPS and DDR</li>
<li>$TOP_FOLDER/ghrd_1sx280hu2f50e1vgas.core.rbf - HPS First configuration bitstream, phase 2: FPGA fabric. We already have the same file on the SD card.</li>
</ul>
<h4 id="build-nand-binaries">Build NAND Binaries<a class="headerlink" href="#build-nand-binaries" title="Permanent link">&para;</a></h4>
<p>1. Gather the files into a single folder, using symlinks:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-83-2" name="__codelineno-83-2" href="#__codelineno-83-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>nand-bin<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>nand-bin<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>nand-bin
<a id="__codelineno-83-3" name="__codelineno-83-3" href="#__codelineno-83-3"></a>ln<span class="w"> </span>-s<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/gsrd_socfpga/stratix10_htile-gsrd-images/u-boot-stratix10-socdk-gsrd-atf/boot.scr.uimg<span class="w"> </span>.
<a id="__codelineno-83-4" name="__codelineno-83-4" href="#__codelineno-83-4"></a>ln<span class="w"> </span>-s<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/gsrd_socfpga/stratix10_htile-gsrd-images/kernel.itb<span class="w"> </span>.
<a id="__codelineno-83-5" name="__codelineno-83-5" href="#__codelineno-83-5"></a>ln<span class="w"> </span>-s<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/gsrd_socfpga/stratix10_htile-gsrd-images/gsrd-console-image-stratix10_nand.ubifs<span class="w"> </span>rootfs.ubifs
<a id="__codelineno-83-6" name="__codelineno-83-6" href="#__codelineno-83-6"></a>ln<span class="w"> </span>-s<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/gsrd_socfpga/stratix10_htile-gsrd-images/socfpga_stratix10_socdk_nand.dtb<span class="w"> </span>.
</code></pre></div>
<p>2. Install <code>mtd-tools</code> if not already installed. On Ubuntu the command is:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>mtd-tools
</code></pre></div>
<p>3. Create UBI configuration file for the root partition;</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a>cat<span class="w"> </span><span class="s">&lt;&lt;EOT &gt;ubinize.cfg</span>
<a id="__codelineno-85-2" name="__codelineno-85-2" href="#__codelineno-85-2"></a><span class="s">[env]</span>
<a id="__codelineno-85-3" name="__codelineno-85-3" href="#__codelineno-85-3"></a><span class="s">mode=ubi</span>
<a id="__codelineno-85-4" name="__codelineno-85-4" href="#__codelineno-85-4"></a><span class="s">vol_id=0</span>
<a id="__codelineno-85-5" name="__codelineno-85-5" href="#__codelineno-85-5"></a><span class="s">vol_name=env</span>
<a id="__codelineno-85-6" name="__codelineno-85-6" href="#__codelineno-85-6"></a><span class="s">vol_size=256KiB</span>
<a id="__codelineno-85-7" name="__codelineno-85-7" href="#__codelineno-85-7"></a><span class="s">vol_type=dynamic</span>
<a id="__codelineno-85-8" name="__codelineno-85-8" href="#__codelineno-85-8"></a>
<a id="__codelineno-85-9" name="__codelineno-85-9" href="#__codelineno-85-9"></a><span class="s">[script]</span>
<a id="__codelineno-85-10" name="__codelineno-85-10" href="#__codelineno-85-10"></a><span class="s">mode=ubi</span>
<a id="__codelineno-85-11" name="__codelineno-85-11" href="#__codelineno-85-11"></a><span class="s">image=boot.scr.uimg</span>
<a id="__codelineno-85-12" name="__codelineno-85-12" href="#__codelineno-85-12"></a><span class="s">vol_id=1</span>
<a id="__codelineno-85-13" name="__codelineno-85-13" href="#__codelineno-85-13"></a><span class="s">vol_name=script</span>
<a id="__codelineno-85-14" name="__codelineno-85-14" href="#__codelineno-85-14"></a><span class="s">vol_size=128KiB</span>
<a id="__codelineno-85-15" name="__codelineno-85-15" href="#__codelineno-85-15"></a><span class="s">vol_type=dynamic</span>
<a id="__codelineno-85-16" name="__codelineno-85-16" href="#__codelineno-85-16"></a>
<a id="__codelineno-85-17" name="__codelineno-85-17" href="#__codelineno-85-17"></a><span class="s">[kernel]</span>
<a id="__codelineno-85-18" name="__codelineno-85-18" href="#__codelineno-85-18"></a><span class="s">mode=ubi</span>
<a id="__codelineno-85-19" name="__codelineno-85-19" href="#__codelineno-85-19"></a><span class="s">image=kernel.itb</span>
<a id="__codelineno-85-20" name="__codelineno-85-20" href="#__codelineno-85-20"></a><span class="s">vol_id=2</span>
<a id="__codelineno-85-21" name="__codelineno-85-21" href="#__codelineno-85-21"></a><span class="s">vol_name=kernel</span>
<a id="__codelineno-85-22" name="__codelineno-85-22" href="#__codelineno-85-22"></a><span class="s">vol_size=64MiB</span>
<a id="__codelineno-85-23" name="__codelineno-85-23" href="#__codelineno-85-23"></a><span class="s">vol_type=dynamic</span>
<a id="__codelineno-85-24" name="__codelineno-85-24" href="#__codelineno-85-24"></a>
<a id="__codelineno-85-25" name="__codelineno-85-25" href="#__codelineno-85-25"></a><span class="s">[dtb]</span>
<a id="__codelineno-85-26" name="__codelineno-85-26" href="#__codelineno-85-26"></a><span class="s">mode=ubi</span>
<a id="__codelineno-85-27" name="__codelineno-85-27" href="#__codelineno-85-27"></a><span class="s">image=socfpga_stratix10_socdk_nand.dtb</span>
<a id="__codelineno-85-28" name="__codelineno-85-28" href="#__codelineno-85-28"></a><span class="s">vol_id=3</span>
<a id="__codelineno-85-29" name="__codelineno-85-29" href="#__codelineno-85-29"></a><span class="s">vol_name=dtb</span>
<a id="__codelineno-85-30" name="__codelineno-85-30" href="#__codelineno-85-30"></a><span class="s">vol_size=256KiB</span>
<a id="__codelineno-85-31" name="__codelineno-85-31" href="#__codelineno-85-31"></a><span class="s">vol_type=dynamic</span>
<a id="__codelineno-85-32" name="__codelineno-85-32" href="#__codelineno-85-32"></a>
<a id="__codelineno-85-33" name="__codelineno-85-33" href="#__codelineno-85-33"></a><span class="s">[rootfs]</span>
<a id="__codelineno-85-34" name="__codelineno-85-34" href="#__codelineno-85-34"></a><span class="s">mode=ubi</span>
<a id="__codelineno-85-35" name="__codelineno-85-35" href="#__codelineno-85-35"></a><span class="s">image=rootfs.ubifs</span>
<a id="__codelineno-85-36" name="__codelineno-85-36" href="#__codelineno-85-36"></a><span class="s">vol_id=4</span>
<a id="__codelineno-85-37" name="__codelineno-85-37" href="#__codelineno-85-37"></a><span class="s">vol_name=rootfs</span>
<a id="__codelineno-85-38" name="__codelineno-85-38" href="#__codelineno-85-38"></a><span class="s">vol_type=dynamic</span>
<a id="__codelineno-85-39" name="__codelineno-85-39" href="#__codelineno-85-39"></a><span class="s">vol_size=400MiB</span>
<a id="__codelineno-85-40" name="__codelineno-85-40" href="#__codelineno-85-40"></a><span class="s">vol_flag=autoresizeENDCOLOR%</span>
<a id="__codelineno-85-41" name="__codelineno-85-41" href="#__codelineno-85-41"></a><span class="s">EOT</span>
</code></pre></div>
<p>4. Create the <code>root.ubi</code> file:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-86-1" name="__codelineno-86-1" href="#__codelineno-86-1"></a>ubinize<span class="w"> </span>-o<span class="w"> </span>root.ubi<span class="w"> </span>-p<span class="w"> </span>128KiB<span class="w"> </span>-m<span class="w"> </span><span class="m">2048</span><span class="w"> </span>-s<span class="w"> </span><span class="m">2048</span><span class="w"> </span>ubinize.cfg
</code></pre></div>
<p>This is what the above parameters mean:</p>
<ul>
<li>-p: physical eraseblock size of the flash</li>
<li>-m: minimum input/output unit size of the flash</li>
<li>-s: sub-pages and sub-page size, ubinize will take into account and put the VID header to same NAND page as the EC header</li>
</ul>
<p>The following file is created:</p>
<ul>
<li>$TOP_FOLDER/nand-bin/root.ubi</li>
</ul>
<h3 id="partial-reconfiguration_1">Partial Reconfiguration<a class="headerlink" href="#partial-reconfiguration_1" title="Permanent link">&para;</a></h3>
<p><strong>Important Note</strong>: The instructions from this section build the latest version of the GSRD. See <a href="https://www.rocketboards.org/foswiki/Documentation/Stratix10SoCGSRD#Latest_Source_Code_Release_Contents_45_Branches_and_Commit_IDs">Latest Source Release Contents</a> for a list of used component versions.</p>
<h4 id="build-flow_1">Build Flow<a class="headerlink" href="#build-flow_1" title="Permanent link">&para;</a></h4>
<p>The following diagram illustrates the full build flow for the GSRD based on source code from GitHub.</p>
<p><a class="glightbox" href="../images/s10-gsrd-build-flow.svg" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/s10-gsrd-build-flow.svg" /></a></p>
<p>The current build flow creates a single boot image which is able to boot in different board configurations (either using OOBE or eMMC/NAND daughter card). For more information about how this single boot image is created, please refer to the following article: https://rocketboards.org/foswiki/Documentation/SingleImageBoot</p>
<h4 id="set-up-environment_2">Set up Environment<a class="headerlink" href="#set-up-environment_2" title="Permanent link">&para;</a></h4>
<p>Create a top folder for this example, as the rest of the commands assume this location:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-87-1" name="__codelineno-87-1" href="#__codelineno-87-1"></a>sudo<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>stratix10_gsrd.pr
<a id="__codelineno-87-2" name="__codelineno-87-2" href="#__codelineno-87-2"></a>mkdir<span class="w"> </span>stratix10_gsrd.pr
<a id="__codelineno-87-3" name="__codelineno-87-3" href="#__codelineno-87-3"></a><span class="nb">cd</span><span class="w"> </span>stratix10_gsrd.pr
<a id="__codelineno-87-4" name="__codelineno-87-4" href="#__codelineno-87-4"></a><span class="nb">export</span><span class="w"> </span><span class="nv">TOP_FOLDER</span><span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>
</code></pre></div>
<p>Download the compiler toolchain, add it to the PATH variable, to be used by the GHRD makefile to build the HPS Debug FSBL:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-88-1" name="__codelineno-88-1" href="#__codelineno-88-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-88-2" name="__codelineno-88-2" href="#__codelineno-88-2"></a>wget<span class="w"> </span>https://developer.arm.com/-/media/Files/downloads/gnu/11.2-2022.02/binrel/<span class="se">\</span>
<a id="__codelineno-88-3" name="__codelineno-88-3" href="#__codelineno-88-3"></a>gcc-arm-11.2-2022.02-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-88-4" name="__codelineno-88-4" href="#__codelineno-88-4"></a>tar<span class="w"> </span>xf<span class="w"> </span>gcc-arm-11.2-2022.02-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-88-5" name="__codelineno-88-5" href="#__codelineno-88-5"></a>rm<span class="w"> </span>-f<span class="w"> </span>gcc-arm-11.2-2022.02-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-88-6" name="__codelineno-88-6" href="#__codelineno-88-6"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>/gcc-arm-11.2-2022.02-x86_64-aarch64-none-linux-gnu/bin:<span class="nv">$PATH</span>
<a id="__codelineno-88-7" name="__codelineno-88-7" href="#__codelineno-88-7"></a><span class="nb">export</span><span class="w"> </span><span class="nv">ARCH</span><span class="o">=</span>arm64
<a id="__codelineno-88-8" name="__codelineno-88-8" href="#__codelineno-88-8"></a><span class="nb">export</span><span class="w"> </span><span class="nv">CROSS_COMPILE</span><span class="o">=</span>aarch64-none-linux-gnu-
</code></pre></div>
<p>Enable Quartus tools to be called from command line:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-89-1" name="__codelineno-89-1" href="#__codelineno-89-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_ROOTDIR</span><span class="o">=</span>~/intelFPGA_pro/24.3/quartus/
<a id="__codelineno-89-2" name="__codelineno-89-2" href="#__codelineno-89-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>/bin:<span class="nv">$QUARTUS_ROOTDIR</span>/linux64:<span class="nv">$QUARTUS_ROOTDIR</span>/../qsys/bin:<span class="nv">$PATH</span>
</code></pre></div>
<h4 id="build-hardware-design_2">Build Hardware Design<a class="headerlink" href="#build-hardware-design_2" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-90-1" name="__codelineno-90-1" href="#__codelineno-90-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-90-2" name="__codelineno-90-2" href="#__codelineno-90-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>ghrd-socfpga<span class="w"> </span>s10_soc_devkit_ghrd
<a id="__codelineno-90-3" name="__codelineno-90-3" href="#__codelineno-90-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS24.3_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-opensource/ghrd-socfpga
<a id="__codelineno-90-4" name="__codelineno-90-4" href="#__codelineno-90-4"></a>mv<span class="w"> </span>ghrd-socfpga/s10_soc_devkit_ghrd<span class="w"> </span>.
<a id="__codelineno-90-5" name="__codelineno-90-5" href="#__codelineno-90-5"></a>rm<span class="w"> </span>-rf<span class="w"> </span>ghrd-socfpga
<a id="__codelineno-90-6" name="__codelineno-90-6" href="#__codelineno-90-6"></a><span class="nb">cd</span><span class="w"> </span>s10_soc_devkit_ghrd
<a id="__codelineno-90-7" name="__codelineno-90-7" href="#__codelineno-90-7"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_DEVICE</span><span class="o">=</span>1SX280HU2F50E1VGAS
<a id="__codelineno-90-8" name="__codelineno-90-8" href="#__codelineno-90-8"></a><span class="nb">export</span><span class="w"> </span><span class="nv">ENABLE_PARTIAL_RECONFIGURATION</span><span class="o">=</span><span class="m">1</span>
<a id="__codelineno-90-9" name="__codelineno-90-9" href="#__codelineno-90-9"></a><span class="nb">export</span><span class="w"> </span><span class="nv">HPS_ENABLE_SGMII</span><span class="o">=</span><span class="m">0</span>
<a id="__codelineno-90-10" name="__codelineno-90-10" href="#__codelineno-90-10"></a>make<span class="w"> </span>scrub_clean_all
<a id="__codelineno-90-11" name="__codelineno-90-11" href="#__codelineno-90-11"></a>make<span class="w"> </span>generate_from_tcl
<a id="__codelineno-90-12" name="__codelineno-90-12" href="#__codelineno-90-12"></a>make<span class="w"> </span>all
<a id="__codelineno-90-13" name="__codelineno-90-13" href="#__codelineno-90-13"></a><span class="nb">unset</span><span class="w"> </span>QUARTUS_DEVICE
<a id="__codelineno-90-14" name="__codelineno-90-14" href="#__codelineno-90-14"></a><span class="nb">unset</span><span class="w"> </span>ENABLE_PARTIAL_RECONFIGURATION
<a id="__codelineno-90-15" name="__codelineno-90-15" href="#__codelineno-90-15"></a><span class="nb">unset</span><span class="w"> </span>HPS_ENABLE_SGMII
<a id="__codelineno-90-16" name="__codelineno-90-16" href="#__codelineno-90-16"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<p>The following files are created in $TOP_FOLDER/s10_soc_devkit_ghrd/output_files:</p>
<ul>
<li>ghrd_1sx280hu2f50e1vgas.sof - FPGA SOF file, without HPS FSBL</li>
<li>ghrd_1sx280hu2f50e1vgas_hps_debug.sof - FPGA SOF, with HPS Debug FSBL</li>
<li>ghrd_1sx280hu2f50e1vgas.pr_partition_0.rbf - PR bitsream for the baseline persona</li>
<li>alternate_persona.pr_partition_0.rbf - PR bitstream for the alternate persona</li>
</ul>
<h4 id="build-core-rbf_2">Build Core RBF<a class="headerlink" href="#build-core-rbf_2" title="Permanent link">&para;</a></h4>
<p>Create the Core RBF file to be used in the rootfs created by Yocto by using the HPS Debug SOF built by the GHRD makefile:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-91-1" name="__codelineno-91-1" href="#__codelineno-91-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-91-2" name="__codelineno-91-2" href="#__codelineno-91-2"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>s10_soc_devkit_ghrd/output_files/ghrd_1sx280hu2f50e1vgas_hps_debug.sof<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-91-3" name="__codelineno-91-3" href="#__codelineno-91-3"></a><span class="w"> </span>ghrd_1sx280hu2f50e1vgas.jic<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-91-4" name="__codelineno-91-4" href="#__codelineno-91-4"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">device</span><span class="o">=</span>MT25QU02G<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-91-5" name="__codelineno-91-5" href="#__codelineno-91-5"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">flash_loader</span><span class="o">=</span>1SX280HU2<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-91-6" name="__codelineno-91-6" href="#__codelineno-91-6"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">mode</span><span class="o">=</span>ASX4<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-91-7" name="__codelineno-91-7" href="#__codelineno-91-7"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">hps</span><span class="o">=</span><span class="m">1</span>
<a id="__codelineno-91-8" name="__codelineno-91-8" href="#__codelineno-91-8"></a>rm<span class="w"> </span>ghrd_1sx280hu2f50e1vgas.hps.jic
</code></pre></div>
<p>The following files will be created:</p>
<ul>
<li>$TOP_FOLDER/ghrd_1sx280hu2f50e1vgas.core.rbf - HPS First configuration bitstream, phase 2: FPGA fabric</li>
</ul>
<p>Note we are also creating an HPS JIC file, but we are discarding it, as it has the HPS Debug FSBL, while the final image needs to have the U-Boot SPL created by the Yocto recipes.</p>
<h4 id="set-up-yocto_2">Set Up Yocto<a class="headerlink" href="#set-up-yocto_2" title="Permanent link">&para;</a></h4>
<p>1. Make sure you have Yocto system requirements met: https://docs.yoctoproject.org/5.0.1/ref-manual/system-requirements.html#supported-linux-distributions.</p>
<p>The command to install the required packages on Ubuntu 22.04 is:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-92-1" name="__codelineno-92-1" href="#__codelineno-92-1"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>update
<a id="__codelineno-92-2" name="__codelineno-92-2" href="#__codelineno-92-2"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>upgrade
<a id="__codelineno-92-3" name="__codelineno-92-3" href="#__codelineno-92-3"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>openssh-server<span class="w"> </span>mc<span class="w"> </span>libgmp3-dev<span class="w"> </span>libmpc-dev<span class="w"> </span>gawk<span class="w"> </span>wget<span class="w"> </span>git<span class="w"> </span>diffstat<span class="w"> </span>unzip<span class="w"> </span>texinfo<span class="w"> </span>gcc<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-92-4" name="__codelineno-92-4" href="#__codelineno-92-4"></a>build-essential<span class="w"> </span>chrpath<span class="w"> </span>socat<span class="w"> </span>cpio<span class="w"> </span>python3<span class="w"> </span>python3-pip<span class="w"> </span>python3-pexpect<span class="w"> </span>xz-utils<span class="w"> </span>debianutils<span class="w"> </span>iputils-ping<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-92-5" name="__codelineno-92-5" href="#__codelineno-92-5"></a>python3-git<span class="w"> </span>python3-jinja2<span class="w"> </span>libegl1-mesa<span class="w"> </span>libsdl1.2-dev<span class="w"> </span>pylint<span class="w"> </span>xterm<span class="w"> </span>python3-subunit<span class="w"> </span>mesa-common-dev<span class="w"> </span>zstd<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-92-6" name="__codelineno-92-6" href="#__codelineno-92-6"></a>liblz4-tool<span class="w"> </span>git<span class="w"> </span>fakeroot<span class="w"> </span>build-essential<span class="w"> </span>ncurses-dev<span class="w"> </span>xz-utils<span class="w"> </span>libssl-dev<span class="w"> </span>bc<span class="w"> </span>flex<span class="w"> </span>libelf-dev<span class="w"> </span>bison<span class="w"> </span>xinetd<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-92-7" name="__codelineno-92-7" href="#__codelineno-92-7"></a>tftpd<span class="w"> </span>tftp<span class="w"> </span>nfs-kernel-server<span class="w"> </span>libncurses5<span class="w"> </span>libc6-i386<span class="w"> </span>libstdc++6:i386<span class="w"> </span>libgcc++1:i386<span class="w"> </span>lib32z1<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-92-8" name="__codelineno-92-8" href="#__codelineno-92-8"></a>device-tree-compiler<span class="w"> </span>curl<span class="w"> </span>mtd-utils<span class="w"> </span>u-boot-tools<span class="w"> </span>net-tools<span class="w"> </span>swig<span class="w"> </span>-y
</code></pre></div>
<p>On Ubuntu 22.04 you will also need to point the /bin/sh to /bin/bash, as the default is a link to /bin/dash:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-93-1" name="__codelineno-93-1" href="#__codelineno-93-1"></a><span class="w"> </span>sudo<span class="w"> </span>ln<span class="w"> </span>-sf<span class="w"> </span>/bin/bash<span class="w"> </span>/bin/sh
</code></pre></div>
<p><strong>Note</strong>: You can also use a Docker container to build the Yocto recipes, refer to https://rocketboards.org/foswiki/Documentation/DockerYoctoBuild for details. When using a Docker container, it does not matter what Linux distribution or packages you have installed on your host, as all dependencies are provided by the Docker container.</p>
<p>2. Clone the Yocto script and prepare the build:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-94-1" name="__codelineno-94-1" href="#__codelineno-94-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-94-2" name="__codelineno-94-2" href="#__codelineno-94-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>gsrd_socfpga
<a id="__codelineno-94-3" name="__codelineno-94-3" href="#__codelineno-94-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS24.3_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-opensource/gsrd_socfpga
<a id="__codelineno-94-4" name="__codelineno-94-4" href="#__codelineno-94-4"></a><span class="nb">cd</span><span class="w"> </span>gsrd_socfpga
<a id="__codelineno-94-5" name="__codelineno-94-5" href="#__codelineno-94-5"></a>.<span class="w"> </span>stratix10_htile-gsrd-build.sh
<a id="__codelineno-94-6" name="__codelineno-94-6" href="#__codelineno-94-6"></a>build_setup
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-95-1" name="__codelineno-95-1" href="#__codelineno-95-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>/gsrd_socfpga
<a id="__codelineno-95-2" name="__codelineno-95-2" href="#__codelineno-95-2"></a>.<span class="w"> </span>./poky/oe-init-build-env<span class="w"> </span>stratix10-gsrd-rootfs/
</code></pre></div>
<h4 id="customize-yocto_2">Customize Yocto<a class="headerlink" href="#customize-yocto_2" title="Permanent link">&para;</a></h4>
<p>1. Copy the rebuilt files to <code>$WORKSPACE/meta-intel-fpga-refdes/recipes-bsp/ghrd/files</code> using the following names, as expected by the yocto recipes:</p>
<ul>
<li>stratix10_htile_gsrd_ghrd.core.rbf</li>
<li>stratix10_htile_pr_persona0.rbf</li>
<li>stratix10_htile_pr_persona1.rbf</li>
<li>stratix10_htile_nand_ghrd.core.rbf: not applicable, as we have not rebuilt the NAND version</li>
</ul>
<p>This can be accomplished using the following instructions:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-96-1" name="__codelineno-96-1" href="#__codelineno-96-1"></a><span class="nv">GHRD_LOC</span><span class="o">=</span><span class="nv">$WORKSPACE</span>/meta-intel-fpga-refdes/recipes-bsp/ghrd/files
<a id="__codelineno-96-2" name="__codelineno-96-2" href="#__codelineno-96-2"></a><span class="nv">CORE_RBF</span><span class="o">=</span><span class="nv">$GHRD_LOC</span>/stratix10_htile_pr_ghrd.core.rbf
<a id="__codelineno-96-3" name="__codelineno-96-3" href="#__codelineno-96-3"></a><span class="nv">PER0_RBF</span><span class="o">=</span><span class="nv">$GHRD_LOC</span>/stratix10_htile_pr_persona0.rbf
<a id="__codelineno-96-4" name="__codelineno-96-4" href="#__codelineno-96-4"></a><span class="nv">PER1_RBF</span><span class="o">=</span><span class="nv">$GHRD_LOC</span>/stratix10_htile_pr_persona1.rbf
<a id="__codelineno-96-5" name="__codelineno-96-5" href="#__codelineno-96-5"></a>cp<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/ghrd_1sx280hu2f50e1vgas.core.rbf<span class="w"> </span><span class="nv">$CORE_RBF</span>
<a id="__codelineno-96-6" name="__codelineno-96-6" href="#__codelineno-96-6"></a>cp<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/s10_soc_devkit_ghrd/output_files/ghrd_1sx280hu2f50e1vgas.pr_partition_0.rbf<span class="w"> </span><span class="nv">$PER0_RBF</span>
<a id="__codelineno-96-7" name="__codelineno-96-7" href="#__codelineno-96-7"></a>cp<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/s10_soc_devkit_ghrd/output_files/alternate_persona.pr_partition_0.rbf<span class="w"> </span><span class="nv">$PER1_RBF</span>
</code></pre></div>
<p>2. Update the Yocto recipe at <code>$WORKSPACE/meta-intel-fpga-refdes/recipes-bsp/ghrd/hw-ref-design.bb</code> to change the <code>SRC_URI:stratix10</code> from the orginal value:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-97-1" name="__codelineno-97-1" href="#__codelineno-97-1"></a>SRC_URI:stratix10_htile<span class="w"> </span>?<span class="o">=</span><span class="w"> </span><span class="s2">&quot;\</span>
<a id="__codelineno-97-2" name="__codelineno-97-2" href="#__codelineno-97-2"></a><span class="s2">    </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_htile_gsrd_</span><span class="si">${</span><span class="nv">ARM64_GHRD_CORE_RBF</span><span class="si">}</span><span class="s2">;name=stratix10_htile_gsrd_core \</span>
<a id="__codelineno-97-3" name="__codelineno-97-3" href="#__codelineno-97-3"></a><span class="s2">    </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_htile_nand_</span><span class="si">${</span><span class="nv">ARM64_GHRD_CORE_RBF</span><span class="si">}</span><span class="s2">;name=stratix10_htile_nand_core \</span>
<a id="__codelineno-97-4" name="__codelineno-97-4" href="#__codelineno-97-4"></a><span class="s2">    </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_htile_pr_</span><span class="si">${</span><span class="nv">ARM64_GHRD_CORE_RBF</span><span class="si">}</span><span class="s2">;name=stratix10_htile_pr_core \</span>
<a id="__codelineno-97-5" name="__codelineno-97-5" href="#__codelineno-97-5"></a><span class="s2">    </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_htile_pr_persona0.rbf;name=stratix10_htile_pr_persona0 \</span>
<a id="__codelineno-97-6" name="__codelineno-97-6" href="#__codelineno-97-6"></a><span class="s2">    </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_htile_pr_persona1.rbf;name=stratix10_htile_pr_persona1 \</span>
<a id="__codelineno-97-7" name="__codelineno-97-7" href="#__codelineno-97-7"></a><span class="s2">    &quot;</span>
</code></pre></div>
<p>to be:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-98-1" name="__codelineno-98-1" href="#__codelineno-98-1"></a>SRC_URI:stratix10_htile<span class="w"> </span>?<span class="o">=</span><span class="w"> </span><span class="s2">&quot;\</span>
<a id="__codelineno-98-2" name="__codelineno-98-2" href="#__codelineno-98-2"></a><span class="s2">    </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_htile_gsrd_</span><span class="si">${</span><span class="nv">ARM64_GHRD_CORE_RBF</span><span class="si">}</span><span class="s2">;name=stratix10_htile_gsrd_core \</span>
<a id="__codelineno-98-3" name="__codelineno-98-3" href="#__codelineno-98-3"></a><span class="s2">    </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_htile_nand_</span><span class="si">${</span><span class="nv">ARM64_GHRD_CORE_RBF</span><span class="si">}</span><span class="s2">;name=stratix10_htile_nand_core \</span>
<a id="__codelineno-98-4" name="__codelineno-98-4" href="#__codelineno-98-4"></a><span class="s2">    file://stratix10_htile_pr_ghrd.core.rbf \    </span>
<a id="__codelineno-98-5" name="__codelineno-98-5" href="#__codelineno-98-5"></a><span class="s2">    file://stratix10_htile_pr_persona0.rbf \</span>
<a id="__codelineno-98-6" name="__codelineno-98-6" href="#__codelineno-98-6"></a><span class="s2">    file://stratix10_htile_pr_persona1.rbf \</span>
<a id="__codelineno-98-7" name="__codelineno-98-7" href="#__codelineno-98-7"></a><span class="s2"> &quot;</span>
</code></pre></div>
<p>using the following commands from the console:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-99-1" name="__codelineno-99-1" href="#__codelineno-99-1"></a><span class="nv">OLD_CORE_URI</span><span class="o">=</span><span class="s2">&quot;\${GHRD_REPO}\/stratix10_htile_pr_\${ARM64_GHRD_CORE_RBF};name=stratix10_htile_pr_core&quot;</span>
<a id="__codelineno-99-2" name="__codelineno-99-2" href="#__codelineno-99-2"></a><span class="nv">NEW_CORE_URI</span><span class="o">=</span><span class="s2">&quot;file:\/\/stratix10_htile_pr_ghrd.core.rbf&quot;</span>
<a id="__codelineno-99-3" name="__codelineno-99-3" href="#__codelineno-99-3"></a><span class="nv">OLD_PER0_URI</span><span class="o">=</span><span class="s2">&quot;\${GHRD_REPO}\/stratix10_htile_pr_persona0.rbf;name=stratix10_htile_pr_persona0&quot;</span>
<a id="__codelineno-99-4" name="__codelineno-99-4" href="#__codelineno-99-4"></a><span class="nv">NEW_PER0_URI</span><span class="o">=</span><span class="s2">&quot;file:\/\/stratix10_htile_pr_persona0.rbf&quot;</span>
<a id="__codelineno-99-5" name="__codelineno-99-5" href="#__codelineno-99-5"></a><span class="nv">OLD_PER1_URI</span><span class="o">=</span><span class="s2">&quot;\${GHRD_REPO}\/stratix10_htile_pr_persona1.rbf;name=stratix10_htile_pr_persona1&quot;</span>
<a id="__codelineno-99-6" name="__codelineno-99-6" href="#__codelineno-99-6"></a><span class="nv">NEW_PER1_URI</span><span class="o">=</span><span class="s2">&quot;file:\/\/stratix10_htile_pr_persona1.rbf&quot;</span>
<a id="__codelineno-99-7" name="__codelineno-99-7" href="#__codelineno-99-7"></a><span class="nv">RECIPE</span><span class="o">=</span><span class="nv">$WORKSPACE</span>/meta-intel-fpga-refdes/recipes-bsp/ghrd/hw-ref-design.bb
<a id="__codelineno-99-8" name="__codelineno-99-8" href="#__codelineno-99-8"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/</span><span class="nv">$OLD_CORE_URI</span><span class="s2">/</span><span class="nv">$NEW_CORE_URI</span><span class="s2">/g&quot;</span><span class="w"> </span><span class="nv">$RECIPE</span>
<a id="__codelineno-99-9" name="__codelineno-99-9" href="#__codelineno-99-9"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/</span><span class="nv">$OLD_PER0_URI</span><span class="s2">/</span><span class="nv">$NEW_PER0_URI</span><span class="s2">/g&quot;</span><span class="w"> </span><span class="nv">$RECIPE</span>
<a id="__codelineno-99-10" name="__codelineno-99-10" href="#__codelineno-99-10"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/</span><span class="nv">$OLD_PER1_URI</span><span class="s2">/</span><span class="nv">$NEW_PER1_URI</span><span class="s2">/g&quot;</span><span class="w"> </span><span class="nv">$RECIPE</span>
</code></pre></div>
<p>Note we have left the NAND file alone, that will be downloaded from rocketboards.</p>
<p>3. Update the same Yocto recipe to change the SHA checksums for the new files:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-100-1" name="__codelineno-100-1" href="#__codelineno-100-1"></a>SRC_URI<span class="o">[</span>stratix10_htile_gsrd_core.sha256sum<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;6a7e4b9ed6146fa02ad6f37896d7d7a34ed14a0895e9e7ef92e2d6e442c8fd62&quot;</span>
<a id="__codelineno-100-2" name="__codelineno-100-2" href="#__codelineno-100-2"></a>SRC_URI<span class="o">[</span>stratix10_htile_nand_core.sha256sum<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;3ea5efca3cb223e150d0600742881daf7b1f1c364498d60d20dd952d5150e3ef&quot;</span>
<a id="__codelineno-100-3" name="__codelineno-100-3" href="#__codelineno-100-3"></a>SRC_URI<span class="o">[</span>stratix10_htile_pr_core.sha256sum<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;a10931cbb11efb091d8794f9e87cfec65b5a53067926d212449a914bab411b88&quot;</span>
<a id="__codelineno-100-4" name="__codelineno-100-4" href="#__codelineno-100-4"></a>SRC_URI<span class="o">[</span>stratix10_htile_pr_persona0.sha256sum<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;150c60bb1d6abd5b8998599bd244d2a687a3d5e6433d0edc2f8035dea7c9311f&quot;</span>
<a id="__codelineno-100-5" name="__codelineno-100-5" href="#__codelineno-100-5"></a>SRC_URI<span class="o">[</span>stratix10_htile_pr_persona1.sha256sum<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;80ba157a813a2db2fdbd03d05735f85a4ecde37553a26ebdf27eb07bdc259bc6&quot;</span>
</code></pre></div>
<p>to the new values using the following commands:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-101-1" name="__codelineno-101-1" href="#__codelineno-101-1"></a><span class="nv">CORE_SHA</span><span class="o">=</span><span class="k">$(</span>sha256sum<span class="w"> </span><span class="nv">$CORE_RBF</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-f1<span class="w"> </span>-d<span class="s2">&quot; &quot;</span><span class="k">)</span>
<a id="__codelineno-101-2" name="__codelineno-101-2" href="#__codelineno-101-2"></a><span class="nv">PER0_SHA</span><span class="o">=</span><span class="k">$(</span>sha256sum<span class="w"> </span><span class="nv">$PER0_RBF</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-f1<span class="w"> </span>-d<span class="s2">&quot; &quot;</span><span class="k">)</span>
<a id="__codelineno-101-3" name="__codelineno-101-3" href="#__codelineno-101-3"></a><span class="nv">PER1_SHA</span><span class="o">=</span><span class="k">$(</span>sha256sum<span class="w"> </span><span class="nv">$PER1_RBF</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-f1<span class="w"> </span>-d<span class="s2">&quot; &quot;</span><span class="k">)</span>
<a id="__codelineno-101-4" name="__codelineno-101-4" href="#__codelineno-101-4"></a><span class="nv">OLD_CORE_SHA</span><span class="o">=</span><span class="s2">&quot;SRC_URI\[stratix10_htile_pr_core\.sha256sum\] = .*&quot;</span>
<a id="__codelineno-101-5" name="__codelineno-101-5" href="#__codelineno-101-5"></a><span class="nv">NEW_CORE_SHA</span><span class="o">=</span><span class="s2">&quot;SRC_URI[stratix10_htile_pr_core.sha256sum] = \&quot;</span><span class="nv">$CORE_SHA</span><span class="s2">\&quot;&quot;</span>
<a id="__codelineno-101-6" name="__codelineno-101-6" href="#__codelineno-101-6"></a><span class="nv">OLD_PER0_SHA</span><span class="o">=</span><span class="s2">&quot;SRC_URI\[stratix10_htile_pr_persona0\.sha256sum\] = .*&quot;</span>
<a id="__codelineno-101-7" name="__codelineno-101-7" href="#__codelineno-101-7"></a><span class="nv">NEW_PER0_SHA</span><span class="o">=</span><span class="s2">&quot;SRC_URI[stratix10_htile_pr_persona0.sha256sum] = \&quot;</span><span class="nv">$PER0_SHA</span><span class="s2">\&quot;&quot;</span>
<a id="__codelineno-101-8" name="__codelineno-101-8" href="#__codelineno-101-8"></a><span class="nv">OLD_PER1_SHA</span><span class="o">=</span><span class="s2">&quot;SRC_URI\[stratix10_htile_pr_persona1\.sha256sum\] = .*&quot;</span>
<a id="__codelineno-101-9" name="__codelineno-101-9" href="#__codelineno-101-9"></a><span class="nv">NEW_PER1_SHA</span><span class="o">=</span><span class="s2">&quot;SRC_URI[stratix10_htile_pr_persona1.sha256sum] = \&quot;</span><span class="nv">$PER1_SHA</span><span class="s2">\&quot;&quot;</span>
<a id="__codelineno-101-10" name="__codelineno-101-10" href="#__codelineno-101-10"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/</span><span class="nv">$OLD_CORE_SHA</span><span class="s2">/</span><span class="nv">$NEW_CORE_SHA</span><span class="s2">/g&quot;</span><span class="w"> </span><span class="nv">$RECIPE</span>
<a id="__codelineno-101-11" name="__codelineno-101-11" href="#__codelineno-101-11"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/</span><span class="nv">$OLD_PER0_SHA</span><span class="s2">/</span><span class="nv">$NEW_PER0_SHA</span><span class="s2">/g&quot;</span><span class="w"> </span><span class="nv">$RECIPE</span>
<a id="__codelineno-101-12" name="__codelineno-101-12" href="#__codelineno-101-12"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/</span><span class="nv">$OLD_PER1_SHA</span><span class="s2">/</span><span class="nv">$NEW_PER1_SHA</span><span class="s2">/g&quot;</span><span class="w"> </span><span class="nv">$RECIPE</span>
</code></pre></div>
<p>4. Optionally change the following files in <code>$WORKSPACE/meta-intel-fpga-refdes/recipes-bsp/u-boot/files/</code>:</p>
<ul>
<li><a href="https://github.com/altera-opensource/meta-intel-fpga-refdes/blob/master/recipes-bsp/u-boot/files/uboot.txt">uboot.txt</a> - distroboot script</li>
<li><a href="https://github.com/altera-opensource/meta-intel-fpga-refdes/blob/master/recipes-bsp/u-boot/files/uboot_script.its">uboot_script.its</a> - its file for creating FIT image from the above script</li>
</ul>
<p>5. Optionally change the following file in <code>$WORKSPACE/meta-intel-fpga-refdes/recipes-kernel/linux/linux-socfpga-lts</code>:</p>
<ul>
<li>
<p>fit_kernel_stratix10.its - its file for creating the kernel.itb image, containing by default:</p>
<ul>
<li>Kernel</li>
<li>Device trees for SD and NAND board configurations</li>
<li>Core RBF files for SD and NAND board configurations</li>
<li>Board configurations for SD and NAND cases</li>
</ul>
</li>
</ul>
<h4 id="build-yocto_2">Build Yocto<a class="headerlink" href="#build-yocto_2" title="Permanent link">&para;</a></h4>
<p>Build Yocto:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-102-1" name="__codelineno-102-1" href="#__codelineno-102-1"></a>bitbake_image
</code></pre></div>
<p>Gather files:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-103-1" name="__codelineno-103-1" href="#__codelineno-103-1"></a>package
</code></pre></div>
<p>Once the build is completed successfully, you will see the following two folders are created:</p>
<ul>
<li><code>stratix10_htile_gsrd_rootfs</code>: area used by OpenEmbedded build system for builds. Description of build directory structure - https://docs.yoctoproject.org/ref-manual/structure.html#the-build-directory-build</li>
<li><code>stratix10_htile_gsrd_images</code>: the build script copies here relevant files built by Yocto from the <code>stratix10_htile_gsrd_rootfs/tmp/deploy/images/agilex</code> folder, but also other relevant files.</li>
</ul>
<p>The two most relevant files created in the <code>$TOP_FOLDER/gsrd_socfpga/stratix10_htile-gsrd-images</code> folder are:</p>
<table>
<thead>
<tr>
<th align="left">File</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">sdimage.tar.gz</td>
<td align="left">SD Card Image</td>
</tr>
<tr>
<td align="left">u-boot-stratix10-socdk-gsrd-atf/u-boot-spl-dtb.hex</td>
<td align="left">U-Boot SPL Hex file</td>
</tr>
</tbody>
</table>
<h4 id="create-qspi-image_3">Create QSPI Image<a class="headerlink" href="#create-qspi-image_3" title="Permanent link">&para;</a></h4>
<p>The QSPI image will contain the FPGA configuration data and the HPS FSBL and it can be built using the following command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-104-1" name="__codelineno-104-1" href="#__codelineno-104-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-104-2" name="__codelineno-104-2" href="#__codelineno-104-2"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>s10_soc_devkit_ghrd/output_files/ghrd_1sx280hu2f50e1vgas.sof<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-104-3" name="__codelineno-104-3" href="#__codelineno-104-3"></a><span class="w"> </span>ghrd_1sx280hu2f50e1vgas.jic<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-104-4" name="__codelineno-104-4" href="#__codelineno-104-4"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">device</span><span class="o">=</span>MT25QU02G<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-104-5" name="__codelineno-104-5" href="#__codelineno-104-5"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">flash_loader</span><span class="o">=</span>1SX280HU2<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-104-6" name="__codelineno-104-6" href="#__codelineno-104-6"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">hps_path</span><span class="o">=</span>gsrd_socfpga/stratix10_htile-gsrd-images/u-boot-stratix10-socdk-gsrd-atf/u-boot-spl-dtb.hex<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-104-7" name="__codelineno-104-7" href="#__codelineno-104-7"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">mode</span><span class="o">=</span>ASX4<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-104-8" name="__codelineno-104-8" href="#__codelineno-104-8"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">hps</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
<p>The following files will be created:</p>
<ul>
<li>$TOP_FOLDER/ghrd_1sx280hu2f50e1vgas.hps.jic - Flash image for HPS First configuration bitstream, phase 1: HPS and DDR</li>
<li>$TOP_FOLDER/ghrd_1sx280hu2f50e1vgas.core.rbf - HPS First configuration bitstream, phase 2: FPGA fabric. We already have the same file on the SD card.</li>
</ul>
<h3 id="boot-from-sd-card-on-dk-soc-1ssx-l-d">Boot from SD Card on DK-SOC-1SSX-L-D<a class="headerlink" href="#boot-from-sd-card-on-dk-soc-1ssx-l-d" title="Permanent link">&para;</a></h3>
<p>This section demonstrates how to build the binaries targeting the DK-SOC-1SSX-L-D board which is now obsolete.</p>
<p>Only the SD card boot scenario is covered, but similar instructions can be used for the other scenarios.</p>
<h4 id="build-flow_2">Build Flow<a class="headerlink" href="#build-flow_2" title="Permanent link">&para;</a></h4>
<p>The following diagram illustrates the full build flow for the GSRD based on source code from GitHub.</p>
<p><a class="glightbox" href="../images/s10-gsrd-build-flow.svg" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/s10-gsrd-build-flow.svg" /></a></p>
<p>The current build flow creates a single boot image which is able to boot in different board configurations (either using OOBE or eMMC/NAND daughter card). For more information about how this single boot image is created, please refer to the following article: <a href="https://rocketboards.org/foswiki/Documentation/SingleImageBoot">https://rocketboards.org/foswiki/Documentation/SingleImageBoot</a>.</p>
<h4 id="set-up-environment_3">Set up Environment<a class="headerlink" href="#set-up-environment_3" title="Permanent link">&para;</a></h4>
<p>Create a top folder for this example, as the rest of the commands assume this location:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-105-1" name="__codelineno-105-1" href="#__codelineno-105-1"></a>sudo<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>stratix10_gsrd.enpirion
<a id="__codelineno-105-2" name="__codelineno-105-2" href="#__codelineno-105-2"></a>mkdir<span class="w"> </span>stratix10_gsrd.enpirion
<a id="__codelineno-105-3" name="__codelineno-105-3" href="#__codelineno-105-3"></a><span class="nb">cd</span><span class="w"> </span>stratix10_gsrd.enpirion
<a id="__codelineno-105-4" name="__codelineno-105-4" href="#__codelineno-105-4"></a><span class="nb">export</span><span class="w"> </span><span class="nv">TOP_FOLDER</span><span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>
</code></pre></div>
<p>Download the compiler toolchain, add it to the PATH variable, to be used by the GHRD makefile to build the HPS Debug FSBL:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-106-1" name="__codelineno-106-1" href="#__codelineno-106-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-106-2" name="__codelineno-106-2" href="#__codelineno-106-2"></a>wget<span class="w"> </span>https://developer.arm.com/-/media/Files/downloads/gnu/11.2-2022.02/binrel/<span class="se">\</span>
<a id="__codelineno-106-3" name="__codelineno-106-3" href="#__codelineno-106-3"></a>gcc-arm-11.2-2022.02-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-106-4" name="__codelineno-106-4" href="#__codelineno-106-4"></a>tar<span class="w"> </span>xf<span class="w"> </span>gcc-arm-11.2-2022.02-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-106-5" name="__codelineno-106-5" href="#__codelineno-106-5"></a>rm<span class="w"> </span>-f<span class="w"> </span>gcc-arm-11.2-2022.02-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-106-6" name="__codelineno-106-6" href="#__codelineno-106-6"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>/gcc-arm-11.2-2022.02-x86_64-aarch64-none-linux-gnu/bin:<span class="nv">$PATH</span>
<a id="__codelineno-106-7" name="__codelineno-106-7" href="#__codelineno-106-7"></a><span class="nb">export</span><span class="w"> </span><span class="nv">ARCH</span><span class="o">=</span>arm64
<a id="__codelineno-106-8" name="__codelineno-106-8" href="#__codelineno-106-8"></a><span class="nb">export</span><span class="w"> </span><span class="nv">CROSS_COMPILE</span><span class="o">=</span>aarch64-none-linux-gnu-
</code></pre></div>
<p>Enable Quartus tools to be called from command line:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-107-1" name="__codelineno-107-1" href="#__codelineno-107-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_ROOTDIR</span><span class="o">=</span>~/intelFPGA_pro/24.3/quartus/
<a id="__codelineno-107-2" name="__codelineno-107-2" href="#__codelineno-107-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>/bin:<span class="nv">$QUARTUS_ROOTDIR</span>/linux64:<span class="nv">$QUARTUS_ROOTDIR</span>/../qsys/bin:<span class="nv">$PATH</span>
</code></pre></div>
<h4 id="build-hardware-design_3">Build Hardware Design<a class="headerlink" href="#build-hardware-design_3" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-108-1" name="__codelineno-108-1" href="#__codelineno-108-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-108-2" name="__codelineno-108-2" href="#__codelineno-108-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>ghrd-socfpga<span class="w"> </span>s10_soc_devkit_ghrd
<a id="__codelineno-108-3" name="__codelineno-108-3" href="#__codelineno-108-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS24.3_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-opensource/ghrd-socfpga
<a id="__codelineno-108-4" name="__codelineno-108-4" href="#__codelineno-108-4"></a>mv<span class="w"> </span>ghrd-socfpga/s10_soc_devkit_ghrd<span class="w"> </span>.
<a id="__codelineno-108-5" name="__codelineno-108-5" href="#__codelineno-108-5"></a>rm<span class="w"> </span>-rf<span class="w"> </span>ghrd-socfpga
<a id="__codelineno-108-6" name="__codelineno-108-6" href="#__codelineno-108-6"></a><span class="nb">cd</span><span class="w"> </span>s10_soc_devkit_ghrd
<a id="__codelineno-108-7" name="__codelineno-108-7" href="#__codelineno-108-7"></a>make<span class="w"> </span>scrub_clean_all
<a id="__codelineno-108-8" name="__codelineno-108-8" href="#__codelineno-108-8"></a>make<span class="w"> </span>generate_from_tcl
<a id="__codelineno-108-9" name="__codelineno-108-9" href="#__codelineno-108-9"></a>make<span class="w"> </span>all
<a id="__codelineno-108-10" name="__codelineno-108-10" href="#__codelineno-108-10"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<p>The following files are created in $TOP_FOLDER/s10_soc_devkit_ghrd/output_files:</p>
<ul>
<li>ghrd_1sx280lu2f50e2vg.sof - FPGA SOF file, without HPS FSBL</li>
<li>ghrd_1sx280lu2f50e2vg_hps_debug.sof - FPGA SOF, with HPS Debug FSBL</li>
</ul>
<h4 id="build-core-rbf_3">Build Core RBF<a class="headerlink" href="#build-core-rbf_3" title="Permanent link">&para;</a></h4>
<p>Create the Core RBF file to be used in the rootfs created by Yocto by using the HPS Debug SOF built by the GHRD makefile:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-109-1" name="__codelineno-109-1" href="#__codelineno-109-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-109-2" name="__codelineno-109-2" href="#__codelineno-109-2"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>s10_soc_devkit_ghrd/output_files/ghrd_1sx280lu2f50e2vg_hps_debug.sof<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-109-3" name="__codelineno-109-3" href="#__codelineno-109-3"></a><span class="w"> </span>ghrd_1sx280lu2f50e2vg.jic<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-109-4" name="__codelineno-109-4" href="#__codelineno-109-4"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">device</span><span class="o">=</span>MT25QU02G<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-109-5" name="__codelineno-109-5" href="#__codelineno-109-5"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">flash_loader</span><span class="o">=</span>1SX280LU2<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-109-6" name="__codelineno-109-6" href="#__codelineno-109-6"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">mode</span><span class="o">=</span>ASX4<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-109-7" name="__codelineno-109-7" href="#__codelineno-109-7"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">hps</span><span class="o">=</span><span class="m">1</span>
<a id="__codelineno-109-8" name="__codelineno-109-8" href="#__codelineno-109-8"></a>rm<span class="w"> </span>ghrd_1sx280lu2f50e2vg.hps.jic
</code></pre></div>
<p>The following files will be created:</p>
<ul>
<li>$TOP_FOLDER/ghrd_1sx280lu2f50e2vg.core.rbf - HPS First configuration bitstream, phase 2: FPGA fabric</li>
</ul>
<p>Note we are also creating an HPS JIC file, but we are discarding it, as it has the HPS Debug FSBL, while the final image needs to have the U-Boot SPL created by the Yocto recipes.</p>
<h4 id="set-up-yocto_3">Set Up Yocto<a class="headerlink" href="#set-up-yocto_3" title="Permanent link">&para;</a></h4>
<p>1. Make sure you have Yocto system requirements met: https://docs.yoctoproject.org/5.0.1/ref-manual/system-requirements.html#supported-linux-distributions.</p>
<p>The command to install the required packages on Ubuntu 22.04 is:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-110-1" name="__codelineno-110-1" href="#__codelineno-110-1"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>update
<a id="__codelineno-110-2" name="__codelineno-110-2" href="#__codelineno-110-2"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>upgrade
<a id="__codelineno-110-3" name="__codelineno-110-3" href="#__codelineno-110-3"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>openssh-server<span class="w"> </span>mc<span class="w"> </span>libgmp3-dev<span class="w"> </span>libmpc-dev<span class="w"> </span>gawk<span class="w"> </span>wget<span class="w"> </span>git<span class="w"> </span>diffstat<span class="w"> </span>unzip<span class="w"> </span>texinfo<span class="w"> </span>gcc<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-110-4" name="__codelineno-110-4" href="#__codelineno-110-4"></a>build-essential<span class="w"> </span>chrpath<span class="w"> </span>socat<span class="w"> </span>cpio<span class="w"> </span>python3<span class="w"> </span>python3-pip<span class="w"> </span>python3-pexpect<span class="w"> </span>xz-utils<span class="w"> </span>debianutils<span class="w"> </span>iputils-ping<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-110-5" name="__codelineno-110-5" href="#__codelineno-110-5"></a>python3-git<span class="w"> </span>python3-jinja2<span class="w"> </span>libegl1-mesa<span class="w"> </span>libsdl1.2-dev<span class="w"> </span>pylint<span class="w"> </span>xterm<span class="w"> </span>python3-subunit<span class="w"> </span>mesa-common-dev<span class="w"> </span>zstd<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-110-6" name="__codelineno-110-6" href="#__codelineno-110-6"></a>liblz4-tool<span class="w"> </span>git<span class="w"> </span>fakeroot<span class="w"> </span>build-essential<span class="w"> </span>ncurses-dev<span class="w"> </span>xz-utils<span class="w"> </span>libssl-dev<span class="w"> </span>bc<span class="w"> </span>flex<span class="w"> </span>libelf-dev<span class="w"> </span>bison<span class="w"> </span>xinetd<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-110-7" name="__codelineno-110-7" href="#__codelineno-110-7"></a>tftpd<span class="w"> </span>tftp<span class="w"> </span>nfs-kernel-server<span class="w"> </span>libncurses5<span class="w"> </span>libc6-i386<span class="w"> </span>libstdc++6:i386<span class="w"> </span>libgcc++1:i386<span class="w"> </span>lib32z1<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-110-8" name="__codelineno-110-8" href="#__codelineno-110-8"></a>device-tree-compiler<span class="w"> </span>curl<span class="w"> </span>mtd-utils<span class="w"> </span>u-boot-tools<span class="w"> </span>net-tools<span class="w"> </span>swig<span class="w"> </span>-y
</code></pre></div>
<p>On Ubuntu 22.04 you will also need to point the /bin/sh to /bin/bash, as the default is a link to /bin/dash:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-111-1" name="__codelineno-111-1" href="#__codelineno-111-1"></a><span class="w"> </span>sudo<span class="w"> </span>ln<span class="w"> </span>-sf<span class="w"> </span>/bin/bash<span class="w"> </span>/bin/sh
</code></pre></div>
<p><strong>Note</strong>: You can also use a Docker container to build the Yocto recipes, refer to https://rocketboards.org/foswiki/Documentation/DockerYoctoBuild for details. When using a Docker container, it does not matter what Linux distribution or packages you have installed on your host, as all dependencies are provided by the Docker container.</p>
<p>2. Clone the Yocto script and prepare the build:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-112-1" name="__codelineno-112-1" href="#__codelineno-112-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-112-2" name="__codelineno-112-2" href="#__codelineno-112-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>gsrd_socfpga
<a id="__codelineno-112-3" name="__codelineno-112-3" href="#__codelineno-112-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS24.3_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-opensource/gsrd_socfpga
<a id="__codelineno-112-4" name="__codelineno-112-4" href="#__codelineno-112-4"></a><span class="nb">cd</span><span class="w"> </span>gsrd_socfpga
<a id="__codelineno-112-5" name="__codelineno-112-5" href="#__codelineno-112-5"></a>.<span class="w"> </span>stratix10-gsrd-build.sh
<a id="__codelineno-112-6" name="__codelineno-112-6" href="#__codelineno-112-6"></a>build_setup
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-113-1" name="__codelineno-113-1" href="#__codelineno-113-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>/gsrd_socfpga
<a id="__codelineno-113-2" name="__codelineno-113-2" href="#__codelineno-113-2"></a>.<span class="w"> </span>./poky/oe-init-build-env<span class="w"> </span>stratix10-gsrd-rootfs/
</code></pre></div>
<h4 id="customize-yocto_3">Customize Yocto<a class="headerlink" href="#customize-yocto_3" title="Permanent link">&para;</a></h4>
<p>1. Copy the rebuilt files to <code>$WORKSPACE/meta-intel-fpga-refdes/recipes-bsp/ghrd/files</code> using the following names, as expected by the yocto recipes:</p>
<ul>
<li>stratix10_gsrd_ghrd.core.rbf</li>
<li>stratix10_pr_persona0.rbf: not applicable, PR not enabled in this scenario</li>
<li>stratix10_pr_persona1.rbf: not applicable, PR not enabled in this scenario</li>
<li>stratix10_nand_ghrd.core.rbf: not applicable, as we have not rebuilt the NAND version</li>
</ul>
<p>This can be accomplished using the following instructions:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-114-1" name="__codelineno-114-1" href="#__codelineno-114-1"></a><span class="nv">GHRD_LOC</span><span class="o">=</span><span class="nv">$WORKSPACE</span>/meta-intel-fpga-refdes/recipes-bsp/ghrd/files
<a id="__codelineno-114-2" name="__codelineno-114-2" href="#__codelineno-114-2"></a><span class="nv">CORE_RBF</span><span class="o">=</span><span class="nv">$GHRD_LOC</span>/stratix10_gsrd_ghrd.core.rbf
<a id="__codelineno-114-3" name="__codelineno-114-3" href="#__codelineno-114-3"></a>cp<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/ghrd_1sx280lu2f50e2vg.core.rbf<span class="w"> </span><span class="nv">$CORE_RBF</span>
</code></pre></div>
<p>2. Update the Yocto recipe at <code>$WORKSPACE/meta-intel-fpga-refdes/recipes-bsp/ghrd/hw-ref-design.bb</code> to change the <code>SRC_URI:stratix10</code> from the orginal value:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-115-1" name="__codelineno-115-1" href="#__codelineno-115-1"></a>SRC_URI:stratix10<span class="w"> </span>?<span class="o">=</span><span class="w"> </span><span class="s2">&quot;\</span>
<a id="__codelineno-115-2" name="__codelineno-115-2" href="#__codelineno-115-2"></a><span class="s2"> </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_gsrd_</span><span class="si">${</span><span class="nv">ARM64_GHRD_CORE_RBF</span><span class="si">}</span><span class="s2">;name=stratix10_gsrd_core \</span>
<a id="__codelineno-115-3" name="__codelineno-115-3" href="#__codelineno-115-3"></a><span class="s2"> </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_nand_</span><span class="si">${</span><span class="nv">ARM64_GHRD_CORE_RBF</span><span class="si">}</span><span class="s2">;name=stratix10_nand_core \</span>
<a id="__codelineno-115-4" name="__codelineno-115-4" href="#__codelineno-115-4"></a><span class="s2"> </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_pr_persona0.rbf;name=stratix10_pr_persona0 \</span>
<a id="__codelineno-115-5" name="__codelineno-115-5" href="#__codelineno-115-5"></a><span class="s2"> </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_pr_persona1.rbf;name=stratix10_pr_persona1 \</span>
<a id="__codelineno-115-6" name="__codelineno-115-6" href="#__codelineno-115-6"></a><span class="s2"> &quot;</span>
</code></pre></div>
<p>to be:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-116-1" name="__codelineno-116-1" href="#__codelineno-116-1"></a>SRC_URI:stratix10<span class="w"> </span>?<span class="o">=</span><span class="w"> </span><span class="s2">&quot;\</span>
<a id="__codelineno-116-2" name="__codelineno-116-2" href="#__codelineno-116-2"></a><span class="s2"> file://stratix10_gsrd_ghrd.core.rbf \</span>
<a id="__codelineno-116-3" name="__codelineno-116-3" href="#__codelineno-116-3"></a><span class="s2"> </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_nand_</span><span class="si">${</span><span class="nv">ARM64_GHRD_CORE_RBF</span><span class="si">}</span><span class="s2">;name=stratix10_nand_core \</span>
<a id="__codelineno-116-4" name="__codelineno-116-4" href="#__codelineno-116-4"></a><span class="s2"> </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_pr_persona0.rbf;name=stratix10_pr_persona0 \</span>
<a id="__codelineno-116-5" name="__codelineno-116-5" href="#__codelineno-116-5"></a><span class="s2"> </span><span class="si">${</span><span class="nv">GHRD_REPO</span><span class="si">}</span><span class="s2">/stratix10_pr_persona1.rbf;name=stratix10_pr_persona1 \</span>
<a id="__codelineno-116-6" name="__codelineno-116-6" href="#__codelineno-116-6"></a><span class="s2"> &quot;</span>
</code></pre></div>
<p>using the following commands from the console:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-117-1" name="__codelineno-117-1" href="#__codelineno-117-1"></a><span class="nv">OLD_CORE_URI</span><span class="o">=</span><span class="s2">&quot;\${GHRD_REPO}\/stratix10_gsrd_\${ARM64_GHRD_CORE_RBF};name=stratix10_gsrd_core&quot;</span>
<a id="__codelineno-117-2" name="__codelineno-117-2" href="#__codelineno-117-2"></a><span class="nv">NEW_CORE_URI</span><span class="o">=</span><span class="s2">&quot;file:\/\/stratix10_gsrd_ghrd.core.rbf&quot;</span>
<a id="__codelineno-117-3" name="__codelineno-117-3" href="#__codelineno-117-3"></a><span class="nv">RECIPE</span><span class="o">=</span><span class="nv">$WORKSPACE</span>/meta-intel-fpga-refdes/recipes-bsp/ghrd/hw-ref-design.bb
<a id="__codelineno-117-4" name="__codelineno-117-4" href="#__codelineno-117-4"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/</span><span class="nv">$OLD_CORE_URI</span><span class="s2">/</span><span class="nv">$NEW_CORE_URI</span><span class="s2">/g&quot;</span><span class="w"> </span><span class="nv">$RECIPE</span>
</code></pre></div>
<p>Note we have left the PR and NAND files alone, that will be downloaded from rocketboards.</p>
<p>3. Update the same Yocto recipe to change the SHA checksums for the new files:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-118-1" name="__codelineno-118-1" href="#__codelineno-118-1"></a>SRC_URI<span class="o">[</span>stratix10_gsrd_core.sha256sum<span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;ea26a77ebc1b3141193de6dd32e22f332785e05c956de85118c3790392141d3c&quot;</span>
</code></pre></div>
<p>to the new values using the following commands:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-119-1" name="__codelineno-119-1" href="#__codelineno-119-1"></a><span class="nv">CORE_SHA</span><span class="o">=</span><span class="k">$(</span>sha256sum<span class="w"> </span><span class="nv">$CORE_RBF</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-f1<span class="w"> </span>-d<span class="s2">&quot; &quot;</span><span class="k">)</span>
<a id="__codelineno-119-2" name="__codelineno-119-2" href="#__codelineno-119-2"></a><span class="nv">OLD_CORE_SHA</span><span class="o">=</span><span class="s2">&quot;SRC_URI\[stratix10_gsrd_core\.sha256sum\] = .*&quot;</span>
<a id="__codelineno-119-3" name="__codelineno-119-3" href="#__codelineno-119-3"></a><span class="nv">NEW_CORE_SHA</span><span class="o">=</span><span class="s2">&quot;SRC_URI[stratix10_gsrd_core.sha256sum] = \&quot;</span><span class="nv">$CORE_SHA</span><span class="s2">\&quot;&quot;</span>
<a id="__codelineno-119-4" name="__codelineno-119-4" href="#__codelineno-119-4"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/</span><span class="nv">$OLD_CORE_SHA</span><span class="s2">/</span><span class="nv">$NEW_CORE_SHA</span><span class="s2">/g&quot;</span><span class="w"> </span><span class="nv">$RECIPE</span>
</code></pre></div>
<p>4. Optionally change the following files in <code>$WORKSPACE/meta-intel-fpga-refdes/recipes-bsp/u-boot/files/</code>:</p>
<ul>
<li><a href="https://github.com/altera-opensource/meta-intel-fpga-refdes/blob/master/recipes-bsp/u-boot/files/uboot.txt">uboot.txt</a> - distroboot script</li>
<li><a href="https://github.com/altera-opensource/meta-intel-fpga-refdes/blob/master/recipes-bsp/u-boot/files/uboot_script.its">uboot_script.its</a> - its file for creating FIT image from the above script</li>
</ul>
<p>5. Optionally change the following file in <code>$WORKSPACE/meta-intel-fpga-refdes/recipes-kernel/linux/linux-socfpga-lts</code>:</p>
<ul>
<li>
<p>fit_kernel_stratix10.its - its file for creating the kernel.itb image, containing by default:</p>
<ul>
<li>Kernel</li>
<li>Device trees for SD and NAND board configurations</li>
<li>Core RBF files for SD and NAND board configurations</li>
<li>Board configurations for SD and NAND cases</li>
</ul>
</li>
</ul>
<h4 id="build-yocto_3">Build Yocto<a class="headerlink" href="#build-yocto_3" title="Permanent link">&para;</a></h4>
<p>Build Yocto:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-120-1" name="__codelineno-120-1" href="#__codelineno-120-1"></a>bitbake_image
</code></pre></div>
<p>Gather files:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-121-1" name="__codelineno-121-1" href="#__codelineno-121-1"></a>package
</code></pre></div>
<p>Once the build is completed successfully, you will see the following two folders are created:</p>
<ul>
<li><code>stratix10_gsrd_rootfs</code>: area used by OpenEmbedded build system for builds. Description of build directory structure - https://docs.yoctoproject.org/ref-manual/structure.html#the-build-directory-build</li>
<li><code>stratix10_gsrd_images</code>: the build script copies here relevant files built by Yocto from the <code>stratix10_gsrd_rootfs/tmp/deploy/images/agilex</code> folder, but also other relevant files.</li>
</ul>
<p>The two most relevant files created in the <code>$TOP_FOLDER/gsrd_socfpga/stratix10_htile-gsrd-images</code> folder are:</p>
<table>
<thead>
<tr>
<th align="left">File</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">sdimage.tar.gz</td>
<td align="left">SD Card Image</td>
</tr>
<tr>
<td align="left">u-boot-stratix10-socdk-gsrd-atf/u-boot-spl-dtb.hex</td>
<td align="left">U-Boot SPL Hex file</td>
</tr>
</tbody>
</table>
<h4 id="create-qspi-image_4">Create QSPI Image<a class="headerlink" href="#create-qspi-image_4" title="Permanent link">&para;</a></h4>
<p>The QSPI image will contain the FPGA configuration data and the HPS FSBL and it can be built using the following command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-122-1" name="__codelineno-122-1" href="#__codelineno-122-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-122-2" name="__codelineno-122-2" href="#__codelineno-122-2"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>s10_soc_devkit_ghrd/output_files/ghrd_1sx280lu2f50e2vg.sof<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-122-3" name="__codelineno-122-3" href="#__codelineno-122-3"></a><span class="w"> </span>ghrd_1sx280lu2f50e2vg.jic<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-122-4" name="__codelineno-122-4" href="#__codelineno-122-4"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">device</span><span class="o">=</span>MT25QU02G<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-122-5" name="__codelineno-122-5" href="#__codelineno-122-5"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">flash_loader</span><span class="o">=</span>1SX280LU2<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-122-6" name="__codelineno-122-6" href="#__codelineno-122-6"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">hps_path</span><span class="o">=</span>gsrd_socfpga/stratix10-gsrd-images/u-boot-stratix10-socdk-gsrd-atf/u-boot-spl-dtb.hex<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-122-7" name="__codelineno-122-7" href="#__codelineno-122-7"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">mode</span><span class="o">=</span>ASX4<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-122-8" name="__codelineno-122-8" href="#__codelineno-122-8"></a><span class="w"> </span>-o<span class="w"> </span><span class="nv">hps</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
<p>The following files will be created:</p>
<ul>
<li>$TOP_FOLDER/ghrd_1sx280lu2f50e2vg.hps.jic - Flash image for HPS First configuration bitstream, phase 1: HPS and DDR</li>
<li>$TOP_FOLDER/ghrd_1sx280lu2f50e2vg.core.rbf - HPS First configuration bitstream, phase 2: FPGA fabric. We already have the same file on the SD card.</li>
</ul>
<h2 id="notices-disclaimers">Notices &amp; Disclaimers<a class="headerlink" href="#notices-disclaimers" title="Permanent link">&para;</a></h2>
<p>Altera<sup>&reg;</sup> Corporation technologies may require enabled hardware, software or service activation.
No product or component can be absolutely secure. 
Performance varies by use, configuration and other factors.
Your costs and results may vary. 
You may not use or facilitate the use of this document in connection with any infringement or other legal analysis concerning Altera or Intel products described herein. You agree to grant Altera Corporation a non-exclusive, royalty-free license to any patent claim thereafter drafted which includes subject matter disclosed herein.
No license (express or implied, by estoppel or otherwise) to any intellectual property rights is granted by this document, with the sole exception that you may publish an unmodified copy. You may create software implementations based on this document and in compliance with the foregoing that are intended to execute on the Altera or Intel product(s) referenced in this document. No rights are granted to create modifications or derivatives of this document.
The products described may contain design defects or errors known as errata which may cause the product to deviate from published specifications.  Current characterized errata are available on request.
Altera disclaims all express and implied warranties, including without limitation, the implied warranties of merchantability, fitness for a particular purpose, and non-infringement, as well as any warranty arising from course of performance, course of dealing, or usage in trade.
You are responsible for safety of the overall system, including compliance with applicable safety-related requirements or standards. 
<sup>&copy;</sup> Altera Corporation.  Altera, the Altera logo, and other Altera marks are trademarks of Altera Corporation.  Other names and brands may be claimed as the property of others. </p>
<p>OpenCL* and the OpenCL* logo are trademarks of Apple Inc. used by permission of the Khronos Group™. </p>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">December 11, 2024</span>
      
        <br>
        Created:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">November 27, 2024</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../../../../agilex-7/m-series/pcie_rp/ug-pcie_rp-agx7m-hbm2e/" class="md-footer__link md-footer__link--prev" aria-label="Previous: PCIe Root Port User Guide" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                PCIe Root Port User Guide
              </div>
            </div>
          </a>
        
        
          
          <a href="../../rsu/ug-rsu-s10sx-soc/" class="md-footer__link md-footer__link--next" aria-label="Next: SoC HPS Remote System Update Example" rel="next">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                SoC HPS Remote System Update Example
              </div>
            </div>
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.altera.com" target="_blank" rel="noopener" title="www.altera.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2m-5.15 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95a8.03 8.03 0 0 1-4.33 3.56M14.34 14H9.66c-.1-.66-.16-1.32-.16-2 0-.68.06-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2M12 19.96c-.83-1.2-1.5-2.53-1.91-3.96h3.82c-.41 1.43-1.08 2.76-1.91 3.96M8 8H5.08A7.923 7.923 0 0 1 9.4 4.44C8.8 5.55 8.35 6.75 8 8m-2.92 8H8c.35 1.25.8 2.45 1.4 3.56A8.008 8.008 0 0 1 5.08 16m-.82-2C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2M12 4.03c.83 1.2 1.5 2.54 1.91 3.97h-3.82c.41-1.43 1.08-2.77 1.91-3.97M18.92 8h-2.95a15.65 15.65 0 0 0-1.38-3.56c1.84.63 3.37 1.9 4.33 3.56M12 2C6.47 2 2 6.5 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2Z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/altera-fpga" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/altera-fpga/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.top", "navigation.indexes", "navigation.footer", "navigation.path", "navigation.tabs", "navigation.tabs.sticky", "search.suggest", "search.highlight", "content.code.copy", "navigation.indexes", "toc.follow", {"custom_dir": "overrides"}], "search": "../../../../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../../../assets/javascripts/bundle.fac441b0.min.js"></script>
      
        <script src="https://unpkg.com/tablefilter@0.7.3/dist/tablefilter/tablefilter.js"></script>
      
        <script src="../../../../../../assets/tables.js"></script>
      
        <script src="../../../../../../assets/extra.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>