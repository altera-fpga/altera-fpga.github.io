
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://altera-fpga.github.io/rel-25.1.1/embedded-designs/agilex-5/e-series/premium/boot-examples/ug-linux-boot-agx5e-premium/">
      
      
        <link rel="prev" href="../../gsrd_zephyr/ug-zgsrd-agx5e-premium/">
      
      
        <link rel="next" href="../../tsn/rgmii-hps/ug-tsncfg1-agx5e-premium/">
      
      <link rel="icon" href="../../../../../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.9">
    
    
      
        <title>HPS GHRD Linux Boot Examples - Altera FPGA Developer Site</title>
      
    
    
      <link rel="stylesheet" href="../../../../../../assets/stylesheets/main.85bb2934.min.css">
      
        
        <link rel="stylesheet" href="../../../../../../assets/stylesheets/palette.a6bdf11c.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../../../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#hps-ghrd-linux-boot-examples-for-the-agilextm-5-e-series-premium-dev-kit" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../../.." title="Altera FPGA Developer Site" class="md-header__button md-logo" aria-label="Altera FPGA Developer Site" data-md-component="logo">
      
  <img src="../../../../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Altera FPGA Developer Site
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              HPS GHRD Linux Boot Examples
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/altera-fpga" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    altera-fpga
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../../../.." class="md-tabs__link">
      Welcome
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../driver-list_linux/" class="md-tabs__link">
        Linux Drivers
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../driver-list_zephyr/" class="md-tabs__link">
        Zephyr Drivers
      </a>
    </li>
  

      
        
  
  


  
  
  
    

  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../virtualization/hypervisors/xen/xen-overview/" class="md-tabs__link">
        Virtualization
      </a>
    </li>
  

  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../driver-list_baremetal/" class="md-tabs__link">
        Baremetal Drivers
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../sw-tools-list/host-attach-tools/" class="md-tabs__link">
        Host Attach Utilities
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../ed-demo-list/ed-list/" class="md-tabs__link md-tabs__link--active">
        Example Designs
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../../.." title="Altera FPGA Developer Site" class="md-nav__button md-logo" aria-label="Altera FPGA Developer Site" data-md-component="logo">
      
  <img src="../../../../../../assets/logo.png" alt="logo">

    </a>
    Altera FPGA Developer Site
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/altera-fpga" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    altera-fpga
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../../.." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../../../driver-list_linux/">Linux Drivers</a>
          
            <label for="__nav_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Linux Drivers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
          HPS Host Drivers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          HPS Host Drivers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/hwmon/hwmon/" class="md-nav__link">
        Altera Hardware Monitor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/clock_manager/clock_manager/" class="md-nav__link">
        Clock Manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/dma/dma/" class="md-nav__link">
        DMA Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/edac/edac/" class="md-nav__link">
        Error Detection & Correction (EDAC)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/ptp_tod/ptp_emb_tod/" class="md-nav__link">
        Ethernet 1588 PTP Time of Day Clock
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/emac/emac/" class="md-nav__link">
        Ethernet Media Access Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/hssi/hssi/" class="md-nav__link">
        Ethernet Subsystem FPGA IP MAC Specific Ctrl
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/hssi_xtile/hssi_xtile/" class="md-nav__link">
        Ethernet Subsystem FPGA IP Tile Specific Ctrl
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/apb_timers/apb_timers/" class="md-nav__link">
        General Purpose Timers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/gpio/gpio/" class="md-nav__link">
        General Purpose I/O (GPIO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/i2c/i2c/" class="md-nav__link">
        I2C
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/i3c/i3c/" class="md-nav__link">
        I3C
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/interrupt_controller_GICv3/irq_gic_v3/" class="md-nav__link">
        Interrupt Controller (GICv3)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/msgdma/msgdma/" class="md-nav__link">
        MSGDMA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/nand/nand/" class="md-nav__link">
        NAND Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/qsfp/qsfp/" class="md-nav__link">
        QSFP Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/qspi/qspi/" class="md-nav__link">
        QSPI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/reset_manager/reset_manager/" class="md-nav__link">
        Reset Manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/sd-emmc/sd-emmc/" class="md-nav__link">
        SD/eMMC Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/spi/spi/" class="md-nav__link">
        SPI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/system_manager/system_manager/" class="md-nav__link">
        System Manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/smmu/smmu/" class="md-nav__link">
        System Memory Management Unit
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/uart/uart/" class="md-nav__link">
        UART
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/usb2_0_otg/usb_2_0_otg/" class="md-nav__link">
        USB 2.0 OTG
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/watchdog_timers/watchdog_timers/" class="md-nav__link">
        Watchdog Timers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-embedded/drivers/zarlink_clock_synchronizer/zarlink_clock_synchronizer/" class="md-nav__link">
        Zarlink Clock Synchronizer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
          PCIe Host Drivers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          PCIe Host Drivers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/uart_16550/uart_16550/" class="md-nav__link">
        Altera 16550 Compatible UART
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/dfl_afu/dfl_afu/" class="md-nav__link">
        Accelerator Functional Unit
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/intel_m10_bmc_core/intel_m10_bmc_core/" class="md-nav__link">
        Board Management Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/dfl/dfl/" class="md-nav__link">
        Device Feature List
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/s10hssi/s10hssi/" class="md-nav__link">
        Ethernet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/ptp_dfl_tod/ptp_dfl_tod/" class="md-nav__link">
        Ethernet 1588 PTP Time of Day Clock
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/dfl_fme/dfl_fme/" class="md-nav__link">
        FPGA Management Engine
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/dfl_pci/dfl_pci/" class="md-nav__link">
        PCIe Subsystem
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/dfl_emif/dfl_emif/" class="md-nav__link">
        Memory Interface
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/intel_m10_bmc_core/intel_m10_bmc_core/" class="md-nav__link">
        MAX 10 Board Management Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/spi_altera_dfl/spi_altera_dfl/" class="md-nav__link">
        SPI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../linux-dfl/uio_dfl/uio_dfl/" class="md-nav__link">
        User space I/O (UIO)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../../../driver-list_zephyr/">Zephyr Drivers</a>
          
            <label for="__nav_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Zephyr Drivers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          HPS Zephyr Drivers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          HPS Zephyr Drivers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../zephyr-embedded/clock_manager/clock_manager/" class="md-nav__link">
        Clock Manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../zephyr-embedded/psci/psci/" class="md-nav__link">
        Cold & Warm Reset -Power State Coordination Interface (PSCI)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../zephyr-embedded/dma/dma/" class="md-nav__link">
        DMA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../zephyr-embedded/timer/timer/" class="md-nav__link">
        General Purpose Timer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../zephyr-embedded/gpio/gpio/" class="md-nav__link">
        GPIO
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../zephyr-embedded/qspi/qspi/" class="md-nav__link">
        Quad SPI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../zephyr-embedded/reset_manager/reset_manager/" class="md-nav__link">
        Reset Manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../zephyr-embedded/seu/seu/" class="md-nav__link">
        Single Event Upset (SEU)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../zephyr-embedded/smp/smp/" class="md-nav__link">
        SMP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../zephyr-embedded/uart/uart/" class="md-nav__link">
        UART
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../zephyr-embedded/watchdog/watchdog/" class="md-nav__link">
        Watchdog Timer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Virtualization
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Virtualization
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
          Hypervisors
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Hypervisors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_1" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_1_1" id="__nav_4_1_1_label" tabindex="0">
          Xen
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1_1">
          <span class="md-nav__icon md-icon"></span>
          Xen
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../virtualization/hypervisors/xen/xen-overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_1_2" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_1_1_2" id="__nav_4_1_1_2_label" tabindex="0">
          Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_1_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1_1_2">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../virtualization/hypervisors/xen/ug-xen-agx5e-premium/" class="md-nav__link">
        Agilex™ 5 E-Series Premium Development Kit Xen Hypervisor GSRD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../virtualization/hypervisors/xen/ug-xen-agx5e-modular/" class="md-nav__link">
        Agilex™ 5 E-Series Modular Development Kit Xen Hypervisor GSRD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../virtualization/hypervisors/xen/ug-xen-agx7f-soc/" class="md-nav__link">
        Agilex™ 7 F-Series SoC Development Kit Xen Hypervisor GSRD
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../../../../driver-list_baremetal/">Baremetal Drivers</a>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Baremetal Drivers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Host Attach Utilities
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Host Attach Utilities
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../sw-tools-list/host-attach-tools/" class="md-nav__link">
        Host Attach Utilities Summary
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/fpgaconf/fpgaconf/" class="md-nav__link">
        fpgaconf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/fpgad/fpgad/" class="md-nav__link">
        fpgad
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/fpgainfo/fpgainfo/" class="md-nav__link">
        fpgainfo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/fpgaport/fpgaport/" class="md-nav__link">
        fpgaport
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/fpgasupdate/fpgasupdate/" class="md-nav__link">
        fpgasupdate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/hssi/hssi/" class="md-nav__link">
        hssi
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/host_exerciser/host_exerciser/" class="md-nav__link">
        host_exerciser
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/hssi_ethernet/hssimac/" class="md-nav__link">
        HSSI ethernet loopback
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/hssi_ethernet/hssistats/" class="md-nav__link">
        HSSI ethernet statistics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/hssi_ethernet/hssimac/" class="md-nav__link">
        HSSI ethernet mac
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/mem_tg/mem_tg/" class="md-nav__link">
        mem_tg
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/mmlink/mmlink/" class="md-nav__link">
        mmlink
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/ofs_uio/ofs_uio/" class="md-nav__link">
        ofs.uio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/opae_io/opae_io/" class="md-nav__link">
        opae.io
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/opaeuio/opaeuio/" class="md-nav__link">
        opaeuio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/opaevfio/opaevfio/" class="md-nav__link">
        opaevfio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/pac_hssi_config/pac_hssi_config/" class="md-nav__link">
        pac_hssi_config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/packager/packager/" class="md-nav__link">
        packager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/pci_device/pci_device/" class="md-nav__link">
        pci_device
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/rsu/rsu/" class="md-nav__link">
        rsu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/userclk/userclk/" class="md-nav__link">
        userclk
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../host-attach-util/vabtool/vabtool/" class="md-nav__link">
        vabtool
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Example Designs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Example Designs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../ed-demo-list/ed-list/" class="md-nav__link">
        Summary
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
          Agilex™ 3
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_2">
          <span class="md-nav__icon md-icon"></span>
          Agilex™ 3
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2_1" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_2_1" id="__nav_7_2_1_label" tabindex="0">
          C-Series SoC and FPGA Development Kit
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_2_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_2_1">
          <span class="md-nav__icon md-icon"></span>
          C-Series SoC and FPGA Development Kit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../modular/drive-on-chip/doc-plc/" class="md-nav__link">
        Drive-On-Chip with PLC Design Example for Agilex™ Devices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-3/c-series/gsrd/ug-gsrd-agx3/" class="md-nav__link">
        HPS GSRD User Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" checked>
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
          Agilex™ 5
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_7_3">
          <span class="md-nav__icon md-icon"></span>
          Agilex™ 5
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3_1" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_3_1" id="__nav_7_3_1_label" tabindex="0">
          E-Series Premium Development Kit
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_3_1_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_7_3_1">
          <span class="md-nav__icon md-icon"></span>
          E-Series Premium Development Kit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../gsrd/ug-gsrd-agx5e-premium/" class="md-nav__link">
        HPS GSRD User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../egsrd/ug-ehps-agx5e-premium/" class="md-nav__link">
        Enhanced HPS User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../gsrd_zephyr/ug-zgsrd-agx5e-premium/" class="md-nav__link">
        HPS Zephyr GSRD User Guide
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          HPS GHRD Linux Boot Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        HPS GHRD Linux Boot Examples
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#component-versions" class="md-nav__link">
    Component Versions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#development-kit" class="md-nav__link">
    Development Kit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#release-notes" class="md-nav__link">
    Release Notes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hps-enablement-board" class="md-nav__link">
    HPS Enablement Board
  </a>
  
    <nav class="md-nav" aria-label="HPS Enablement Board">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#boot-from-sd-card" class="md-nav__link">
    Boot from SD Card
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-from-qspi" class="md-nav__link">
    Boot from QSPI
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hps-nand-board" class="md-nav__link">
    HPS NAND Board
  </a>
  
    <nav class="md-nav" aria-label="HPS NAND Board">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#boot-from-emmc" class="md-nav__link">
    Boot from eMMC
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hps-test-board" class="md-nav__link">
    HPS Test Board
  </a>
  
    <nav class="md-nav" aria-label="HPS Test Board">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#boot-from-sd-card_1" class="md-nav__link">
    Boot from SD Card
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#direct-atf-to-linux-boot-on-hps-enablement-board" class="md-nav__link">
    Direct ATF to Linux Boot on HPS Enablement Board
  </a>
  
    <nav class="md-nav" aria-label="Direct ATF to Linux Boot on HPS Enablement Board">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#boot-from-sd-card_2" class="md-nav__link">
    Boot from SD Card
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-from-qspi_1" class="md-nav__link">
    Boot from QSPI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-from-emmc_1" class="md-nav__link">
    Boot from eMMC
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notices-disclaimers" class="md-nav__link">
    Notices &amp; Disclaimers
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3_1_5" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_3_1_5" id="__nav_7_3_1_5_label" tabindex="0">
          TSN Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_7_3_1_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_3_1_5">
          <span class="md-nav__icon md-icon"></span>
          TSN Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tsn/rgmii-hps/ug-tsncfg1-agx5e-premium/" class="md-nav__link">
        TSN - HPS RGMII System
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tsn/rgmii-hvio/ug-tsncfg2-agx5e-premium/" class="md-nav__link">
        TSN - RGMII HVIO System
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tsn/sgmii_xcvr/ug-tsn-sgmii-xcvr-agilex5/" class="md-nav__link">
        TSN - SGMII XCVR System
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../remote-debug/ug-remote-debug-agx5e-premium/" class="md-nav__link">
        SoC FPGA Remote Debug Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rsu/ug-rsu-agx5e-soc/" class="md-nav__link">
        HPS Remote System Update Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../xen/ug-xen-agx5e-premium/" class="md-nav__link">
        HPS Xen Hypervisor GSRD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pcie_rp/ug-pcie_rp-agx5e-premium/" class="md-nav__link">
        PCIe Root Port
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3_1_10" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_3_1_10" id="__nav_7_3_1_10_label" tabindex="0">
          Nios V Processor Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_7_3_1_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_3_1_10">
          <span class="md-nav__icon md-icon"></span>
          Nios V Processor Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3_1_10_1" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_3_1_10_1" id="__nav_7_3_1_10_1_label" tabindex="0">
          Nios V/c
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_7_3_1_10_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_3_1_10_1">
          <span class="md-nav__icon md-icon"></span>
          Nios V/c
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../niosv/niosv_c/niosv_c_helloworld_ocm_mem_test/ug-helloworld-ocm-mem-test-agx5e-premium/" class="md-nav__link">
        Helloworld and OCM memory test design on Nios® V/c Processor
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3_1_10_2" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_3_1_10_2" id="__nav_7_3_1_10_2_label" tabindex="0">
          Nios V/m
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_7_3_1_10_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_3_1_10_2">
          <span class="md-nav__icon md-icon"></span>
          Nios V/m
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../niosv/niosv_m/niosv_m_baseline_ghrd/ug-baseline-ghrd-agx5e-premium/" class="md-nav__link">
        Nios® V/m Processor Baseline GHRD Design
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3_1_10_3" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_3_1_10_3" id="__nav_7_3_1_10_3_label" tabindex="0">
          Nios V/g
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_7_3_1_10_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_3_1_10_3">
          <span class="md-nav__icon md-icon"></span>
          Nios V/g
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../niosv/niosv_g/tinyml_liteRT/ug-tinyml-liteRT-agx5e-premium/" class="md-nav__link">
        Nios® V/g TinyML LiteRT for Microcontroller Design
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../baremetal-embedded/agilex-5/e-series/premium/ug-baremetal-agx5e-premium/" class="md-nav__link">
        Baremetal Hello World Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/altera-fpga/agilex5-demo-hps2fpga-interfaces/blob/main/documentation/01_index.md" class="md-nav__link">
        Third Party Boards - HPS-FPGA Interfaces Demos User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../demos/agilex-5/e-series/premium/armds-debug-uboot/ug-armds-debug-uboot-agx5e-premium/" class="md-nav__link">
        Debugging U-Boot with Arm Development Studio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../demos/agilex-5/e-series/premium/riscfree-debug-u-boot/ug-riscfree-debug-uboot-agx5e-premium/" class="md-nav__link">
        Debugging U-Boot with Ashling RiscFree
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../demos/agilex-5/e-series/premium/riscfree-debug-linux/ug-riscfree-debug-linux-agx5e-premium/" class="md-nav__link">
        Debugging Linux with Ashling RiscFree
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../demos/agilex-5/e-series/premium/armds-debug-linux/ug-armds-debug-linux-agx5e-premium/" class="md-nav__link">
        Debugging Linux with Arm Development Studio
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_3_2" id="__nav_7_3_2_label" tabindex="0">
          E-Series Modular Development Kit
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_3_2">
          <span class="md-nav__icon md-icon"></span>
          E-Series Modular Development Kit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../ed-ai-suite/agilex5/modular_jtag/modular_jtag/" class="md-nav__link">
        Hostless JTAG Example Design
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../modular/gsrd/ug-gsrd-agx5e-modular/" class="md-nav__link">
        HPS GSRD User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../modular/boot-examples/ug-linux-boot-agx5e-modular/" class="md-nav__link">
        HPS GHRD Linux Boot Examples
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../modular/xen/ug-xen-agx5e-modular/" class="md-nav__link">
        HPS Xen Hypervisor GSRD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../modular/drive-on-chip/doc-funct-safety/" class="md-nav__link">
        Drive-On-Chip with Functional Safety Design Example for Agilex™ 5 Devices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../modular/drive-on-chip/doc-plc/" class="md-nav__link">
        Drive-On-Chip with PLC Design Example for Agilex™ Devices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../modular/drive-on-chip/doc-crc/" class="md-nav__link">
        ROS Consolidated Robot Controller Example Design for Agilex™ 5 Devices
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3_3" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_3_3" id="__nav_7_3_3_label" tabindex="0">
          Intel Simics Virtual Platform Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_3_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_3_3">
          <span class="md-nav__icon md-icon"></span>
          Intel Simics Virtual Platform Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/virtual-platforms/linux-gsrd/ug-linux-gsrd-agilex5-virtual-platforms/" class="md-nav__link">
        Simics Linux GSRD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../common/virtual-platforms/zephyr-gsrd/ug-zephyr-gsrd-agilex5-virtual-platforms/" class="md-nav__link">
        Simics Zephyr GSRD
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_4" id="__nav_7_4_label" tabindex="0">
          Agilex™ 7
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_4">
          <span class="md-nav__icon md-icon"></span>
          Agilex™ 7
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4_1" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_4_1" id="__nav_7_4_1_label" tabindex="0">
          F-Series SoC Development Kit (P-Tiles & E-Tile)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_4_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_4_1">
          <span class="md-nav__icon md-icon"></span>
          F-Series SoC Development Kit (P-Tiles & E-Tile)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/f-series/soc/gsrd/ug-gsrd-agx7f-soc/" class="md-nav__link">
        HPS GSRD User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/f-series/soc/rsu/ug-rsu-agx7f-soc/" class="md-nav__link">
        HPS Remote System Update Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/f-series/soc/rsu/ug-rsu-multiqspi-agx7f-soc/" class="md-nav__link">
        HPS Multi-QSPI Remote System Update Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/f-series/soc/remote-debug/ug-remote-debug-agx7f-soc/" class="md-nav__link">
        SoC FPGA Remote Debug Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/f-series/soc/emmc/ug-emmc-agx7f-soc/" class="md-nav__link">
        HPS eMMC Boot Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/f-series/soc/fabric-config/ug-linux-fabric-config-agx7f-soc/" class="md-nav__link">
        SoC Fabric Configuration from Linux Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/f-series/soc/boot-examples/ug-linux-boot-agx7-soc/" class="md-nav__link">
        HPS GHRD Linux Boot Examples
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/f-series/soc/xen/ug-xen-agx7f-soc/" class="md-nav__link">
        HPS Xen Hypervisor GSRD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/f-series/soc/setup-use-bridges/ug-setup-use-bridges-agx7f-soc/" class="md-nav__link">
        Setting up and Using Bridges HPS Linux Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4_1_10" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_4_1_10" id="__nav_7_4_1_10_label" tabindex="0">
          Nios V Processor Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_7_4_1_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_4_1_10">
          <span class="md-nav__icon md-icon"></span>
          Nios V Processor Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4_1_10_1" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_4_1_10_1" id="__nav_7_4_1_10_1_label" tabindex="0">
          Nios V/g
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_7_4_1_10_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_4_1_10_1">
          <span class="md-nav__icon md-icon"></span>
          Nios V/g
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/f-series/soc/niosv/niosv_g/fpu_test/ug-fpu-agx7f-fpga/" class="md-nav__link">
        Nios® V/g Processor Floating Point Unit (FPU) Design
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4_2" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_4_2" id="__nav_7_4_2_label" tabindex="0">
          F-Series FPGA Development Kit (2x F-Tile)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_4_2">
          <span class="md-nav__icon md-icon"></span>
          F-Series FPGA Development Kit (2x F-Tile)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/f-series/fpga/gsrd/ug-gsrd-agx7f-fpga/" class="md-nav__link">
        HPS GSRD User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4_2_2" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_4_2_2" id="__nav_7_4_2_2_label" tabindex="0">
          Nios V Processor Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_7_4_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_4_2_2">
          <span class="md-nav__icon md-icon"></span>
          Nios V Processor Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4_2_2_1" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_4_2_2_1" id="__nav_7_4_2_2_1_label" tabindex="0">
          Nios V/g
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_7_4_2_2_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_4_2_2_1">
          <span class="md-nav__icon md-icon"></span>
          Nios V/g
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/f-series/fpga/niosv/niosv_g/tinyml_liteRT/ug-tinyml-litert-agx7f-fpga/" class="md-nav__link">
        Nios® V/g TinyML LiteRT for Microcontroller Design
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4_3" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_4_3" id="__nav_7_4_3_label" tabindex="0">
          I-Series FPGA Development Kit
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_4_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_4_3">
          <span class="md-nav__icon md-icon"></span>
          I-Series FPGA Development Kit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../ed-ai-suite/agilex7/iseries_ofs_pcie/iseries_ofs_pcie/" class="md-nav__link">
        Agilex 7 PCIe-Attached Example Design with OFS (I-Series, 2x R-Tile and 1x F-Tile)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/i-series/soc/gsrd/ug-gsrd-agx7i-soc/" class="md-nav__link">
        HPS GSRD User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex7/i-series/avst-cii/agilex7-ed-pcie-cii.md" class="md-nav__link">
        CII Example Design
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4_4" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_4_4" id="__nav_7_4_4_label" tabindex="0">
          M-Series HBM2e Development Kit (3x F-Tile & 1x R-Tile)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_4_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_4_4">
          <span class="md-nav__icon md-icon"></span>
          M-Series HBM2e Development Kit (3x F-Tile & 1x R-Tile)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/m-series/hbm2e/ug-gsrd-agx7m-hbm2e/" class="md-nav__link">
        HPS GSRD User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../agilex-7/m-series/pcie_rp/ug-pcie_rp-agx7m-hbm2e/" class="md-nav__link">
        PCIe Root Port User Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4_5" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_4_5" id="__nav_7_4_5_label" tabindex="0">
          DE10-Agilex Terasic
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_4_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_4_5">
          <span class="md-nav__icon md-icon"></span>
          DE10-Agilex Terasic
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../ed-ai-suite/agilex7/de10_pcie/de10_pcie/" class="md-nav__link">
        Agilex 7 PCIe-Attached Example Design (DE10)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4_6" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_4_6" id="__nav_7_4_6_label" tabindex="0">
          FPGA SmartNIC N6001-PL Platform
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_4_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_4_6">
          <span class="md-nav__icon md-icon"></span>
          FPGA SmartNIC N6001-PL Platform
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../ed-ai-suite/agilex7/n6001_ofs_pcie/n6001_ofs_pcie/" class="md-nav__link">
        Agilex 7 PCIe-Attached Example Design with OFS (N6001)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
          Stratix® 10
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_5">
          <span class="md-nav__icon md-icon"></span>
          Stratix® 10
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5_1" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_5_1" id="__nav_7_5_1_label" tabindex="0">
          SX SoC Development Kit
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_5_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_5_1">
          <span class="md-nav__icon md-icon"></span>
          SX SoC Development Kit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../stratix-10/sx/soc/gsrd/ug-gsrd-s10sx-soc/" class="md-nav__link">
        HPS GSRD User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../stratix-10/sx/soc/rsu/ug-rsu-s10sx-soc/" class="md-nav__link">
        HPS Remote System Update Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../stratix-10/sx/soc/remote-debug/ug-remote-debug-s10sx-soc/" class="md-nav__link">
        SoC FPGA Remote Debug Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../stratix-10/sx/soc/emmc/ug-emmc-s10sx-soc/" class="md-nav__link">
        HPS eMMC Boot Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../stratix-10/sx/soc/fabric-config/ug-linux-fabric-config-s10sx-soc/" class="md-nav__link">
        SoC Fabric Configuration from Linux Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../stratix-10/sx/soc/boot-examples/ug-linux-boot-s10-soc/" class="md-nav__link">
        HPS GHRD Linux Boot Examples
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_6" id="__nav_7_6_label" tabindex="0">
          Arria® 10
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_6">
          <span class="md-nav__icon md-icon"></span>
          Arria® 10
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6_1" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_6_1" id="__nav_7_6_1_label" tabindex="0">
          SX SoC Development Kit
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_6_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_6_1">
          <span class="md-nav__icon md-icon"></span>
          SX SoC Development Kit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../arria-10/sx/soc/gsrd/ug-gsrd-a10sx-soc/" class="md-nav__link">
        GSRD User Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_7" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_7" id="__nav_7_7_label" tabindex="0">
          Cyclone® V
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_7">
          <span class="md-nav__icon md-icon"></span>
          Cyclone® V
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_7_1" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7_7_1" id="__nav_7_7_1_label" tabindex="0">
          SX SoC Development Kit
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_7_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_7_1">
          <span class="md-nav__icon md-icon"></span>
          SX SoC Development Kit
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../cyclone-v/sx/soc/gsrd/ug-gsrd-cve-soc/" class="md-nav__link">
        GSRD User Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../cyclone-v/sx/soc/boot-examples/ug-linux-boot-cve-soc/" class="md-nav__link">
        HPS GHRD Linux Boot Examples
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#component-versions" class="md-nav__link">
    Component Versions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#development-kit" class="md-nav__link">
    Development Kit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#release-notes" class="md-nav__link">
    Release Notes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hps-enablement-board" class="md-nav__link">
    HPS Enablement Board
  </a>
  
    <nav class="md-nav" aria-label="HPS Enablement Board">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#boot-from-sd-card" class="md-nav__link">
    Boot from SD Card
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-from-qspi" class="md-nav__link">
    Boot from QSPI
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hps-nand-board" class="md-nav__link">
    HPS NAND Board
  </a>
  
    <nav class="md-nav" aria-label="HPS NAND Board">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#boot-from-emmc" class="md-nav__link">
    Boot from eMMC
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hps-test-board" class="md-nav__link">
    HPS Test Board
  </a>
  
    <nav class="md-nav" aria-label="HPS Test Board">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#boot-from-sd-card_1" class="md-nav__link">
    Boot from SD Card
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#direct-atf-to-linux-boot-on-hps-enablement-board" class="md-nav__link">
    Direct ATF to Linux Boot on HPS Enablement Board
  </a>
  
    <nav class="md-nav" aria-label="Direct ATF to Linux Boot on HPS Enablement Board">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#boot-from-sd-card_2" class="md-nav__link">
    Boot from SD Card
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-from-qspi_1" class="md-nav__link">
    Boot from QSPI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boot-from-emmc_1" class="md-nav__link">
    Boot from eMMC
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notices-disclaimers" class="md-nav__link">
    Notices &amp; Disclaimers
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="hps-ghrd-linux-boot-examples-for-the-agilextm-5-e-series-premium-dev-kit">HPS GHRD Linux Boot Examples for the Agilex™ 5 E-Series Premium Dev Kit<a class="headerlink" href="#hps-ghrd-linux-boot-examples-for-the-agilextm-5-e-series-premium-dev-kit" title="Permanent link">&para;</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<h3 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h3>
<p>This page contains instructions on how to build Linux systems from separate components: Hardware Design, U-Boot, Arm Trusted Firmware, Linux kernel and device tree, Linux root filesystem. This is different from the Golden System Reference Design, where all the software is built through Yocto. While the instructions use Yocto for building the root file system, alternatives could be used there, such as the buildroot utility for example.</p>
<p>The key differences versus the GSRD are:</p>
<ul>
<li>Fabric is configured from U-Boot directly with the rbf file, with <code>fpga load</code> command, instead of using the <code>bootm</code> command with the core.rbf part of the kernel.itb file</li>
<li>Single image boot is disabled in U-Boot, and it boots directly with the slected boot source, not trying them all</li>
<li>The applications and drivers form <code>meta-intel-fpga-refdes</code> are not included. That includes acessing GPIOs in the fabric for LEDs, pushbuttons, dip switches, the webserver running on the board, etc.</li>
</ul>
<p>The following scenarios are covered:</p>
<ul>
<li>HPS Enablement Board: boot from SD card, and boot from QSPI</li>
<li>HPS NAND Board: boot from eMMC flash</li>
<li>HPS Test Board: boot from SD card</li>
</ul>
<p>The instructions on this page are based on the <a href="https://altera-fpga.github.io/rel-25.1.1/embedded-designs/agilex-5/e-series/premium/gsrd/ug-gsrd-agx5e-premium/">GSRD</a>.</p>
<h3 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h3>
<p>The following are required to be able to fully exercise the guides from this page:</p>
<ul>
<li><a href="https://www.intel.com/content/www/us/en/products/details/fpga/development-kits/agilex/a5e065b-premium.html">Altera&reg; Agilex&trade; 5 FPGA E-Series 065B Premium Development Kit</a>, ordering code DK-A5E065BB32AES1.<ul>
<li>HPS Enablement  Expansion Board. Included with the development kit</li>
<li>HPS NAND Board. Enables eMMC storage for HPS. Orderable separately</li>
<li>HPS Test Board. Supports SD card boot, and external Arm tracing. Orderable separately</li>
<li>Mini USB Cable. Included with the development kit</li>
<li>Micro USB Cable. Included with the development kit</li>
<li>Ethernet Cable. Included with the development kit</li>
<li>Micro SD card and USB card writer. Included with the development kit</li>
</ul>
</li>
<li>Host PC with<ul>
<li>64 GB of RAM or more</li>
<li>Linux OS installed. Ubuntu 22.04LTS was used to create this page, other versions and distributions may work too</li>
<li>Serial terminal (for example GtkTerm or Minicom on Linux and TeraTerm or PuTTY on Windows)</li>
<li>Altera&reg; Quartus<sup>&reg;</sup> Prime Pro Edition Version 25.1.1 </li>
<li>TFTP server. This used to download the eMMC binaries to board to be flashed by U-Boot</li>
</ul>
</li>
<li>Local Ethernet network, with DHCP server</li>
<li>Internet connection. For downloading the files.</li>
</ul>
<h3 id="component-versions">Component Versions<a class="headerlink" href="#component-versions" title="Permanent link">&para;</a></h3>
<p>Altera&reg; Quartus<sup>&reg;</sup> Prime Pro Edition Version 25.1.1 and the following software component versions are used to build the binaries presented in this page:</p>
<table>
<thead>
<tr>
<th align="left">Component</th>
<th align="left">Location</th>
<th align="left">Branch</th>
<th align="left">Commit ID/Tag</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Agilex 3 GHRD</td>
<td align="left"><a href="https://github.com/altera-fpga/agilex3c-ed-gsrd">https://github.com/altera-fpga/agilex3c-ed-gsrd</a></td>
<td align="left">main</td>
<td align="left">QPDS25.1.1_REL_GSRD_PR</td>
</tr>
<tr>
<td align="left">Agilex 5 GHRD</td>
<td align="left"><a href="https://github.com/altera-fpga/agilex5e-ed-gsrd">https://github.com/altera-fpga/agilex5e-ed-gsrd</a></td>
<td align="left">main</td>
<td align="left">QPDS25.1.1_REL_GSRD_PR</td>
</tr>
<tr>
<td align="left">Agilex 7 GHRD</td>
<td align="left"><a href="https://github.com/altera-fpga/agilex7f-ed-gsrd">https://github.com/altera-fpga/agilex7f-ed-gsrd</a></td>
<td align="left">main</td>
<td align="left">QPDS25.1.1_REL_GSRD_PR</td>
</tr>
<tr>
<td align="left">Stratix 10 GHRD</td>
<td align="left"><a href="https://github.com/altera-fpga/stratix10-ed-gsrd">https://github.com/altera-fpga/stratix10-ed-gsrd</a></td>
<td align="left">main</td>
<td align="left">QPDS25.1.1_REL_GSRD_PR</td>
</tr>
<tr>
<td align="left">Linux</td>
<td align="left"><a href="https://github.com/altera-fpga/linux-socfpga">https://github.com/altera-fpga/linux-socfpga</a></td>
<td align="left">socfpga-6.12.19-lts</td>
<td align="left">QPDS25.1.1_REL_GSRD_PR</td>
</tr>
<tr>
<td align="left">Arm Trusted Firmware</td>
<td align="left"><a href="https://github.com/altera-fpga/arm-trusted-firmware">https://github.com/altera-fpga/arm-trusted-firmware</a></td>
<td align="left">socfpga_v2.12.1</td>
<td align="left">QPDS25.1.1_REL_GSRD_PR</td>
</tr>
<tr>
<td align="left">U-Boot</td>
<td align="left"><a href="https://github.com/altera-fpga/u-boot-socfpga">https://github.com/altera-fpga/u-boot-socfpga</a></td>
<td align="left">socfpga_v2025.04</td>
<td align="left">QPDS25.1.1_REL_GSRD_PR</td>
</tr>
<tr>
<td align="left">Yocto Project</td>
<td align="left"><a href="https://git.yoctoproject.org/poky">https://git.yoctoproject.org/poky</a></td>
<td align="left">walnascar</td>
<td align="left">latest</td>
</tr>
<tr>
<td align="left">Yocto Project: meta-intel-fpga</td>
<td align="left"><a href="https://git.yoctoproject.org/meta-intel-fpga">https://git.yoctoproject.org/meta-intel-fpga</a></td>
<td align="left">walnascar</td>
<td align="left">latest</td>
</tr>
<tr>
<td align="left">Yocto Project: meta-intel-fpga-refdes</td>
<td align="left"><a href="https://github.com/altera-fpga/meta-intel-fpga-refdes">https://github.com/altera-fpga/meta-intel-fpga-refdes</a></td>
<td align="left">walnascar</td>
<td align="left">QPDS25.1.1_REL_GSRD_PR</td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> The combination of the component versions indicated in the table above has been validated through the use cases described in this page and it is strongly recommended to use these versions together. If you decided to use any component with different version than the indicated, there is not warranty that this will work.</p>
<h3 id="development-kit">Development Kit<a class="headerlink" href="#development-kit" title="Permanent link">&para;</a></h3>
<p>Refer to <a href="https://altera-fpga.github.io/rel-25.1.1/embedded-designs/agilex-5/e-series/premium/gsrd/ug-gsrd-agx5e-premium/#development-kit">Development Kit</a> for details about the board, including how to install the HPS Boards, and how to set MSEL dispswitches.</p>
<h3 id="release-notes">Release Notes<a class="headerlink" href="#release-notes" title="Permanent link">&para;</a></h3>
<p>Refer to <a href="https://altera-fpga.github.io/rel-25.1.1/embedded-designs/agilex-5/e-series/premium/gsrd/ug-gsrd-agx5e-premium/#release-contents">Release Notes</a> for release readiness information and known issues.</p>
<h2 id="hps-enablement-board">HPS Enablement Board<a class="headerlink" href="#hps-enablement-board" title="Permanent link">&para;</a></h2>
<p>This section demonstrates how to build a Linux system from separate components, targetting the HPS Enablement Board. Both booting from SD card and booting from QSPI are covered.</p>
<h3 id="boot-from-sd-card">Boot from SD Card<a class="headerlink" href="#boot-from-sd-card" title="Permanent link">&para;</a></h3>
<h4>Setup Environment</h4>

<p>1. Create the top folder to store all the build artifacts:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>sudo<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>agilex5_boot.enablement
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>mkdir<span class="w"> </span>agilex5_boot.enablement
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="nb">cd</span><span class="w"> </span>agilex5_boot.enablement
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="nb">export</span><span class="w"> </span><span class="nv">TOP_FOLDER</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
</code></pre></div>
<p>Download the compiler toolchain, add it to the PATH variable, to be used by the GHRD makefile to build the HPS Debug FSBL:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>wget<span class="w"> </span>https://developer.arm.com/-/media/Files/downloads/gnu/14.3.rel1/binrel/<span class="se">\</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>arm-gnu-toolchain-14.3.rel1-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>tar<span class="w"> </span>xf<span class="w"> </span>arm-gnu-toolchain-14.3.rel1-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>rm<span class="w"> </span>-f<span class="w"> </span>arm-gnu-toolchain-14.3.rel1-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>/arm-gnu-toolchain-14.3.rel1-x86_64-aarch64-none-linux-gnu/bin/:<span class="nv">$PATH</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="nb">export</span><span class="w"> </span><span class="nv">ARCH</span><span class="o">=</span>arm64
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="nb">export</span><span class="w"> </span><span class="nv">CROSS_COMPILE</span><span class="o">=</span>aarch64-none-linux-gnu-
</code></pre></div>
<p>Enable Quartus tools to be called from command line:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_ROOTDIR</span><span class="o">=</span>~/altera_pro/25.1.1/quartus/
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>/bin:<span class="nv">$QUARTUS_ROOTDIR</span>/linux64:<span class="nv">$QUARTUS_ROOTDIR</span>/../qsys/bin:<span class="nv">$PATH</span>
</code></pre></div>
<h4>Build Hardware Design</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>agilex5_soc_devkit_ghrd<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>agilex5_soc_devkit_ghrd<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>agilex5_soc_devkit_ghrd
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>wget<span class="w"> </span>https://github.com/altera-fpga/agilex5e-ed-gsrd/releases/download/QPDS25.1.1_REL_GSRD_PR/a5ed065es-premium-devkit-oobe-legacy-baseline.zip
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>unzip<span class="w"> </span>a5ed065es-premium-devkit-oobe-legacy-baseline.zip
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>rm<span class="w"> </span>-f<span class="w"> </span>a5ed065es-premium-devkit-oobe-legacy-baseline.zip
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>make<span class="w"> </span>legacy_baseline-build
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>make<span class="w"> </span>legacy_baseline-sw-build
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>output_files/legacy_baseline.sof<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">  </span>output_files/legacy_baseline_hps_debug.sof<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="w">  </span>-o<span class="w"> </span><span class="nv">hps_path</span><span class="o">=</span>software/hps_debug/hps_wipe.ihex
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<p>The following files are created:</p>
<ul>
<li><code>$TOP_FOLDER/agilex5_soc_devkit_ghrd/output_files/legacy_baseline.sof</code></li>
<li><code>$TOP_FOLDER/agilex5_soc_devkit_ghrd/output_files/legacy_baseline_hps_debug.sof</code></li>
</ul>
<h4>Build Arm Trusted Firmware</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>arm-trusted-firmware
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS25.1.1_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-fpga/arm-trusted-firmware
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="nb">cd</span><span class="w"> </span>arm-trusted-firmware
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>make<span class="w"> </span>-j<span class="w"> </span><span class="m">48</span><span class="w"> </span><span class="nv">PLAT</span><span class="o">=</span>agilex5<span class="w"> </span>bl31<span class="w"> </span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li><code>$TOP_FOLDER/arm-trusted-firmware/build/agilex5/release/bl31.bin</code></li>
</ul>
<h4>Build U-Boot</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>u-boot-socfpga
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS25.1.1_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-fpga/u-boot-socfpga
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="nb">cd</span><span class="w"> </span>u-boot-socfpga<span class="w"> </span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="c1"># enable dwarf4 debug info, for compatibility with arm ds</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/PLATFORM_CPPFLAGS += -D__ARM__/PLATFORM_CPPFLAGS += -D__ARM__ -gdwarf-4/g&#39;</span><span class="w"> </span>arch/arm/config.mk
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="c1"># only boot from SD, do not try QSPI and NAND</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/u-boot,spl-boot-order.*/u-boot\,spl-boot-order = \&amp;mmc;/g&#39;</span><span class="w"> </span>arch/arm/dts/socfpga_agilex5_socdk-u-boot.dtsi
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="c1"># disable NAND in the device tree</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;/&amp;nand {/!b;n;c\\tstatus = &quot;disabled&quot;;&#39;</span><span class="w"> </span>arch/arm/dts/socfpga_agilex5_socdk-u-boot.dtsi
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="c1"># link to atf</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>ln<span class="w"> </span>-s<span class="w"> </span>../arm-trusted-firmware/build/agilex5/release/bl31.bin<span class="w"> </span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="c1"># create configuration custom file. </span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>cat<span class="w"> </span><span class="s">&lt;&lt; EOF &gt; config-fragment</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="s"># use Image instead of kernel.itb</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="s">CONFIG_BOOTFILE=&quot;Image&quot;</span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="s"># disable NAND/UBI related settings from defconfig. </span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="s">CONFIG_NAND_BOOT=n</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="s">CONFIG_SPL_NAND_SUPPORT=n</span>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="s">CONFIG_CMD_NAND_TRIMFFS=n</span>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a><span class="s">CONFIG_CMD_NAND_LOCK_UNLOCK=n</span>
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a><span class="s">CONFIG_NAND_DENALI_DT=n</span>
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a><span class="s">CONFIG_SYS_NAND_U_BOOT_LOCATIONS=n</span>
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a><span class="s">CONFIG_SPL_NAND_FRAMEWORK=n</span>
<a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a><span class="s">CONFIG_CMD_NAND=n</span>
<a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a><span class="s">CONFIG_MTD_RAW_NAND=n</span>
<a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a><span class="s">CONFIG_CMD_UBI=n</span>
<a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a><span class="s">CONFIG_CMD_UBIFS=n</span>
<a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a><span class="s">CONFIG_MTD_UBI=n</span>
<a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a><span class="s">CONFIG_ENV_IS_IN_UBI=n</span>
<a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a><span class="s">CONFIG_UBI_SILENCE_MSG=n</span>
<a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a><span class="s">CONFIG_UBIFS_SILENCE_MSG=n</span>
<a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a><span class="s"># disable distroboot and use specific boot command. </span>
<a id="__codelineno-5-34" name="__codelineno-5-34" href="#__codelineno-5-34"></a><span class="s">CONFIG_DISTRO_DEFAULTS=n</span>
<a id="__codelineno-5-35" name="__codelineno-5-35" href="#__codelineno-5-35"></a><span class="s">CONFIG_HUSH_PARSER=y</span>
<a id="__codelineno-5-36" name="__codelineno-5-36" href="#__codelineno-5-36"></a><span class="s">CONFIG_SYS_PROMPT_HUSH_PS2=&quot;&gt; &quot;</span>
<a id="__codelineno-5-37" name="__codelineno-5-37" href="#__codelineno-5-37"></a><span class="s">CONFIG_USE_BOOTCOMMAND=y</span>
<a id="__codelineno-5-38" name="__codelineno-5-38" href="#__codelineno-5-38"></a><span class="s">CONFIG_BOOTCOMMAND=&quot;load mmc 0:1 \${loadaddr} ghrd.core.rbf; fpga load 0 \${loadaddr} \${filesize};bridge enable; mmc rescan; fatload mmc 0:1 82000000 Image;fatload mmc 0:1 86000000 socfpga_agilex5_socdk.dtb;setenv bootargs console=ttyS0,115200 root=\${mmcroot} rw rootwait;booti 0x82000000 - 0x86000000&quot;</span>
<a id="__codelineno-5-39" name="__codelineno-5-39" href="#__codelineno-5-39"></a><span class="s">CONFIG_CMD_FAT=y</span>
<a id="__codelineno-5-40" name="__codelineno-5-40" href="#__codelineno-5-40"></a><span class="s">CONFIG_CMD_FS_GENERIC=y</span>
<a id="__codelineno-5-41" name="__codelineno-5-41" href="#__codelineno-5-41"></a><span class="s">CONFIG_DOS_PARTITION=y</span>
<a id="__codelineno-5-42" name="__codelineno-5-42" href="#__codelineno-5-42"></a><span class="s">CONFIG_SPL_DOS_PARTITION=y</span>
<a id="__codelineno-5-43" name="__codelineno-5-43" href="#__codelineno-5-43"></a><span class="s">CONFIG_CMD_PART=y</span>
<a id="__codelineno-5-44" name="__codelineno-5-44" href="#__codelineno-5-44"></a><span class="s">CONFIG_SPL_CRC32=y</span>
<a id="__codelineno-5-45" name="__codelineno-5-45" href="#__codelineno-5-45"></a><span class="s">CONFIG_LZO=y</span>
<a id="__codelineno-5-46" name="__codelineno-5-46" href="#__codelineno-5-46"></a><span class="s">CONFIG_CMD_DHCP=y</span>
<a id="__codelineno-5-47" name="__codelineno-5-47" href="#__codelineno-5-47"></a><span class="s"># enable more QSPI flash manufacturers</span>
<a id="__codelineno-5-48" name="__codelineno-5-48" href="#__codelineno-5-48"></a><span class="s">CONFIG_SPI_FLASH_MACRONIX=y</span>
<a id="__codelineno-5-49" name="__codelineno-5-49" href="#__codelineno-5-49"></a><span class="s">CONFIG_SPI_FLASH_GIGADEVICE=y</span>
<a id="__codelineno-5-50" name="__codelineno-5-50" href="#__codelineno-5-50"></a><span class="s">CONFIG_SPI_FLASH_WINBOND=y</span>
<a id="__codelineno-5-51" name="__codelineno-5-51" href="#__codelineno-5-51"></a><span class="s">CONFIG_SPI_FLASH_ISSI=y</span>
<a id="__codelineno-5-52" name="__codelineno-5-52" href="#__codelineno-5-52"></a><span class="s">EOF</span>
<a id="__codelineno-5-53" name="__codelineno-5-53" href="#__codelineno-5-53"></a><span class="c1"># build U-Boot</span>
<a id="__codelineno-5-54" name="__codelineno-5-54" href="#__codelineno-5-54"></a>make<span class="w"> </span>clean<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>make<span class="w"> </span>mrproper
<a id="__codelineno-5-55" name="__codelineno-5-55" href="#__codelineno-5-55"></a>make<span class="w"> </span>socfpga_agilex5_defconfig<span class="w"> </span>
<a id="__codelineno-5-56" name="__codelineno-5-56" href="#__codelineno-5-56"></a><span class="c1"># use created custom configuration file to merge with the default configuration obtained in .config file. </span>
<a id="__codelineno-5-57" name="__codelineno-5-57" href="#__codelineno-5-57"></a>./scripts/kconfig/merge_config.sh<span class="w"> </span>-O<span class="w"> </span>.<span class="w"> </span>-m<span class="w"> </span>.config<span class="w"> </span>config-fragment
<a id="__codelineno-5-58" name="__codelineno-5-58" href="#__codelineno-5-58"></a>make<span class="w"> </span>-j<span class="w"> </span><span class="m">64</span>
<a id="__codelineno-5-59" name="__codelineno-5-59" href="#__codelineno-5-59"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<p>The following files are created:</p>
<ul>
<li><code>$TOP_FOLDER/u-boot-socfpga/u-boot.itb</code></li>
<li><code>$TOP_FOLDER/u-boot-socfpga/spl/u-boot-spl-dtb.hex</code></li>
</ul>
<h4>Build QSPI Image</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>agilex5_soc_devkit_ghrd/output_files/legacy_baseline.sof<span class="w"> </span>ghrd.jic<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>-o<span class="w"> </span><span class="nv">device</span><span class="o">=</span>MT25QU128<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>-o<span class="w"> </span><span class="nv">flash_loader</span><span class="o">=</span>A5ED065BB32AE6SR0<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>-o<span class="w"> </span><span class="nv">hps_path</span><span class="o">=</span><span class="nv">$TOP_FOLDER</span>/u-boot-socfpga/spl/u-boot-spl-dtb.hex<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>-o<span class="w"> </span><span class="nv">mode</span><span class="o">=</span>ASX4<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>-o<span class="w"> </span><span class="nv">hps</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li><code>$TOP_FOLDER/ghrd.hps.jic</code></li>
</ul>
<h4>Build HPS RBF</h4>

<p>This is an optional step, in which you can build an HPS RBF file, which can be used to configure the HPS through JTAG instead of QSPI though the JIC file.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>agilex5_soc_devkit_ghrd/output_files/legacy_baseline.sof<span class="w"> </span>ghrd.rbf<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>-o<span class="w"> </span><span class="nv">hps_path</span><span class="o">=</span><span class="nv">$TOP_FOLDER</span>/u-boot-socfpga/spl/u-boot-spl-dtb.hex<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>-o<span class="w"> </span><span class="nv">hps</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li>`$TOP_FOLDER/ghrd.hps.rbf</li>
</ul>
<h4>Build Linux</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>linux-socfpga
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS25.1.1_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-fpga/linux-socfpga
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="nb">cd</span><span class="w"> </span>linux-socfpga
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>cat<span class="w"> </span><span class="s">&lt;&lt; EOF &gt; config-fragment-agilex5</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="s"># Enable Ethernet connectivity so we can get an IP address</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="s">CONFIG_MARVELL_PHY=y</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="s">EOF</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>make<span class="w"> </span>defconfig
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="c1"># Apply custom Configs in file</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>./scripts/kconfig/merge_config.sh<span class="w"> </span>-O<span class="w"> </span>./<span class="w"> </span>./.config<span class="w"> </span>./config-fragment-agilex5
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>make<span class="w"> </span>oldconfig
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>make<span class="w"> </span>-j<span class="w"> </span><span class="m">64</span><span class="w"> </span>Image<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>make<span class="w"> </span>intel/socfpga_agilex5_socdk.dtb
</code></pre></div>
<p>The following files are created:</p>
<ul>
<li><code>$TOP_FOLDER/linux-socfpga/arch/arm64/boot/dts/intel/socfpga_agilex5_socdk.dtb</code></li>
<li><code>$TOP_FOLDER/linux-socfpga/arch/arm64/boot/Image</code></li>
</ul>
<h4>Install Yocto Dependencies</h4>

<p>1. Make sure you have Yocto system requirements met: https://docs.yoctoproject.org/5.0.1/ref-manual/system-requirements.html#supported-linux-distributions.</p>
<p>The command to install the required packages on Ubuntu 22.04 is:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>update
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>upgrade
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>openssh-server<span class="w"> </span>mc<span class="w"> </span>libgmp3-dev<span class="w"> </span>libmpc-dev<span class="w"> </span>gawk<span class="w"> </span>wget<span class="w"> </span>git<span class="w"> </span>diffstat<span class="w"> </span>unzip<span class="w"> </span>texinfo<span class="w"> </span>gcc<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>build-essential<span class="w"> </span>chrpath<span class="w"> </span>socat<span class="w"> </span>cpio<span class="w"> </span>python3<span class="w"> </span>python3-pip<span class="w"> </span>python3-pexpect<span class="w"> </span>xz-utils<span class="w"> </span>debianutils<span class="w"> </span>iputils-ping<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>python3-git<span class="w"> </span>python3-jinja2<span class="w"> </span>libegl1-mesa<span class="w"> </span>libsdl1.2-dev<span class="w"> </span>pylint<span class="w"> </span>xterm<span class="w"> </span>python3-subunit<span class="w"> </span>mesa-common-dev<span class="w"> </span>zstd<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>liblz4-tool<span class="w"> </span>git<span class="w"> </span>fakeroot<span class="w"> </span>build-essential<span class="w"> </span>ncurses-dev<span class="w"> </span>xz-utils<span class="w"> </span>libssl-dev<span class="w"> </span>bc<span class="w"> </span>flex<span class="w"> </span>libelf-dev<span class="w"> </span>bison<span class="w"> </span>xinetd<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>tftpd<span class="w"> </span>tftp<span class="w"> </span>nfs-kernel-server<span class="w"> </span>libncurses5<span class="w"> </span>libc6-i386<span class="w"> </span>libstdc++6:i386<span class="w"> </span>libgcc++1:i386<span class="w"> </span>lib32z1<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>device-tree-compiler<span class="w"> </span>curl<span class="w"> </span>mtd-utils<span class="w"> </span>u-boot-tools<span class="w"> </span>net-tools<span class="w"> </span>swig<span class="w"> </span>-y
</code></pre></div>
<p>On Ubuntu 22.04 you will also need to point the /bin/sh to /bin/bash, as the default is a link to /bin/dash:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="w"> </span>sudo<span class="w"> </span>ln<span class="w"> </span>-sf<span class="w"> </span>/bin/bash<span class="w"> </span>/bin/sh
</code></pre></div>
<p><strong>Note</strong>: You can also use a Docker container to build the Yocto recipes, refer to https://rocketboards.org/foswiki/Documentation/DockerYoctoBuild for details. When using a Docker container, it does not matter what Linux distribution or packages you have installed on your host, as all dependencies are provided by the Docker container.</p>
<h4>Build Rootfs</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>yocto<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>yocto<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>yocto
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>walnascar<span class="w"> </span>https://git.yoctoproject.org/poky
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>walnascar<span class="w"> </span>https://git.yoctoproject.org/meta-intel-fpga
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>walnascar<span class="w"> </span>https://github.com/openembedded/meta-openembedded
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="nb">source</span><span class="w"> </span>poky/oe-init-build-env<span class="w"> </span>./build
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;MACHINE = &quot;agilex5_dk_a5e065bb32aes1&quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>conf/local.conf
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;BBLAYERS += &quot; ${TOPDIR}/../meta-intel-fpga &quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>conf/bblayers.conf
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;BBLAYERS += &quot; ${TOPDIR}/../meta-openembedded/meta-oe &quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>conf/bblayers.conf
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;CORE_IMAGE_EXTRA_INSTALL += &quot;openssh gdbserver&quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>conf/local.conf
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>bitbake<span class="w"> </span>core-image-minimal
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li><code>$TOP_FOLDER/yocto/build/tmp/deploy/images/agilex5_dk_a5e065bb32aes1/core-image-minimal-agilex5_dk_a5e065bb32aes1.rootfs.tar.gz</code></li>
</ul>
<h4>Create SD Card Image</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>sudo<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>sd_card<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>sd_card<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>sd_card
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>wget<span class="w"> </span>https://releases.rocketboards.org/release/2020.11/gsrd/tools/make_sdimage_p3.py
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/\&quot;\-F 32\&quot;,//g&#39;</span><span class="w"> </span>make_sdimage_p3.py
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>chmod<span class="w"> </span>+x<span class="w"> </span>make_sdimage_p3.py
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>mkdir<span class="w"> </span>fatfs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">  </span><span class="nb">cd</span><span class="w"> </span>fatfs
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>cp<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/ghrd.core.rbf<span class="w"> </span>.
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>cp<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/u-boot-socfpga/u-boot.itb<span class="w"> </span>.
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>cp<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/linux-socfpga/arch/arm64/boot/Image<span class="w"> </span>.
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>cp<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/linux-socfpga/arch/arm64/boot/dts/intel/socfpga_agilex5_socdk.dtb<span class="w"> </span>.
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="nb">cd</span><span class="w"> </span>..
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>mkdir<span class="w"> </span>rootfs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>rootfs
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>sudo<span class="w"> </span>tar<span class="w"> </span>xf<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/yocto/build/tmp/deploy/images/agilex5_dk_a5e065bb32aes1/core-image-minimal-agilex5_dk_a5e065bb32aes1.rootfs.tar.gz
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="nb">cd</span><span class="w"> </span>..
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a>sudo<span class="w"> </span>python3<span class="w"> </span>make_sdimage_p3.py<span class="w"> </span>-f<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a>-P<span class="w"> </span>fatfs/*,num<span class="o">=</span><span class="m">1</span>,format<span class="o">=</span>fat32,size<span class="o">=</span>64M<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a>-P<span class="w"> </span>rootfs/*,num<span class="o">=</span><span class="m">2</span>,format<span class="o">=</span>ext3,size<span class="o">=</span>64M<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a>-s<span class="w"> </span>140M<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a>-n<span class="w"> </span>sdcard.img
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li><code>$TOP_FOLDER/sd_card/sdcard.img</code></li>
</ul>
<h4>Write SD Card</h4>

<p>Write the SD card image <code>sd_card/sdcard.img</code> to the micro SD card using the included USB writer:</p>
<ul>
<li>On Linux, use the <code>dd</code> utility as shown next:
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="w">    </span><span class="c1"># Determine the device asociated with the SD card on the host computer. </span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w">    </span>cat<span class="w"> </span>/proc/partitions
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">    </span><span class="c1"># This will return for example /dev/sdx</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">    </span><span class="c1"># Use dd to write the image in the corresponding device</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="w">    </span>sudo<span class="w"> </span>dd<span class="w"> </span><span class="k">if</span><span class="o">=</span>sdcard.img<span class="w"> </span><span class="nv">of</span><span class="o">=</span>/dev/sdx<span class="w"> </span><span class="nv">bs</span><span class="o">=</span>1M
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="w">    </span><span class="c1"># Flush the changes to the SD card</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="w">    </span>sync
</code></pre></div></li>
<li>On Windows, use the Win32DiskImager program, available at <a href="https://sourceforge.net/projects/win32diskimager">https://sourceforge.net/projects/win32diskimager</a>. Write the image as shown in the next figure:
<a class="glightbox" href="../images/win32diskimager.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/win32diskimager.png" /></a> </li>
</ul>
<h4>Write QSPI Flash</h4>

<p>1. Power down board</p>
<p>2. Set MSEL dipswitch SW27 to JTAG: OFF-OFF-OFF-OFF</p>
<p>3. Power up the board</p>
<p>4. Write JIC image to QSPI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>jtagconfig<span class="w"> </span>--setparam<span class="w"> </span><span class="m">1</span><span class="w"> </span>JtagClock<span class="w"> </span>16M
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>quartus_pgm<span class="w"> </span>-c<span class="w"> </span><span class="m">1</span><span class="w"> </span>-m<span class="w"> </span>jtag<span class="w"> </span>-o<span class="w"> </span><span class="s2">&quot;pvi;ghrd.hps.jic&quot;</span>
</code></pre></div>
<h4>Boot Linux</h4>

<p>1. Power down board</p>
<p>2. Set MSEL dipswitch SW27 to ASX4 (QSPi): OFF-ON-ON-OFF</p>
<p>3. Power up the board</p>
<p>4. Wait for Linux to boot, use <code>root</code> as user name, and no password wil be requested.</p>
<h3 id="boot-from-qspi">Boot from QSPI<a class="headerlink" href="#boot-from-qspi" title="Permanent link">&para;</a></h3>
<p>This section demonstrates how to build Linux system from separate components, which boots from QSPI.</p>
<p><strong>NOTE:</strong>  This section assumes that the <a href="#boot-from-sd-card">Boot from SD Card</a> section has been already built and the environment setup in that section is still available.</p>
<p>This section presents how to build the binaries and boot from QSPI with the HPS Enablement Board.
While the example is based on the GSRD, it contains the following differences:</p>
<ul>
<li>U-Boot tries to boot only from QSPI flash, does not try SD card</li>
<li>U-Boot does not use a script to boot, instead it used the <code>BOOTCMD</code> environment variable directly</li>
<li>kernel.itb file contains only one set of core.rbf, kernel and device tree files, targeted for this scenario</li>
</ul>
<p>1. Prepare the top folder</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>rm<span class="w"> </span>-rf<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/qspi-boot
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>mkdir<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/qspi-boot
</code></pre></div>
<p>2. Build U-Boot:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>/qspi-boot
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>u-boot-socfpga
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS25.1.1_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-fpga/u-boot-socfpga
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="nb">cd</span><span class="w"> </span>u-boot-socfpga<span class="w"> </span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="c1"># enable dwarf4 debug info, for compatibility with arm ds</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/PLATFORM_CPPFLAGS += -D__ARM__/PLATFORM_CPPFLAGS += -D__ARM__ -gdwarf-4/g&#39;</span><span class="w"> </span>arch/arm/config.mk
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="c1"># only boot from QSPI</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/u-boot,spl-boot-order.*/u-boot\,spl-boot-order = \&amp;flash0;/g&#39;</span><span class="w"> </span>arch/arm/dts/socfpga_agilex5_socdk-u-boot.dtsi
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="c1"># disable NAND in the device tree</span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;/&amp;nand {/!b;n;c\\tstatus = &quot;disabled&quot;;&#39;</span><span class="w"> </span>arch/arm/dts/socfpga_agilex5_socdk-u-boot.dtsi
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="c1"># link to atf</span>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>ln<span class="w"> </span>-s<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/arm-trusted-firmware/build/agilex5/release/bl31.bin<span class="w"> </span>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="c1"># create configuration custom file. </span>
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a>cat<span class="w"> </span><span class="s">&lt;&lt; EOF &gt; config-fragment</span>
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="s"># mtd info</span>
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="s">CONFIG_MTDIDS_DEFAULT=&quot;nor0=nor0&quot;</span>
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a><span class="s">CONFIG_MTDPARTS_DEFAULT=&quot;mtdparts=nor0:66m(u-boot),190m(root)&quot;</span>
<a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a><span class="s"># use Image instead of kernel.itb</span>
<a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a><span class="s">CONFIG_BOOTFILE=&quot;Image&quot;</span>
<a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a><span class="s"># do not keep env on sd card</span>
<a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a><span class="s">CONFIG_ENV_IS_IN_FAT=n</span>
<a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a><span class="s"># disable NAND related settings from defconfig</span>
<a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a><span class="s">CONFIG_NAND_BOOT=n</span>
<a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a><span class="s">CONFIG_SPL_NAND_SUPPORT=n</span>
<a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a><span class="s">CONFIG_CMD_NAND_TRIMFFS=n</span>
<a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a><span class="s">CONFIG_CMD_NAND_LOCK_UNLOCK=n</span>
<a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a><span class="s">CONFIG_NAND_DENALI_DT=n</span>
<a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a><span class="s">CONFIG_SYS_NAND_U_BOOT_LOCATIONS=n</span>
<a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a><span class="s">CONFIG_SPL_NAND_FRAMEWORK=n</span>
<a id="__codelineno-16-30" name="__codelineno-16-30" href="#__codelineno-16-30"></a><span class="s">CONFIG_CMD_NAND=n</span>
<a id="__codelineno-16-31" name="__codelineno-16-31" href="#__codelineno-16-31"></a><span class="s">CONFIG_MTD_RAW_NAND=n</span>
<a id="__codelineno-16-32" name="__codelineno-16-32" href="#__codelineno-16-32"></a><span class="s"># disable distroboot and use specific boot command. </span>
<a id="__codelineno-16-33" name="__codelineno-16-33" href="#__codelineno-16-33"></a><span class="s">CONFIG_DISTRO_DEFAULTS=n</span>
<a id="__codelineno-16-34" name="__codelineno-16-34" href="#__codelineno-16-34"></a><span class="s">CONFIG_HUSH_PARSER=y</span>
<a id="__codelineno-16-35" name="__codelineno-16-35" href="#__codelineno-16-35"></a><span class="s">CONFIG_SYS_PROMPT_HUSH_PS2=&quot;&gt; &quot;</span>
<a id="__codelineno-16-36" name="__codelineno-16-36" href="#__codelineno-16-36"></a><span class="s">CONFIG_USE_BOOTCOMMAND=y</span>
<a id="__codelineno-16-37" name="__codelineno-16-37" href="#__codelineno-16-37"></a><span class="s">CONFIG_BOOTCOMMAND=&quot;mtdparts;ubi part root;ubi readvol \${loadaddr} kernel;ubi detach;setenv bootargs earlycon panic=-1 ubi.mtd=1 root=ubi0:rootfs rootfstype=ubifs rw rootwait;bootm \${loadaddr}#board-0;&quot;</span>
<a id="__codelineno-16-38" name="__codelineno-16-38" href="#__codelineno-16-38"></a><span class="s">CONFIG_CMD_FAT=y</span>
<a id="__codelineno-16-39" name="__codelineno-16-39" href="#__codelineno-16-39"></a><span class="s">CONFIG_CMD_FS_GENERIC=y</span>
<a id="__codelineno-16-40" name="__codelineno-16-40" href="#__codelineno-16-40"></a><span class="s">CONFIG_DOS_PARTITION=y</span>
<a id="__codelineno-16-41" name="__codelineno-16-41" href="#__codelineno-16-41"></a><span class="s">CONFIG_SPL_DOS_PARTITION=y</span>
<a id="__codelineno-16-42" name="__codelineno-16-42" href="#__codelineno-16-42"></a><span class="s">CONFIG_CMD_PART=y</span>
<a id="__codelineno-16-43" name="__codelineno-16-43" href="#__codelineno-16-43"></a><span class="s">CONFIG_SPL_CRC32=y</span>
<a id="__codelineno-16-44" name="__codelineno-16-44" href="#__codelineno-16-44"></a><span class="s">CONFIG_LZO=y</span>
<a id="__codelineno-16-45" name="__codelineno-16-45" href="#__codelineno-16-45"></a><span class="s">CONFIG_CMD_DHCP=y</span>
<a id="__codelineno-16-46" name="__codelineno-16-46" href="#__codelineno-16-46"></a><span class="s"># enable more QSPI flash manufacturers</span>
<a id="__codelineno-16-47" name="__codelineno-16-47" href="#__codelineno-16-47"></a><span class="s">CONFIG_SPI_FLASH_MACRONIX=y</span>
<a id="__codelineno-16-48" name="__codelineno-16-48" href="#__codelineno-16-48"></a><span class="s">CONFIG_SPI_FLASH_GIGADEVICE=y</span>
<a id="__codelineno-16-49" name="__codelineno-16-49" href="#__codelineno-16-49"></a><span class="s">CONFIG_SPI_FLASH_WINBOND=y</span>
<a id="__codelineno-16-50" name="__codelineno-16-50" href="#__codelineno-16-50"></a><span class="s">CONFIG_SPI_FLASH_ISSI=y</span>
<a id="__codelineno-16-51" name="__codelineno-16-51" href="#__codelineno-16-51"></a><span class="s">EOF</span>
<a id="__codelineno-16-52" name="__codelineno-16-52" href="#__codelineno-16-52"></a><span class="c1"># build U-Boot</span>
<a id="__codelineno-16-53" name="__codelineno-16-53" href="#__codelineno-16-53"></a>make<span class="w"> </span>clean<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>make<span class="w"> </span>mrproper
<a id="__codelineno-16-54" name="__codelineno-16-54" href="#__codelineno-16-54"></a>make<span class="w"> </span>socfpga_agilex5_defconfig<span class="w"> </span>
<a id="__codelineno-16-55" name="__codelineno-16-55" href="#__codelineno-16-55"></a><span class="c1"># use created custom configuration file to merge with the default configuration obtained in .config file. </span>
<a id="__codelineno-16-56" name="__codelineno-16-56" href="#__codelineno-16-56"></a>./scripts/kconfig/merge_config.sh<span class="w"> </span>-O<span class="w"> </span>.<span class="w"> </span>-m<span class="w"> </span>.config<span class="w"> </span>config-fragment
<a id="__codelineno-16-57" name="__codelineno-16-57" href="#__codelineno-16-57"></a>make<span class="w"> </span>-j<span class="w"> </span><span class="m">64</span>
<a id="__codelineno-16-58" name="__codelineno-16-58" href="#__codelineno-16-58"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<p>The following files are created:</p>
<ul>
<li><code>$TOP_FOLDER/qspi-boot/u-boot-socfpga/u-boot.itb</code></li>
<li><code>$TOP_FOLDER/qspi-boot/u-boot-socfpga/spl/u-boot-spl-dtb.hex</code></li>
</ul>
<p>3. Build <code>kernel.itb</code> FIT file containing kernel, device tree and fpga fabric configuration file:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>/qspi-boot
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>rm<span class="w"> </span>-f<span class="w"> </span>core.rbf<span class="w"> </span>devicetree.dtb<span class="w"> </span>Image.lzma<span class="w"> </span>kernel.its<span class="w"> </span>kernel.itb
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>ln<span class="w"> </span>-s<span class="w"> </span>../ghrd.core.rbf<span class="w"> </span>core.rbf
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>ln<span class="w"> </span>-s<span class="w"> </span>../linux-socfpga/arch/arm64/boot/dts/intel/socfpga_agilex5_socdk.dtb<span class="w"> </span>devicetree.dtb
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>xz<span class="w"> </span>--format<span class="o">=</span>lzma<span class="w"> </span>--extreme<span class="w"> </span>-k<span class="w"> </span>-c<span class="w"> </span>../linux-socfpga/arch/arm64/boot/Image<span class="w"> </span>&gt;<span class="w"> </span>Image.lzma
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>cat<span class="w"> </span><span class="s">&lt;&lt; EOF &gt; kernel.its</span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="s">// SPDX-License-Identifier: GPL-2.0</span>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="s">/*</span>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="s"> * Copyright (C) 2024 Intel Corporation</span>
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="s"> *</span>
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a><span class="s"> */</span>
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a>
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a><span class="s">/dts-v1/;</span>
<a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a>
<a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a><span class="s">/ {</span>
<a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a><span class="s">    description = &quot;FIT image with kernel, DTB and FPGA core binary&quot;;</span>
<a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a><span class="s">    #address-cells = &lt;1&gt;;</span>
<a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a>
<a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a><span class="s">    images {</span>
<a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a><span class="s">        kernel {</span>
<a id="__codelineno-17-21" name="__codelineno-17-21" href="#__codelineno-17-21"></a><span class="s">            description = &quot;Linux Kernel&quot;;</span>
<a id="__codelineno-17-22" name="__codelineno-17-22" href="#__codelineno-17-22"></a><span class="s">            data = /incbin/(&quot;./Image.lzma&quot;);</span>
<a id="__codelineno-17-23" name="__codelineno-17-23" href="#__codelineno-17-23"></a><span class="s">            type = &quot;kernel&quot;;</span>
<a id="__codelineno-17-24" name="__codelineno-17-24" href="#__codelineno-17-24"></a><span class="s">            arch = &quot;arm64&quot;;</span>
<a id="__codelineno-17-25" name="__codelineno-17-25" href="#__codelineno-17-25"></a><span class="s">            os = &quot;linux&quot;;</span>
<a id="__codelineno-17-26" name="__codelineno-17-26" href="#__codelineno-17-26"></a><span class="s">            compression = &quot;lzma&quot;;</span>
<a id="__codelineno-17-27" name="__codelineno-17-27" href="#__codelineno-17-27"></a><span class="s">            load = &lt;0x86000000&gt;;</span>
<a id="__codelineno-17-28" name="__codelineno-17-28" href="#__codelineno-17-28"></a><span class="s">            entry = &lt;0x86000000&gt;;</span>
<a id="__codelineno-17-29" name="__codelineno-17-29" href="#__codelineno-17-29"></a><span class="s">            hash {</span>
<a id="__codelineno-17-30" name="__codelineno-17-30" href="#__codelineno-17-30"></a><span class="s">                algo = &quot;crc32&quot;;</span>
<a id="__codelineno-17-31" name="__codelineno-17-31" href="#__codelineno-17-31"></a><span class="s">            };</span>
<a id="__codelineno-17-32" name="__codelineno-17-32" href="#__codelineno-17-32"></a><span class="s">        };</span>
<a id="__codelineno-17-33" name="__codelineno-17-33" href="#__codelineno-17-33"></a>
<a id="__codelineno-17-34" name="__codelineno-17-34" href="#__codelineno-17-34"></a><span class="s">        fdt-0 {</span>
<a id="__codelineno-17-35" name="__codelineno-17-35" href="#__codelineno-17-35"></a><span class="s">            description = &quot;Device Tree&quot;;</span>
<a id="__codelineno-17-36" name="__codelineno-17-36" href="#__codelineno-17-36"></a><span class="s">            data = /incbin/(&quot;./devicetree.dtb&quot;);</span>
<a id="__codelineno-17-37" name="__codelineno-17-37" href="#__codelineno-17-37"></a><span class="s">            type = &quot;flat_dt&quot;;</span>
<a id="__codelineno-17-38" name="__codelineno-17-38" href="#__codelineno-17-38"></a><span class="s">            arch = &quot;arm64&quot;;</span>
<a id="__codelineno-17-39" name="__codelineno-17-39" href="#__codelineno-17-39"></a><span class="s">            compression = &quot;none&quot;;</span>
<a id="__codelineno-17-40" name="__codelineno-17-40" href="#__codelineno-17-40"></a><span class="s">            hash {</span>
<a id="__codelineno-17-41" name="__codelineno-17-41" href="#__codelineno-17-41"></a><span class="s">                algo = &quot;crc32&quot;;</span>
<a id="__codelineno-17-42" name="__codelineno-17-42" href="#__codelineno-17-42"></a><span class="s">            };</span>
<a id="__codelineno-17-43" name="__codelineno-17-43" href="#__codelineno-17-43"></a><span class="s">        };</span>
<a id="__codelineno-17-44" name="__codelineno-17-44" href="#__codelineno-17-44"></a>
<a id="__codelineno-17-45" name="__codelineno-17-45" href="#__codelineno-17-45"></a><span class="s">        fpga-0 {</span>
<a id="__codelineno-17-46" name="__codelineno-17-46" href="#__codelineno-17-46"></a><span class="s">            description = &quot;FPGA bitstream&quot;;</span>
<a id="__codelineno-17-47" name="__codelineno-17-47" href="#__codelineno-17-47"></a><span class="s">            data = /incbin/(&quot;./core.rbf&quot;);</span>
<a id="__codelineno-17-48" name="__codelineno-17-48" href="#__codelineno-17-48"></a><span class="s">            type = &quot;fpga&quot;;</span>
<a id="__codelineno-17-49" name="__codelineno-17-49" href="#__codelineno-17-49"></a><span class="s">            arch = &quot;arm64&quot;;</span>
<a id="__codelineno-17-50" name="__codelineno-17-50" href="#__codelineno-17-50"></a><span class="s">            compression = &quot;none&quot;;</span>
<a id="__codelineno-17-51" name="__codelineno-17-51" href="#__codelineno-17-51"></a><span class="s">            load = &lt;0x8A000000&gt;;</span>
<a id="__codelineno-17-52" name="__codelineno-17-52" href="#__codelineno-17-52"></a><span class="s">            hash {</span>
<a id="__codelineno-17-53" name="__codelineno-17-53" href="#__codelineno-17-53"></a><span class="s">                algo = &quot;crc32&quot;;</span>
<a id="__codelineno-17-54" name="__codelineno-17-54" href="#__codelineno-17-54"></a><span class="s">            };</span>
<a id="__codelineno-17-55" name="__codelineno-17-55" href="#__codelineno-17-55"></a><span class="s">        };</span>
<a id="__codelineno-17-56" name="__codelineno-17-56" href="#__codelineno-17-56"></a><span class="s">    };</span>
<a id="__codelineno-17-57" name="__codelineno-17-57" href="#__codelineno-17-57"></a>
<a id="__codelineno-17-58" name="__codelineno-17-58" href="#__codelineno-17-58"></a><span class="s">    configurations {</span>
<a id="__codelineno-17-59" name="__codelineno-17-59" href="#__codelineno-17-59"></a><span class="s">        default = &quot;board-0&quot;;</span>
<a id="__codelineno-17-60" name="__codelineno-17-60" href="#__codelineno-17-60"></a>
<a id="__codelineno-17-61" name="__codelineno-17-61" href="#__codelineno-17-61"></a><span class="s">        board-0 {</span>
<a id="__codelineno-17-62" name="__codelineno-17-62" href="#__codelineno-17-62"></a><span class="s">            description = &quot;board_0&quot;;</span>
<a id="__codelineno-17-63" name="__codelineno-17-63" href="#__codelineno-17-63"></a><span class="s">            kernel = &quot;kernel&quot;;</span>
<a id="__codelineno-17-64" name="__codelineno-17-64" href="#__codelineno-17-64"></a><span class="s">            fdt = &quot;fdt-0&quot;;</span>
<a id="__codelineno-17-65" name="__codelineno-17-65" href="#__codelineno-17-65"></a><span class="s">            fpga = &quot;fpga-0&quot;;</span>
<a id="__codelineno-17-66" name="__codelineno-17-66" href="#__codelineno-17-66"></a><span class="s">            signature {</span>
<a id="__codelineno-17-67" name="__codelineno-17-67" href="#__codelineno-17-67"></a><span class="s">                algo = &quot;crc32&quot;;</span>
<a id="__codelineno-17-68" name="__codelineno-17-68" href="#__codelineno-17-68"></a><span class="s">                key-name-hint = &quot;dev&quot;;</span>
<a id="__codelineno-17-69" name="__codelineno-17-69" href="#__codelineno-17-69"></a><span class="s">                sign-images = &quot;fdt-0&quot;, &quot;kernel&quot;, &quot;fpga-0&quot;;</span>
<a id="__codelineno-17-70" name="__codelineno-17-70" href="#__codelineno-17-70"></a><span class="s">            };</span>
<a id="__codelineno-17-71" name="__codelineno-17-71" href="#__codelineno-17-71"></a><span class="s">        };</span>
<a id="__codelineno-17-72" name="__codelineno-17-72" href="#__codelineno-17-72"></a><span class="s">    };</span>
<a id="__codelineno-17-73" name="__codelineno-17-73" href="#__codelineno-17-73"></a><span class="s">};</span>
<a id="__codelineno-17-74" name="__codelineno-17-74" href="#__codelineno-17-74"></a><span class="s">EOF</span>
<a id="__codelineno-17-75" name="__codelineno-17-75" href="#__codelineno-17-75"></a>./u-boot-socfpga/tools/mkimage<span class="w"> </span>-f<span class="w"> </span>kernel.its<span class="w"> </span>kernel.itb
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li><code>$TOP_FOLDER/qspi-boot/kernel.itb</code></li>
</ul>
<p>4. Create U-Boot binary <code>u-boot.bin</code> with a size of exactly 2MB:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>cp<span class="w"> </span>u-boot-socfpga/u-boot.itb<span class="w"> </span>.
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="nv">uboot_part_size</span><span class="o">=</span><span class="m">2</span>*1024*1024
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="nv">uboot_size</span><span class="o">=</span><span class="sb">`</span>wc<span class="w"> </span>-c<span class="w"> </span>&lt;<span class="w"> </span>u-boot.itb<span class="sb">`</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="nv">uboot_pad</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$((</span><span class="nv">uboot_part_size</span><span class="o">-</span><span class="nv">uboot_size</span><span class="k">))</span><span class="s2">&quot;</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>truncate<span class="w"> </span>-s<span class="w"> </span>+<span class="nv">$uboot_pad</span><span class="w"> </span>u-boot.itb
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>mv<span class="w"> </span>u-boot.itb<span class="w"> </span>u-boot.bin
</code></pre></div>
<p>5. Build the <code>rootfs.ubifs</code> file:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>rm<span class="w"> </span>-rf<span class="w"> </span>rootfs<span class="w"> </span>rootfs.ubifs
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>mkdir<span class="w"> </span>rootfs<span class="w"> </span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>tar<span class="w"> </span>-xzvf<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/yocto/build/tmp/deploy/images/agilex5_dk_a5e065bb32aes1/core-image-minimal-agilex5_dk_a5e065bb32aes1.rootfs.tar.gz<span class="w"> </span>-C<span class="w"> </span>rootfs<span class="w"> </span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>mkfs.ubifs<span class="w"> </span>-r<span class="w"> </span>rootfs<span class="w"> </span>-F<span class="w"> </span>-e<span class="w"> </span><span class="m">65408</span><span class="w"> </span>-m<span class="w"> </span><span class="m">1</span><span class="w"> </span>-c<span class="w"> </span><span class="m">6500</span><span class="w"> </span>-o<span class="w"> </span>rootfs.ubifs<span class="w"> </span>
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li><code>$TOP_FOLDER/qspi-boot/rootfs.ubifs</code></li>
</ul>
<p>6. Build the <code>root.ubi</code> file:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>cat<span class="w"> </span><span class="s">&lt;&lt; EOF &gt; ubinize.cfg</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="s">[env]</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="s">mode=ubi</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="s">vol_id=0</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="s">vol_name=env</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="s">vol_size=256KiB</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="s">vol_type=dynamic</span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="s">[script]</span>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="s">mode=ubi</span>
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="s">vol_id=1</span>
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="s">vol_name=script</span>
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="s">vol_size=128KiB </span>
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a><span class="s">vol_type=dynamic</span>
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>
<a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a><span class="s">[kernel]</span>
<a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a><span class="s">mode=ubi</span>
<a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a><span class="s">image=kernel.itb</span>
<a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a><span class="s">vol_id=2</span>
<a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a><span class="s">vol_name=kernel</span>
<a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a><span class="s">vol_size=24MiB</span>
<a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a><span class="s">vol_type=dynamic</span>
<a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a>
<a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a><span class="s">[dtb]</span>
<a id="__codelineno-20-25" name="__codelineno-20-25" href="#__codelineno-20-25"></a><span class="s">mode=ubi</span>
<a id="__codelineno-20-26" name="__codelineno-20-26" href="#__codelineno-20-26"></a><span class="s">vol_id=3    </span>
<a id="__codelineno-20-27" name="__codelineno-20-27" href="#__codelineno-20-27"></a><span class="s">vol_name=dtb   </span>
<a id="__codelineno-20-28" name="__codelineno-20-28" href="#__codelineno-20-28"></a><span class="s">vol_size=256KiB </span>
<a id="__codelineno-20-29" name="__codelineno-20-29" href="#__codelineno-20-29"></a><span class="s">vol_type=dynamic</span>
<a id="__codelineno-20-30" name="__codelineno-20-30" href="#__codelineno-20-30"></a>
<a id="__codelineno-20-31" name="__codelineno-20-31" href="#__codelineno-20-31"></a><span class="s">[rootfs]</span>
<a id="__codelineno-20-32" name="__codelineno-20-32" href="#__codelineno-20-32"></a><span class="s">mode=ubi</span>
<a id="__codelineno-20-33" name="__codelineno-20-33" href="#__codelineno-20-33"></a><span class="s">image=rootfs.ubifs</span>
<a id="__codelineno-20-34" name="__codelineno-20-34" href="#__codelineno-20-34"></a><span class="s">vol_id=4</span>
<a id="__codelineno-20-35" name="__codelineno-20-35" href="#__codelineno-20-35"></a><span class="s">vol_name=rootfs</span>
<a id="__codelineno-20-36" name="__codelineno-20-36" href="#__codelineno-20-36"></a><span class="s">vol_type=dynamic</span>
<a id="__codelineno-20-37" name="__codelineno-20-37" href="#__codelineno-20-37"></a><span class="s">vol_size=160MiB</span>
<a id="__codelineno-20-38" name="__codelineno-20-38" href="#__codelineno-20-38"></a><span class="s">vol_flag=autoresize</span>
<a id="__codelineno-20-39" name="__codelineno-20-39" href="#__codelineno-20-39"></a><span class="s">EOF</span>
<a id="__codelineno-20-40" name="__codelineno-20-40" href="#__codelineno-20-40"></a>ubinize<span class="w"> </span>-o<span class="w"> </span>root.ubi<span class="w"> </span>-p<span class="w"> </span><span class="m">65536</span><span class="w"> </span>-m<span class="w"> </span><span class="m">1</span><span class="w"> </span>-s<span class="w"> </span><span class="m">1</span><span class="w"> </span>ubinize.cfg
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li><code>$TOP_FOLDER/qspi-boot/root.ubi</code></li>
</ul>
<p>7. Build the QSPI flash image:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>ln<span class="w"> </span>-s<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/agilex5_soc_devkit_ghrd/output_files/legacy_baseline.sof<span class="w"> </span>fpga.sof
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>ln<span class="w"> </span>-s<span class="w"> </span>u-boot-socfpga/spl/u-boot-spl-dtb.hex<span class="w"> </span>spl.hex
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>ln<span class="w"> </span>-s<span class="w"> </span>root.ubi<span class="w"> </span>hps.bin
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>cat<span class="w"> </span><span class="s">&lt;&lt; EOF &gt; flash_image.pfg</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="s">&lt;pfg version=&quot;1&quot;&gt;</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="s">    &lt;settings custom_db_dir=&quot;./&quot; mode=&quot;ASX4&quot;/&gt;</span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="s">    &lt;output_files&gt;</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="s">        &lt;output_file name=&quot;flash_image&quot; hps=&quot;1&quot; directory=&quot;./&quot; type=&quot;PERIPH_JIC&quot;&gt;</span>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="s">            &lt;file_options/&gt;</span>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="s">            &lt;secondary_file type=&quot;MAP&quot; name=&quot;flash_image_jic&quot;&gt;</span>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="s">                &lt;file_options/&gt;</span>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="s">            &lt;/secondary_file&gt;</span>
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="s">            &lt;flash_device_id&gt;Flash_Device_1&lt;/flash_device_id&gt;</span>
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="s">        &lt;/output_file&gt;</span>
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="s">    &lt;/output_files&gt;</span>
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a><span class="s">    &lt;bitstreams&gt;</span>
<a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a><span class="s">        &lt;bitstream id=&quot;Bitstream_1&quot;&gt;</span>
<a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a><span class="s">            &lt;path hps_path=&quot;spl.hex&quot;&gt;fpga.sof&lt;/path&gt;</span>
<a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a><span class="s">    &lt;/bitstream&gt;</span>
<a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a><span class="s">    &lt;/bitstreams&gt;</span>
<a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a><span class="s">    &lt;raw_files&gt;</span>
<a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a><span class="s">        &lt;raw_file bitswap=&quot;1&quot; type=&quot;RBF&quot; id=&quot;Raw_File_1&quot;&gt;u-boot.bin&lt;/raw_file&gt;</span>
<a id="__codelineno-21-23" name="__codelineno-21-23" href="#__codelineno-21-23"></a><span class="s">        &lt;raw_file bitswap=&quot;1&quot; type=&quot;RBF&quot; id=&quot;Raw_File_2&quot;&gt;hps.bin&lt;/raw_file&gt;</span>
<a id="__codelineno-21-24" name="__codelineno-21-24" href="#__codelineno-21-24"></a><span class="s">    &lt;/raw_files&gt;</span>
<a id="__codelineno-21-25" name="__codelineno-21-25" href="#__codelineno-21-25"></a><span class="s">    &lt;flash_devices&gt;</span>
<a id="__codelineno-21-26" name="__codelineno-21-26" href="#__codelineno-21-26"></a><span class="s">        &lt;flash_loader&gt;A5ED065BB32AE6SR0&lt;/flash_loader&gt;</span>
<a id="__codelineno-21-27" name="__codelineno-21-27" href="#__codelineno-21-27"></a><span class="s">        &lt;flash_device type=&quot;MT25QU02G&quot; id=&quot;Flash_Device_1&quot;&gt;</span>
<a id="__codelineno-21-28" name="__codelineno-21-28" href="#__codelineno-21-28"></a><span class="s">            &lt;partition reserved=&quot;1&quot; fixed_s_addr=&quot;1&quot; s_addr=&quot;0x00000000&quot; e_addr=&quot;0x001FFFFF&quot; fixed_e_addr=&quot;1&quot; id=&quot;BOOT_INFO&quot; size=&quot;0&quot;/&gt;</span>
<a id="__codelineno-21-29" name="__codelineno-21-29" href="#__codelineno-21-29"></a><span class="s">            &lt;partition reserved=&quot;0&quot; fixed_s_addr=&quot;0&quot; s_addr=&quot;auto&quot; e_addr=&quot;auto&quot; fixed_e_addr=&quot;0&quot; id=&quot;P1&quot; size=&quot;0&quot;/&gt;</span>
<a id="__codelineno-21-30" name="__codelineno-21-30" href="#__codelineno-21-30"></a><span class="s">            &lt;partition reserved=&quot;0&quot; fixed_s_addr=&quot;0&quot; s_addr=&quot;0x04000000&quot; e_addr=&quot;auto&quot; fixed_e_addr=&quot;0&quot; id=&quot;UBOOT&quot; size=&quot;0&quot;/&gt;</span>
<a id="__codelineno-21-31" name="__codelineno-21-31" href="#__codelineno-21-31"></a><span class="s">            &lt;partition reserved=&quot;0&quot; fixed_s_addr=&quot;0&quot; s_addr=&quot;0x04200000&quot; e_addr=&quot;auto&quot; fixed_e_addr=&quot;0&quot; id=&quot;HPS&quot; size=&quot;0&quot;/&gt;</span>
<a id="__codelineno-21-32" name="__codelineno-21-32" href="#__codelineno-21-32"></a><span class="s">        &lt;/flash_device&gt;</span>
<a id="__codelineno-21-33" name="__codelineno-21-33" href="#__codelineno-21-33"></a><span class="s">    &lt;/flash_devices&gt;</span>
<a id="__codelineno-21-34" name="__codelineno-21-34" href="#__codelineno-21-34"></a><span class="s">    &lt;assignments&gt;</span>
<a id="__codelineno-21-35" name="__codelineno-21-35" href="#__codelineno-21-35"></a><span class="s">        &lt;assignment page=&quot;0&quot; partition_id=&quot;P1&quot;&gt;</span>
<a id="__codelineno-21-36" name="__codelineno-21-36" href="#__codelineno-21-36"></a><span class="s">            &lt;bitstream_id&gt;Bitstream_1&lt;/bitstream_id&gt;</span>
<a id="__codelineno-21-37" name="__codelineno-21-37" href="#__codelineno-21-37"></a><span class="s">        &lt;/assignment&gt;</span>
<a id="__codelineno-21-38" name="__codelineno-21-38" href="#__codelineno-21-38"></a><span class="s">        &lt;assignment page=&quot;0&quot; partition_id=&quot;UBOOT&quot;&gt;</span>
<a id="__codelineno-21-39" name="__codelineno-21-39" href="#__codelineno-21-39"></a><span class="s">            &lt;raw_file_id&gt;Raw_File_1&lt;/raw_file_id&gt;</span>
<a id="__codelineno-21-40" name="__codelineno-21-40" href="#__codelineno-21-40"></a><span class="s">        &lt;/assignment&gt;</span>
<a id="__codelineno-21-41" name="__codelineno-21-41" href="#__codelineno-21-41"></a><span class="s">        &lt;assignment page=&quot;0&quot; partition_id=&quot;HPS&quot;&gt;</span>
<a id="__codelineno-21-42" name="__codelineno-21-42" href="#__codelineno-21-42"></a><span class="s">            &lt;raw_file_id&gt;Raw_File_2&lt;/raw_file_id&gt;</span>
<a id="__codelineno-21-43" name="__codelineno-21-43" href="#__codelineno-21-43"></a><span class="s">        &lt;/assignment&gt;</span>
<a id="__codelineno-21-44" name="__codelineno-21-44" href="#__codelineno-21-44"></a><span class="s">    &lt;/assignments&gt;</span>
<a id="__codelineno-21-45" name="__codelineno-21-45" href="#__codelineno-21-45"></a><span class="s">&lt;/pfg&gt;</span>
<a id="__codelineno-21-46" name="__codelineno-21-46" href="#__codelineno-21-46"></a><span class="s">EOF</span>
<a id="__codelineno-21-47" name="__codelineno-21-47" href="#__codelineno-21-47"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>flash_image.pfg
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li><code>$TOP_FOLDER/qspi-boot/flash_image.hps.jic</code></li>
</ul>
<h4>Write QSPI Flash</h4>

<p>1. Power down board</p>
<p>2. Set MSEL dipswitch SW27 to JTAG: OFF-OFF-OFF-OFF</p>
<p>3. Power up the board</p>
<p>4. Write JIC image to QSPI:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>jtagconfig<span class="w"> </span>--setparam<span class="w"> </span><span class="m">1</span><span class="w"> </span>JtagClock<span class="w"> </span>16M
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>quartus_pgm<span class="w"> </span>-c<span class="w"> </span><span class="m">1</span><span class="w"> </span>-m<span class="w"> </span>jtag<span class="w"> </span>-o<span class="w"> </span><span class="s2">&quot;qspi-boot/flash_image.hps.jic&quot;</span>
</code></pre></div>
Note: You need to wipe the micro SD card or remove it from the board before start running.</p>
<h4>Boot Linux</h4>

<p>1. Power down board</p>
<p>2. Set MSEL dipswitch SW27 to ASX4 (QSPi): OFF-ON-ON-OFF</p>
<p>3. Power up the board</p>
<p>4. Wait for Linux to boot, use <code>root</code> as user name, and no password wil be requested.</p>
<h2 id="hps-nand-board">HPS NAND Board<a class="headerlink" href="#hps-nand-board" title="Permanent link">&para;</a></h2>
<p>This section demonstrates how to build a Linux system from separate components, targetting the HPS NAND Board. Boot source is eMMC Flash.</p>
<h3 id="boot-from-emmc">Boot from eMMC<a class="headerlink" href="#boot-from-emmc" title="Permanent link">&para;</a></h3>
<h4>Setup Environment</h4>

<p>1. Create the top folder to store all the build artifacts:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>sudo<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>agilex5_boot.emmc
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>mkdir<span class="w"> </span>agilex5_boot.emmc
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="nb">cd</span><span class="w"> </span>agilex5_boot.emmc
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="nb">export</span><span class="w"> </span><span class="nv">TOP_FOLDER</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
</code></pre></div>
<p>Download the compiler toolchain, add it to the PATH variable, to be used by the GHRD makefile to build the HPS Debug FSBL:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>wget<span class="w"> </span>https://developer.arm.com/-/media/Files/downloads/gnu/14.3.rel1/binrel/<span class="se">\</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>arm-gnu-toolchain-14.3.rel1-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>tar<span class="w"> </span>xf<span class="w"> </span>arm-gnu-toolchain-14.3.rel1-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>rm<span class="w"> </span>-f<span class="w"> </span>arm-gnu-toolchain-14.3.rel1-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>/arm-gnu-toolchain-14.3.rel1-x86_64-aarch64-none-linux-gnu/bin/:<span class="nv">$PATH</span>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="nb">export</span><span class="w"> </span><span class="nv">ARCH</span><span class="o">=</span>arm64
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="nb">export</span><span class="w"> </span><span class="nv">CROSS_COMPILE</span><span class="o">=</span>aarch64-none-linux-gnu-
</code></pre></div>
<p>Enable Quartus tools to be called from command line:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_ROOTDIR</span><span class="o">=</span>~/altera_pro/25.1.1/quartus/
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>/bin:<span class="nv">$QUARTUS_ROOTDIR</span>/linux64:<span class="nv">$QUARTUS_ROOTDIR</span>/../qsys/bin:<span class="nv">$PATH</span>
</code></pre></div>
<h4>Build Hardware Design</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>agilex5_soc_devkit_ghrd<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>agilex5_soc_devkit_ghrd<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>agilex5_soc_devkit_ghrd
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>wget<span class="w"> </span>https://github.com/altera-fpga/agilex5e-ed-gsrd/releases/download/QPDS25.1.1_REL_GSRD_PR/a5ed065es-premium-devkit-emmc-legacy-baseline.zip
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>unzip<span class="w"> </span>a5ed065es-premium-devkit-emmc-legacy-baseline.zip
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>rm<span class="w"> </span>-f<span class="w"> </span>a5ed065es-premium-devkit-emmc-legacy-baseline.zip
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>make<span class="w"> </span>legacy_baseline-build
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>make<span class="w"> </span>legacy_baseline-sw-build
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>output_files/legacy_baseline.sof<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="w">  </span>output_files/legacy_baseline_hps_debug.sof<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a><span class="w">  </span>-o<span class="w"> </span><span class="nv">hps_path</span><span class="o">=</span>software/hps_debug/hps_wipe.ihex
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<p>The following files are created:</p>
<ul>
<li><code>$TOP_FOLDER/agilex5_soc_devkit_ghrd/output_files/legacy_baseline.sof</code></li>
<li><code>$TOP_FOLDER/agilex5_soc_devkit_ghrd/output_files/legacy_baseline_hps_debug.sof</code></li>
</ul>
<h4>Build Arm Trusted Firmware</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>arm-trusted-firmware
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS25.1.1_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-fpga/arm-trusted-firmware
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="nb">cd</span><span class="w"> </span>arm-trusted-firmware
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>make<span class="w"> </span>-j<span class="w"> </span><span class="m">48</span><span class="w"> </span><span class="nv">PLAT</span><span class="o">=</span>agilex5<span class="w"> </span>bl31<span class="w"> </span>
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li><code>$TOP_FOLDER/arm-trusted-firmware/build/agilex5/release/bl31.bin</code></li>
</ul>
<h4>Build U-Boot</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>u-boot-socfpga
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS25.1.1_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-fpga/u-boot-socfpga
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="nb">cd</span><span class="w"> </span>u-boot-socfpga<span class="w"> </span>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="c1"># enable dwarf4 debug info, for compatibility with arm ds</span>
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/PLATFORM_CPPFLAGS += -D__ARM__/PLATFORM_CPPFLAGS += -D__ARM__ -gdwarf-4/g&#39;</span><span class="w"> </span>arch/arm/config.mk
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="c1"># only boot from SD, do not try QSPI and NAND</span>
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/u-boot,spl-boot-order.*/u-boot\,spl-boot-order = \&amp;mmc;/g&#39;</span><span class="w"> </span>arch/arm/dts/socfpga_agilex5_socdk-u-boot.dtsi
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="c1"># disable NAND in the device tree</span>
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;/&amp;nand {/!b;n;c\\tstatus = &quot;disabled&quot;;&#39;</span><span class="w"> </span>arch/arm/dts/socfpga_agilex5_socdk-u-boot.dtsi
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a><span class="c1"># swap gmac0 and gmac2</span>
<a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;/&amp;gmac2/ { N; s/status = &quot;okay&quot;/status = &quot;disabled&quot;/; }&#39;</span><span class="w"> </span>arch/arm/dts/socfpga_agilex5_socdk.dts
<a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;/&amp;gmac0/ { N; s/status = &quot;disabled&quot;/status = &quot;okay&quot;/; }&#39;</span><span class="w"> </span>arch/arm/dts/socfpga_agilex5_socdk.dts
<a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a><span class="c1"># link to atf</span>
<a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a>ln<span class="w"> </span>-s<span class="w"> </span>../arm-trusted-firmware/build/agilex5/release/bl31.bin<span class="w"> </span>
<a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a><span class="c1"># create configuration custom file. </span>
<a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a>cat<span class="w"> </span><span class="s">&lt;&lt; EOF &gt; config-fragment</span>
<a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a><span class="s"># use Image instead of kernel.itb</span>
<a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a><span class="s">CONFIG_BOOTFILE=&quot;Image&quot;</span>
<a id="__codelineno-28-20" name="__codelineno-28-20" href="#__codelineno-28-20"></a><span class="s"># disable NAND/UBI related settings from defconfig. </span>
<a id="__codelineno-28-21" name="__codelineno-28-21" href="#__codelineno-28-21"></a><span class="s">CONFIG_NAND_BOOT=n</span>
<a id="__codelineno-28-22" name="__codelineno-28-22" href="#__codelineno-28-22"></a><span class="s">CONFIG_SPL_NAND_SUPPORT=n</span>
<a id="__codelineno-28-23" name="__codelineno-28-23" href="#__codelineno-28-23"></a><span class="s">CONFIG_CMD_NAND_TRIMFFS=n</span>
<a id="__codelineno-28-24" name="__codelineno-28-24" href="#__codelineno-28-24"></a><span class="s">CONFIG_CMD_NAND_LOCK_UNLOCK=n</span>
<a id="__codelineno-28-25" name="__codelineno-28-25" href="#__codelineno-28-25"></a><span class="s">CONFIG_NAND_DENALI_DT=n</span>
<a id="__codelineno-28-26" name="__codelineno-28-26" href="#__codelineno-28-26"></a><span class="s">CONFIG_SYS_NAND_U_BOOT_LOCATIONS=n</span>
<a id="__codelineno-28-27" name="__codelineno-28-27" href="#__codelineno-28-27"></a><span class="s">CONFIG_SPL_NAND_FRAMEWORK=n</span>
<a id="__codelineno-28-28" name="__codelineno-28-28" href="#__codelineno-28-28"></a><span class="s">CONFIG_CMD_NAND=n</span>
<a id="__codelineno-28-29" name="__codelineno-28-29" href="#__codelineno-28-29"></a><span class="s">CONFIG_MTD_RAW_NAND=n</span>
<a id="__codelineno-28-30" name="__codelineno-28-30" href="#__codelineno-28-30"></a><span class="s">CONFIG_CMD_UBI=n</span>
<a id="__codelineno-28-31" name="__codelineno-28-31" href="#__codelineno-28-31"></a><span class="s">CONFIG_CMD_UBIFS=n</span>
<a id="__codelineno-28-32" name="__codelineno-28-32" href="#__codelineno-28-32"></a><span class="s">CONFIG_MTD_UBI=n</span>
<a id="__codelineno-28-33" name="__codelineno-28-33" href="#__codelineno-28-33"></a><span class="s">CONFIG_ENV_IS_IN_UBI=n</span>
<a id="__codelineno-28-34" name="__codelineno-28-34" href="#__codelineno-28-34"></a><span class="s">CONFIG_UBI_SILENCE_MSG=n</span>
<a id="__codelineno-28-35" name="__codelineno-28-35" href="#__codelineno-28-35"></a><span class="s">CONFIG_UBIFS_SILENCE_MSG=n</span>
<a id="__codelineno-28-36" name="__codelineno-28-36" href="#__codelineno-28-36"></a><span class="s"># disable distroboot and use specific boot command. </span>
<a id="__codelineno-28-37" name="__codelineno-28-37" href="#__codelineno-28-37"></a><span class="s">CONFIG_DISTRO_DEFAULTS=n</span>
<a id="__codelineno-28-38" name="__codelineno-28-38" href="#__codelineno-28-38"></a><span class="s">CONFIG_HUSH_PARSER=y</span>
<a id="__codelineno-28-39" name="__codelineno-28-39" href="#__codelineno-28-39"></a><span class="s">CONFIG_SYS_PROMPT_HUSH_PS2=&quot;&gt; &quot;</span>
<a id="__codelineno-28-40" name="__codelineno-28-40" href="#__codelineno-28-40"></a><span class="s">CONFIG_USE_BOOTCOMMAND=y</span>
<a id="__codelineno-28-41" name="__codelineno-28-41" href="#__codelineno-28-41"></a><span class="s">CONFIG_BOOTCOMMAND=&quot;load mmc 0:1 \${loadaddr} ghrd.core.rbf; fpga load 0 \${loadaddr} \${filesize};bridge enable; mmc rescan; fatload mmc 0:1 82000000 Image;fatload mmc 0:1 86000000 socfpga_agilex5_socdk_emmc.dtb;setenv bootargs console=ttyS0,115200 root=\${mmcroot} rw rootwait;booti 0x82000000 - 0x86000000&quot;</span>
<a id="__codelineno-28-42" name="__codelineno-28-42" href="#__codelineno-28-42"></a><span class="s">CONFIG_CMD_FAT=y</span>
<a id="__codelineno-28-43" name="__codelineno-28-43" href="#__codelineno-28-43"></a><span class="s">CONFIG_CMD_FS_GENERIC=y</span>
<a id="__codelineno-28-44" name="__codelineno-28-44" href="#__codelineno-28-44"></a><span class="s">CONFIG_DOS_PARTITION=y</span>
<a id="__codelineno-28-45" name="__codelineno-28-45" href="#__codelineno-28-45"></a><span class="s">CONFIG_SPL_DOS_PARTITION=y</span>
<a id="__codelineno-28-46" name="__codelineno-28-46" href="#__codelineno-28-46"></a><span class="s">CONFIG_CMD_PART=y</span>
<a id="__codelineno-28-47" name="__codelineno-28-47" href="#__codelineno-28-47"></a><span class="s">CONFIG_SPL_CRC32=y</span>
<a id="__codelineno-28-48" name="__codelineno-28-48" href="#__codelineno-28-48"></a><span class="s">CONFIG_LZO=y</span>
<a id="__codelineno-28-49" name="__codelineno-28-49" href="#__codelineno-28-49"></a><span class="s">CONFIG_CMD_DHCP=y</span>
<a id="__codelineno-28-50" name="__codelineno-28-50" href="#__codelineno-28-50"></a><span class="s"># enable more QSPI flash manufacturers</span>
<a id="__codelineno-28-51" name="__codelineno-28-51" href="#__codelineno-28-51"></a><span class="s">CONFIG_SPI_FLASH_MACRONIX=y</span>
<a id="__codelineno-28-52" name="__codelineno-28-52" href="#__codelineno-28-52"></a><span class="s">CONFIG_SPI_FLASH_GIGADEVICE=y</span>
<a id="__codelineno-28-53" name="__codelineno-28-53" href="#__codelineno-28-53"></a><span class="s">CONFIG_SPI_FLASH_WINBOND=y</span>
<a id="__codelineno-28-54" name="__codelineno-28-54" href="#__codelineno-28-54"></a><span class="s">CONFIG_SPI_FLASH_ISSI=y</span>
<a id="__codelineno-28-55" name="__codelineno-28-55" href="#__codelineno-28-55"></a><span class="s">EOF</span>
<a id="__codelineno-28-56" name="__codelineno-28-56" href="#__codelineno-28-56"></a><span class="c1"># build U-Boot</span>
<a id="__codelineno-28-57" name="__codelineno-28-57" href="#__codelineno-28-57"></a>make<span class="w"> </span>clean<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>make<span class="w"> </span>mrproper
<a id="__codelineno-28-58" name="__codelineno-28-58" href="#__codelineno-28-58"></a>make<span class="w"> </span>socfpga_agilex5_defconfig<span class="w"> </span>
<a id="__codelineno-28-59" name="__codelineno-28-59" href="#__codelineno-28-59"></a><span class="c1"># use created custom configuration file to merge with the default configuration obtained in .config file. </span>
<a id="__codelineno-28-60" name="__codelineno-28-60" href="#__codelineno-28-60"></a>./scripts/kconfig/merge_config.sh<span class="w"> </span>-O<span class="w"> </span>.<span class="w"> </span>-m<span class="w"> </span>.config<span class="w"> </span>config-fragment
<a id="__codelineno-28-61" name="__codelineno-28-61" href="#__codelineno-28-61"></a>make<span class="w"> </span>-j<span class="w"> </span><span class="m">64</span>
<a id="__codelineno-28-62" name="__codelineno-28-62" href="#__codelineno-28-62"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<p>The following files are created:</p>
<ul>
<li><code>$TOP_FOLDER/u-boot-socfpga/u-boot.itb</code></li>
<li><code>$TOP_FOLDER/u-boot-socfpga/spl/u-boot-spl-dtb.hex</code></li>
</ul>
<h4>Build QSPI Image</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>agilex5_soc_devkit_ghrd/output_files/legacy_baseline.sof<span class="w"> </span>ghrd.jic<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>-o<span class="w"> </span><span class="nv">device</span><span class="o">=</span>MT25QU128<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>-o<span class="w"> </span><span class="nv">flash_loader</span><span class="o">=</span>A5ED065BB32AE6SR0<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>-o<span class="w"> </span><span class="nv">hps_path</span><span class="o">=</span><span class="nv">$TOP_FOLDER</span>/u-boot-socfpga/spl/u-boot-spl-dtb.hex<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>-o<span class="w"> </span><span class="nv">mode</span><span class="o">=</span>ASX4<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>-o<span class="w"> </span><span class="nv">hps</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li><code>$TOP_FOLDER/ghrd.hps.jic</code></li>
</ul>
<h4>Build HPS RBF</h4>

<p>This is an optional step, in which you can build an HPS RBF file, which can be used to configure the HPS through JTAG instead of QSPI though the JIC file.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>agilex5_soc_devkit_ghrd/output_files/legacy_baseline.sof<span class="w"> </span>ghrd.rbf<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>-o<span class="w"> </span><span class="nv">hps_path</span><span class="o">=</span><span class="nv">$TOP_FOLDER</span>/u-boot-socfpga/spl/u-boot-spl-dtb.hex<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>-o<span class="w"> </span><span class="nv">hps</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li>`$TOP_FOLDER/ghrd.hps.rbf</li>
</ul>
<h4>Build Linux</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>linux-socfpga
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS25.1.1_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-fpga/linux-socfpga
<a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="nb">cd</span><span class="w"> </span>linux-socfpga
<a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a>make<span class="w"> </span>defconfig<span class="w"> </span>
<a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a>make<span class="w"> </span>-j<span class="w"> </span><span class="m">64</span><span class="w"> </span>Image<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>make<span class="w"> </span>intel/socfpga_agilex5_socdk_emmc.dtb<span class="w"> </span>
</code></pre></div>
<p>The following files are created:</p>
<ul>
<li><code>$TOP_FOLDER/linux-socfpga/arch/arm64/boot/dts/intel/socfpga_agilex5_socdk_emmc.dtb</code></li>
<li><code>$TOP_FOLDER/linux-socfpga/arch/arm64/boot/Image</code></li>
</ul>
<h4>Build Rootfs</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>yocto<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>yocto<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>yocto
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>walnascar<span class="w"> </span>https://git.yoctoproject.org/poky
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>walnascar<span class="w"> </span>https://git.yoctoproject.org/meta-intel-fpga
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>walnascar<span class="w"> </span>https://github.com/openembedded/meta-openembedded
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="c1"># work around issue</span>
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;do_package_qa[noexec] = &quot;1&quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="k">$(</span>find<span class="w"> </span>meta-intel-fpga<span class="w"> </span>-name<span class="w"> </span>linux-socfpga_6.6.bb<span class="k">)</span>
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="nb">source</span><span class="w"> </span>poky/oe-init-build-env<span class="w"> </span>./build
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;MACHINE = &quot;agilex5_dk_a5e065bb32aes1&quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>conf/local.conf
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;BBLAYERS += &quot; ${TOPDIR}/../meta-intel-fpga &quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>conf/bblayers.conf
<a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;BBLAYERS += &quot; ${TOPDIR}/../meta-openembedded/meta-oe &quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>conf/bblayers.conf
<a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;CORE_IMAGE_EXTRA_INSTALL += &quot;openssh gdbserver&quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>conf/local.conf
<a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a>bitbake<span class="w"> </span>core-image-minimal
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li><code>$TOP_FOLDER/yocto/build/tmp/deploy/images/agilex5_dk_a5e065bb32aes1/core-image-minimal-agilex5_dk_a5e065bb32aes1.rootfs.tar.gz</code></li>
</ul>
<h4>Create eMMC Image</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>sudo<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>sd_card<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>sd_card<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>sd_card
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>wget<span class="w"> </span>https://releases.rocketboards.org/release/2020.11/gsrd/tools/make_sdimage_p3.py
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/\&quot;\-F 32\&quot;,//g&#39;</span><span class="w"> </span>make_sdimage_p3.py
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>chmod<span class="w"> </span>+x<span class="w"> </span>make_sdimage_p3.py
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>mkdir<span class="w"> </span>fatfs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">  </span><span class="nb">cd</span><span class="w"> </span>fatfs
<a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a>cp<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/ghrd.core.rbf<span class="w"> </span>.
<a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a>cp<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/u-boot-socfpga/u-boot.itb<span class="w"> </span>.
<a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a>cp<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/linux-socfpga/arch/arm64/boot/Image<span class="w"> </span>.
<a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a>cp<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/linux-socfpga/arch/arm64/boot/dts/intel/socfpga_agilex5_socdk_emmc.dtb<span class="w"> </span>.
<a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a><span class="nb">cd</span><span class="w"> </span>..
<a id="__codelineno-33-12" name="__codelineno-33-12" href="#__codelineno-33-12"></a>mkdir<span class="w"> </span>rootfs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>rootfs
<a id="__codelineno-33-13" name="__codelineno-33-13" href="#__codelineno-33-13"></a>sudo<span class="w"> </span>tar<span class="w"> </span>xf<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/yocto/build/tmp/deploy/images/agilex5_dk_a5e065bb32aes1/core-image-minimal-agilex5_dk_a5e065bb32aes1.rootfs.tar.gz
<a id="__codelineno-33-14" name="__codelineno-33-14" href="#__codelineno-33-14"></a><span class="nb">cd</span><span class="w"> </span>..
<a id="__codelineno-33-15" name="__codelineno-33-15" href="#__codelineno-33-15"></a>sudo<span class="w"> </span>python3<span class="w"> </span>make_sdimage_p3.py<span class="w"> </span>-f<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-33-16" name="__codelineno-33-16" href="#__codelineno-33-16"></a>-P<span class="w"> </span>fatfs/*,num<span class="o">=</span><span class="m">1</span>,format<span class="o">=</span>fat32,size<span class="o">=</span>64M<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-33-17" name="__codelineno-33-17" href="#__codelineno-33-17"></a>-P<span class="w"> </span>rootfs/*,num<span class="o">=</span><span class="m">2</span>,format<span class="o">=</span>ext3,size<span class="o">=</span>64M<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-33-18" name="__codelineno-33-18" href="#__codelineno-33-18"></a>-s<span class="w"> </span>140M<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-33-19" name="__codelineno-33-19" href="#__codelineno-33-19"></a>-n<span class="w"> </span>sdcard.img
<a id="__codelineno-33-20" name="__codelineno-33-20" href="#__codelineno-33-20"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li><code>$TOP_FOLDER/sd_card/sdcard.img</code></li>
</ul>
<h4>Create Helper JIC</h4>
<p>In this section we are building a helper JIC which will boot from QSPI and will allow us to program the eMMC from U-Boot.</p>
<p>1. Create the jic helper folder to contain all related build artifacts:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>rm<span class="w"> </span>-rf<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/helper-jic
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>mkdir<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/helper-jic
</code></pre></div>
<p>2. Build a modified U-Boot, which boots from QSPI and stops at command line prompt:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>/helper-jic
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>u-boot-socfpga
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS25.1.1_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-fpga/u-boot-socfpga
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="nb">cd</span><span class="w"> </span>u-boot-socfpga<span class="w"> </span>
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="c1"># enable dwarf4 debug info, for compatibility with arm ds</span>
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/PLATFORM_CPPFLAGS += -D__ARM__/PLATFORM_CPPFLAGS += -D__ARM__ -gdwarf-4/g&#39;</span><span class="w"> </span>arch/arm/config.mk
<a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a><span class="c1"># only boot from SD, do not try QSPI and NAND</span>
<a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/u-boot,spl-boot-order.*/u-boot\,spl-boot-order = \&amp;flash0;/g&#39;</span><span class="w"> </span>arch/arm/dts/socfpga_agilex5_socdk-u-boot.dtsi
<a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a><span class="c1"># disable NAND in the device tree</span>
<a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;/&amp;nand {/!b;n;c\\tstatus = &quot;disabled&quot;;&#39;</span><span class="w"> </span>arch/arm/dts/socfpga_agilex5_socdk-u-boot.dtsi
<a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a><span class="c1"># swap gmac0 and gmac2</span>
<a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;/&amp;gmac2/ { N; s/status = &quot;okay&quot;/status = &quot;disabled&quot;/; }&#39;</span><span class="w"> </span>arch/arm/dts/socfpga_agilex5_socdk.dts
<a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;/&amp;gmac0/ { N; s/status = &quot;disabled&quot;/status = &quot;okay&quot;/; }&#39;</span><span class="w"> </span>arch/arm/dts/socfpga_agilex5_socdk.dts
<a id="__codelineno-35-14" name="__codelineno-35-14" href="#__codelineno-35-14"></a><span class="c1"># link to atf</span>
<a id="__codelineno-35-15" name="__codelineno-35-15" href="#__codelineno-35-15"></a>ln<span class="w"> </span>-s<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/arm-trusted-firmware/build/agilex5/release/bl31.bin<span class="w"> </span>
<a id="__codelineno-35-16" name="__codelineno-35-16" href="#__codelineno-35-16"></a><span class="c1"># create configuration custom file. </span>
<a id="__codelineno-35-17" name="__codelineno-35-17" href="#__codelineno-35-17"></a>cat<span class="w"> </span><span class="s">&lt;&lt; EOF &gt; config-fragment</span>
<a id="__codelineno-35-18" name="__codelineno-35-18" href="#__codelineno-35-18"></a><span class="s"># use Image instead of kernel.itb</span>
<a id="__codelineno-35-19" name="__codelineno-35-19" href="#__codelineno-35-19"></a><span class="s">CONFIG_BOOTFILE=&quot;Image&quot;</span>
<a id="__codelineno-35-20" name="__codelineno-35-20" href="#__codelineno-35-20"></a><span class="s"># disable NAND/UBI related settings from defconfig. </span>
<a id="__codelineno-35-21" name="__codelineno-35-21" href="#__codelineno-35-21"></a><span class="s">CONFIG_NAND_BOOT=n</span>
<a id="__codelineno-35-22" name="__codelineno-35-22" href="#__codelineno-35-22"></a><span class="s">CONFIG_SPL_NAND_SUPPORT=n</span>
<a id="__codelineno-35-23" name="__codelineno-35-23" href="#__codelineno-35-23"></a><span class="s">CONFIG_CMD_NAND_TRIMFFS=n</span>
<a id="__codelineno-35-24" name="__codelineno-35-24" href="#__codelineno-35-24"></a><span class="s">CONFIG_CMD_NAND_LOCK_UNLOCK=n</span>
<a id="__codelineno-35-25" name="__codelineno-35-25" href="#__codelineno-35-25"></a><span class="s">CONFIG_NAND_DENALI_DT=n</span>
<a id="__codelineno-35-26" name="__codelineno-35-26" href="#__codelineno-35-26"></a><span class="s">CONFIG_SYS_NAND_U_BOOT_LOCATIONS=n</span>
<a id="__codelineno-35-27" name="__codelineno-35-27" href="#__codelineno-35-27"></a><span class="s">CONFIG_SPL_NAND_FRAMEWORK=n</span>
<a id="__codelineno-35-28" name="__codelineno-35-28" href="#__codelineno-35-28"></a><span class="s">CONFIG_CMD_NAND=n</span>
<a id="__codelineno-35-29" name="__codelineno-35-29" href="#__codelineno-35-29"></a><span class="s">CONFIG_MTD_RAW_NAND=n</span>
<a id="__codelineno-35-30" name="__codelineno-35-30" href="#__codelineno-35-30"></a><span class="s">CONFIG_CMD_UBI=n</span>
<a id="__codelineno-35-31" name="__codelineno-35-31" href="#__codelineno-35-31"></a><span class="s">CONFIG_CMD_UBIFS=n</span>
<a id="__codelineno-35-32" name="__codelineno-35-32" href="#__codelineno-35-32"></a><span class="s">CONFIG_MTD_UBI=n</span>
<a id="__codelineno-35-33" name="__codelineno-35-33" href="#__codelineno-35-33"></a><span class="s">CONFIG_ENV_IS_IN_UBI=n</span>
<a id="__codelineno-35-34" name="__codelineno-35-34" href="#__codelineno-35-34"></a><span class="s">CONFIG_UBI_SILENCE_MSG=n</span>
<a id="__codelineno-35-35" name="__codelineno-35-35" href="#__codelineno-35-35"></a><span class="s">CONFIG_UBIFS_SILENCE_MSG=n</span>
<a id="__codelineno-35-36" name="__codelineno-35-36" href="#__codelineno-35-36"></a><span class="s"># disable distroboot and use specific boot command. </span>
<a id="__codelineno-35-37" name="__codelineno-35-37" href="#__codelineno-35-37"></a><span class="s">CONFIG_DISTRO_DEFAULTS=n</span>
<a id="__codelineno-35-38" name="__codelineno-35-38" href="#__codelineno-35-38"></a><span class="s">CONFIG_HUSH_PARSER=y</span>
<a id="__codelineno-35-39" name="__codelineno-35-39" href="#__codelineno-35-39"></a><span class="s">CONFIG_SYS_PROMPT_HUSH_PS2=&quot;&gt; &quot;</span>
<a id="__codelineno-35-40" name="__codelineno-35-40" href="#__codelineno-35-40"></a><span class="s">CONFIG_USE_BOOTCOMMAND=y</span>
<a id="__codelineno-35-41" name="__codelineno-35-41" href="#__codelineno-35-41"></a><span class="s">CONFIG_BOOTCOMMAND=&quot;echo hello&quot;</span>
<a id="__codelineno-35-42" name="__codelineno-35-42" href="#__codelineno-35-42"></a><span class="s">CONFIG_CMD_FAT=y</span>
<a id="__codelineno-35-43" name="__codelineno-35-43" href="#__codelineno-35-43"></a><span class="s">CONFIG_CMD_FS_GENERIC=y</span>
<a id="__codelineno-35-44" name="__codelineno-35-44" href="#__codelineno-35-44"></a><span class="s">CONFIG_DOS_PARTITION=y</span>
<a id="__codelineno-35-45" name="__codelineno-35-45" href="#__codelineno-35-45"></a><span class="s">CONFIG_SPL_DOS_PARTITION=y</span>
<a id="__codelineno-35-46" name="__codelineno-35-46" href="#__codelineno-35-46"></a><span class="s">CONFIG_CMD_PART=y</span>
<a id="__codelineno-35-47" name="__codelineno-35-47" href="#__codelineno-35-47"></a><span class="s">CONFIG_SPL_CRC32=y</span>
<a id="__codelineno-35-48" name="__codelineno-35-48" href="#__codelineno-35-48"></a><span class="s">CONFIG_LZO=y</span>
<a id="__codelineno-35-49" name="__codelineno-35-49" href="#__codelineno-35-49"></a><span class="s">CONFIG_CMD_DHCP=y</span>
<a id="__codelineno-35-50" name="__codelineno-35-50" href="#__codelineno-35-50"></a><span class="s"># enable more QSPI flash manufacturers</span>
<a id="__codelineno-35-51" name="__codelineno-35-51" href="#__codelineno-35-51"></a><span class="s">CONFIG_SPI_FLASH_MACRONIX=y</span>
<a id="__codelineno-35-52" name="__codelineno-35-52" href="#__codelineno-35-52"></a><span class="s">CONFIG_SPI_FLASH_GIGADEVICE=y</span>
<a id="__codelineno-35-53" name="__codelineno-35-53" href="#__codelineno-35-53"></a><span class="s">CONFIG_SPI_FLASH_WINBOND=y</span>
<a id="__codelineno-35-54" name="__codelineno-35-54" href="#__codelineno-35-54"></a><span class="s">CONFIG_SPI_FLASH_ISSI=y</span>
<a id="__codelineno-35-55" name="__codelineno-35-55" href="#__codelineno-35-55"></a><span class="s"># boot from QSPI</span>
<a id="__codelineno-35-56" name="__codelineno-35-56" href="#__codelineno-35-56"></a><span class="s">CONFIG_ENV_IS_IN_FAT=n</span>
<a id="__codelineno-35-57" name="__codelineno-35-57" href="#__codelineno-35-57"></a><span class="s">CONFIG_ENV_IS_NOWHERE=y</span>
<a id="__codelineno-35-58" name="__codelineno-35-58" href="#__codelineno-35-58"></a><span class="s">CONFIG_SYS_SPI_U_BOOT_OFFS=0x00300000</span>
<a id="__codelineno-35-59" name="__codelineno-35-59" href="#__codelineno-35-59"></a><span class="s">EOF</span>
<a id="__codelineno-35-60" name="__codelineno-35-60" href="#__codelineno-35-60"></a><span class="c1"># build U-Boot</span>
<a id="__codelineno-35-61" name="__codelineno-35-61" href="#__codelineno-35-61"></a>make<span class="w"> </span>clean<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>make<span class="w"> </span>mrproper
<a id="__codelineno-35-62" name="__codelineno-35-62" href="#__codelineno-35-62"></a>make<span class="w"> </span>socfpga_agilex5_defconfig<span class="w"> </span>
<a id="__codelineno-35-63" name="__codelineno-35-63" href="#__codelineno-35-63"></a><span class="c1"># use created custom configuration file to merge with the default configuration obtained in .config file. </span>
<a id="__codelineno-35-64" name="__codelineno-35-64" href="#__codelineno-35-64"></a>./scripts/kconfig/merge_config.sh<span class="w"> </span>-O<span class="w"> </span>.<span class="w"> </span>-m<span class="w"> </span>.config<span class="w"> </span>config-fragment
<a id="__codelineno-35-65" name="__codelineno-35-65" href="#__codelineno-35-65"></a>make<span class="w"> </span>-j<span class="w"> </span><span class="m">64</span>
<a id="__codelineno-35-66" name="__codelineno-35-66" href="#__codelineno-35-66"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<p>The following files are created:</p>
<ul>
<li><code>$TOP_FOLDER/u-boot-socfpga/u-boot.itb</code></li>
<li><code>$TOP_FOLDER/u-boot-socfpga/spl/u-boot-spl-dtb.hex</code></li>
</ul>
<p>3. Build the helper JIC:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>/helper-jic
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>rm<span class="w"> </span>-f<span class="w"> </span>flash.pfg<span class="w"> </span>fpga.sof<span class="w"> </span>u-boot.bin<span class="w"> </span>spl.hex<span class="w"> </span>*.jic<span class="w"> </span>*.rbf
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>ln<span class="w"> </span>-s<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/agilex5_soc_devkit_ghrd/output_files/legacy_baseline.sof<span class="w"> </span>fpga.sof
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>ln<span class="w"> </span>-s<span class="w"> </span>u-boot-socfpga/u-boot.itb<span class="w"> </span>u-boot.bin
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a>ln<span class="w"> </span>-s<span class="w"> </span>u-boot-socfpga/spl/u-boot-spl-dtb.hex<span class="w"> </span>spl.hex
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a>cat<span class="w"> </span><span class="s">&lt;&lt; EOF &gt; flash.pfg</span>
<a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a><span class="s">&lt;pfg version=&quot;1&quot;&gt;</span>
<a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a><span class="s">    &lt;settings custom_db_dir=&quot;./&quot; mode=&quot;ASX4&quot;/&gt;</span>
<a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a><span class="s">    &lt;output_files&gt;</span>
<a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a><span class="s">        &lt;output_file name=&quot;flash&quot; hps=&quot;1&quot; directory=&quot;./&quot; type=&quot;PERIPH_JIC&quot;&gt;</span>
<a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a><span class="s">            &lt;file_options/&gt;</span>
<a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a><span class="s">            &lt;secondary_file type=&quot;MAP&quot; name=&quot;flash_jic&quot;&gt;</span>
<a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a><span class="s">                &lt;file_options/&gt;</span>
<a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a><span class="s">            &lt;/secondary_file&gt;</span>
<a id="__codelineno-36-15" name="__codelineno-36-15" href="#__codelineno-36-15"></a><span class="s">            &lt;flash_device_id&gt;Flash_Device_1&lt;/flash_device_id&gt;</span>
<a id="__codelineno-36-16" name="__codelineno-36-16" href="#__codelineno-36-16"></a><span class="s">        &lt;/output_file&gt;</span>
<a id="__codelineno-36-17" name="__codelineno-36-17" href="#__codelineno-36-17"></a><span class="s">    &lt;/output_files&gt;</span>
<a id="__codelineno-36-18" name="__codelineno-36-18" href="#__codelineno-36-18"></a><span class="s">    &lt;bitstreams&gt;</span>
<a id="__codelineno-36-19" name="__codelineno-36-19" href="#__codelineno-36-19"></a><span class="s">        &lt;bitstream id=&quot;Bitstream_1&quot;&gt;</span>
<a id="__codelineno-36-20" name="__codelineno-36-20" href="#__codelineno-36-20"></a><span class="s">            &lt;path signing=&quot;OFF&quot; finalize_encryption=&quot;0&quot; hps_path=&quot;spl.hex&quot;&gt;fpga.sof&lt;/path&gt;</span>
<a id="__codelineno-36-21" name="__codelineno-36-21" href="#__codelineno-36-21"></a><span class="s">        &lt;/bitstream&gt;</span>
<a id="__codelineno-36-22" name="__codelineno-36-22" href="#__codelineno-36-22"></a><span class="s">    &lt;/bitstreams&gt;</span>
<a id="__codelineno-36-23" name="__codelineno-36-23" href="#__codelineno-36-23"></a><span class="s">    &lt;raw_files&gt;</span>
<a id="__codelineno-36-24" name="__codelineno-36-24" href="#__codelineno-36-24"></a><span class="s">        &lt;raw_file bitswap=&quot;1&quot; type=&quot;RBF&quot; id=&quot;Raw_File_1&quot;&gt;u-boot.bin&lt;/raw_file&gt;</span>
<a id="__codelineno-36-25" name="__codelineno-36-25" href="#__codelineno-36-25"></a><span class="s">    &lt;/raw_files&gt;</span>
<a id="__codelineno-36-26" name="__codelineno-36-26" href="#__codelineno-36-26"></a><span class="s">    &lt;flash_devices&gt;</span>
<a id="__codelineno-36-27" name="__codelineno-36-27" href="#__codelineno-36-27"></a><span class="s">        &lt;flash_device type=&quot;MT25QU128&quot; id=&quot;Flash_Device_1&quot;&gt;</span>
<a id="__codelineno-36-28" name="__codelineno-36-28" href="#__codelineno-36-28"></a><span class="s">            &lt;partition reserved=&quot;1&quot; fixed_s_addr=&quot;1&quot; s_addr=&quot;0x00000000&quot; e_addr=&quot;0x001FFFFF&quot; fixed_e_addr=&quot;1&quot; id=&quot;BOOT_INFO&quot; size=&quot;0&quot;/&gt;</span>
<a id="__codelineno-36-29" name="__codelineno-36-29" href="#__codelineno-36-29"></a><span class="s">            &lt;partition reserved=&quot;0&quot; fixed_s_addr=&quot;0&quot; s_addr=&quot;auto&quot; e_addr=&quot;auto&quot; fixed_e_addr=&quot;0&quot; id=&quot;P1&quot; size=&quot;0&quot;/&gt;</span>
<a id="__codelineno-36-30" name="__codelineno-36-30" href="#__codelineno-36-30"></a><span class="s">            &lt;partition reserved=&quot;0&quot; fixed_s_addr=&quot;0&quot; s_addr=&quot;0x00300000&quot; e_addr=&quot;0x004CFFFF&quot; fixed_e_addr=&quot;1&quot; id=&quot;u-boot&quot; size=&quot;0&quot;/&gt;</span>
<a id="__codelineno-36-31" name="__codelineno-36-31" href="#__codelineno-36-31"></a><span class="s">        &lt;/flash_device&gt;</span>
<a id="__codelineno-36-32" name="__codelineno-36-32" href="#__codelineno-36-32"></a><span class="s">        &lt;flash_loader&gt;A5ED065BB32AE5SR0&lt;/flash_loader&gt;</span>
<a id="__codelineno-36-33" name="__codelineno-36-33" href="#__codelineno-36-33"></a><span class="s">    &lt;/flash_devices&gt;</span>
<a id="__codelineno-36-34" name="__codelineno-36-34" href="#__codelineno-36-34"></a><span class="s">    &lt;assignments&gt;</span>
<a id="__codelineno-36-35" name="__codelineno-36-35" href="#__codelineno-36-35"></a><span class="s">        &lt;assignment page=&quot;0&quot; partition_id=&quot;P1&quot;&gt;</span>
<a id="__codelineno-36-36" name="__codelineno-36-36" href="#__codelineno-36-36"></a><span class="s">            &lt;bitstream_id&gt;Bitstream_1&lt;/bitstream_id&gt;</span>
<a id="__codelineno-36-37" name="__codelineno-36-37" href="#__codelineno-36-37"></a><span class="s">        &lt;/assignment&gt;</span>
<a id="__codelineno-36-38" name="__codelineno-36-38" href="#__codelineno-36-38"></a><span class="s">        &lt;assignment page=&quot;0&quot; partition_id=&quot;u-boot&quot;&gt;</span>
<a id="__codelineno-36-39" name="__codelineno-36-39" href="#__codelineno-36-39"></a><span class="s">            &lt;raw_file_id&gt;Raw_File_1&lt;/raw_file_id&gt;</span>
<a id="__codelineno-36-40" name="__codelineno-36-40" href="#__codelineno-36-40"></a><span class="s">        &lt;/assignment&gt;</span>
<a id="__codelineno-36-41" name="__codelineno-36-41" href="#__codelineno-36-41"></a><span class="s">    &lt;/assignments&gt;</span>
<a id="__codelineno-36-42" name="__codelineno-36-42" href="#__codelineno-36-42"></a><span class="s">&lt;/pfg&gt;</span>
<a id="__codelineno-36-43" name="__codelineno-36-43" href="#__codelineno-36-43"></a><span class="s">EOF</span>
<a id="__codelineno-36-44" name="__codelineno-36-44" href="#__codelineno-36-44"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>flash.pfg
</code></pre></div>
<p>The following file will be created:</p>
<ul>
<li><code>$TOP_FOLDER/helper-jic/flash.hps.jic</code></li>
</ul>
<h4>Write eMMC Image</h4>

<p>1. Write the helper JIC to QSPI:</p>
<ul>
<li>Power down board</li>
<li>Set MSEL dipswitch SW27 to JTAG: OFF-OFF-OFF-OFF</li>
<li>Power up the board</li>
<li>Write JIC image to QSPI:
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>jtagconfig<span class="w"> </span>--setparam<span class="w"> </span><span class="m">1</span><span class="w"> </span>JtagClock<span class="w"> </span>16M
<a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>quartus_pgm<span class="w"> </span>-c<span class="w"> </span><span class="m">1</span><span class="w"> </span>-m<span class="w"> </span>jtag<span class="w"> </span>-o<span class="w"> </span><span class="s2">&quot;pvi;helper-jic/flash.hps.jic&quot;</span>
</code></pre></div>
</li></ul>

<p>2. Boot to U-Boot prompt with the helper JIC:</p>
<ul>
<li>Power down board</li>
<li>Set MSEL dipswitch SW27 to ASX4 (QSPi): OFF-ON-ON-OFF</li>
<li>Power up the board</li>
<li>Wait for U-Boot to boot, press any key to get to U-Boot console</li></ul>

<p>3. Use <code>ifconfig</code> on your host machine to determine the IP of your TFTP server</p>
<p>4. Copy the eMMC image <code>$TOP_FOLDER/sd_card/sdcard.img</code> to your TFTP server folder</p>
<p>5. Use the following U-Boot commands to download and write the eMMC image:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>setenv<span class="w"> </span>autoload<span class="w"> </span>no
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>dhcp
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a>setenv<span class="w"> </span>serverip<span class="w"> </span>&lt;your_tftp_server_ip&gt;
<a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>tftp<span class="w"> </span><span class="si">${</span><span class="nv">loadaddr</span><span class="si">}</span><span class="w"> </span>sdcard.img
<a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a>setexpr<span class="w"> </span>blkcnt<span class="w"> </span><span class="si">${</span><span class="nv">filesize</span><span class="si">}</span><span class="w"> </span>/<span class="w"> </span>0x200
<a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a>mmc<span class="w"> </span>write<span class="w"> </span><span class="si">${</span><span class="nv">loadaddr</span><span class="si">}</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="si">${</span><span class="nv">blkcnt</span><span class="si">}</span>
</code></pre></div>
<h4>Write QSPI Flash</h4>

<p>1. Power down board</p>
<p>2. Set MSEL dipswitch SW27 to JTAG: OFF-OFF-OFF-OFF</p>
<p>3. Power up the board</p>
<p>4. Write JIC image to QSPI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>jtagconfig<span class="w"> </span>--setparam<span class="w"> </span><span class="m">1</span><span class="w"> </span>JtagClock<span class="w"> </span>16M
<a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>quartus_pgm<span class="w"> </span>-c<span class="w"> </span><span class="m">1</span><span class="w"> </span>-m<span class="w"> </span>jtag<span class="w"> </span>-o<span class="w"> </span><span class="s2">&quot;pvi;ghrd.hps.jic&quot;</span>
</code></pre></div>
<h4>Boot Linux</h4>

<p>1. Power down board</p>
<p>2. Set MSEL dipswitch SW27 to ASX4 (QSPi): OFF-ON-ON-OFF</p>
<p>3. Power up the board</p>
<p>4. Wait for Linux to boot, use <code>root</code> as user name, and no password wil be requested.</p>
<h2 id="hps-test-board">HPS Test Board<a class="headerlink" href="#hps-test-board" title="Permanent link">&para;</a></h2>
<p>This section demonstrates how to build a Linux system from separate components, targetting the HPS Test Board. Boot source is SD Card.</p>
<h3 id="boot-from-sd-card_1">Boot from SD Card<a class="headerlink" href="#boot-from-sd-card_1" title="Permanent link">&para;</a></h3>
<h4>Setup Environment</h4>

<p>1. Create the top folder to store all the build artifacts:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>sudo<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>agilex5_boot.test
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>mkdir<span class="w"> </span>agilex5_boot.test
<a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="nb">cd</span><span class="w"> </span>agilex5_boot.test
<a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="nb">export</span><span class="w"> </span><span class="nv">TOP_FOLDER</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
</code></pre></div>
<p>Download the compiler toolchain, add it to the PATH variable, to be used by the GHRD makefile to build the HPS Debug FSBL:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>wget<span class="w"> </span>https://developer.arm.com/-/media/Files/downloads/gnu/14.3.rel1/binrel/<span class="se">\</span>
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a>arm-gnu-toolchain-14.3.rel1-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a>tar<span class="w"> </span>xf<span class="w"> </span>arm-gnu-toolchain-14.3.rel1-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a>rm<span class="w"> </span>-f<span class="w"> </span>arm-gnu-toolchain-14.3.rel1-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>/arm-gnu-toolchain-14.3.rel1-x86_64-aarch64-none-linux-gnu/bin/:<span class="nv">$PATH</span>
<a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a><span class="nb">export</span><span class="w"> </span><span class="nv">ARCH</span><span class="o">=</span>arm64
<a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a><span class="nb">export</span><span class="w"> </span><span class="nv">CROSS_COMPILE</span><span class="o">=</span>aarch64-none-linux-gnu-
</code></pre></div>
<p>Enable Quartus tools to be called from command line:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_ROOTDIR</span><span class="o">=</span>~/altera_pro/25.1.1/quartus/
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>/bin:<span class="nv">$QUARTUS_ROOTDIR</span>/linux64:<span class="nv">$QUARTUS_ROOTDIR</span>/../qsys/bin:<span class="nv">$PATH</span>
</code></pre></div>
<h4>Build Hardware Design</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>agilex5_soc_devkit_ghrd<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>agilex5_soc_devkit_ghrd<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>agilex5_soc_devkit_ghrd
<a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a>wget<span class="w"> </span>https://github.com/altera-fpga/agilex5e-ed-gsrd/releases/download/QPDS25.1.1_REL_GSRD_PR/a5ed065es-premium-devkit-debug2-legacy-baseline.zip
<a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a>unzip<span class="w"> </span>a5ed065es-premium-devkit-debug2-legacy-baseline.zip
<a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a>rm<span class="w"> </span>-f<span class="w"> </span>a5ed065es-premium-devkit-debug2-legacy-baseline.zip
<a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a>make<span class="w"> </span>legacy_baseline-build
<a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a>make<span class="w"> </span>legacy_baseline-sw-build
<a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>output_files/legacy_baseline.sof<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a><span class="w">  </span>output_files/legacy_baseline_hps_debug.sof<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a><span class="w">  </span>-o<span class="w"> </span><span class="nv">hps_path</span><span class="o">=</span>software/hps_debug/hps_wipe.ihex
<a id="__codelineno-43-11" name="__codelineno-43-11" href="#__codelineno-43-11"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<p>The following files are created:</p>
<ul>
<li><code>$TOP_FOLDER/agilex5_soc_devkit_ghrd/output_files/legacy_baseline.sof</code></li>
<li><code>$TOP_FOLDER/agilex5_soc_devkit_ghrd/output_files/legacy_baseline_hps_debug.sof</code></li>
</ul>
<h4>Build Arm Trusted Firmware</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>arm-trusted-firmware
<a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS25.1.1_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-fpga/arm-trusted-firmware
<a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a><span class="nb">cd</span><span class="w"> </span>arm-trusted-firmware
<a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a>make<span class="w"> </span>-j<span class="w"> </span><span class="m">48</span><span class="w"> </span><span class="nv">PLAT</span><span class="o">=</span>agilex5<span class="w"> </span>bl31<span class="w"> </span>
<a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li><code>$TOP_FOLDER/arm-trusted-firmware/build/agilex5/release/bl31.bin</code></li>
</ul>
<h4>Build U-Boot</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>u-boot-socfpga
<a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS25.1.1_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-fpga/u-boot-socfpga
<a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a><span class="nb">cd</span><span class="w"> </span>u-boot-socfpga<span class="w"> </span>
<a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a><span class="c1"># enable dwarf4 debug info, for compatibility with arm ds</span>
<a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/PLATFORM_CPPFLAGS += -D__ARM__/PLATFORM_CPPFLAGS += -D__ARM__ -gdwarf-4/g&#39;</span><span class="w"> </span>arch/arm/config.mk
<a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a><span class="c1"># only boot from SD, do not try QSPI and NAND</span>
<a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/u-boot,spl-boot-order.*/u-boot\,spl-boot-order = \&amp;mmc;/g&#39;</span><span class="w"> </span>arch/arm/dts/socfpga_agilex5_socdk-u-boot.dtsi
<a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a><span class="c1"># disable NAND in the device tree</span>
<a id="__codelineno-45-10" name="__codelineno-45-10" href="#__codelineno-45-10"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;/&amp;nand {/!b;n;c\\tstatus = &quot;disabled&quot;;&#39;</span><span class="w"> </span>arch/arm/dts/socfpga_agilex5_socdk-u-boot.dtsi
<a id="__codelineno-45-11" name="__codelineno-45-11" href="#__codelineno-45-11"></a><span class="c1"># swap gmac0 and gmac2</span>
<a id="__codelineno-45-12" name="__codelineno-45-12" href="#__codelineno-45-12"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;/&amp;gmac2/ { N; s/status = &quot;okay&quot;/status = &quot;disabled&quot;/; }&#39;</span><span class="w"> </span>arch/arm/dts/socfpga_agilex5_socdk.dts
<a id="__codelineno-45-13" name="__codelineno-45-13" href="#__codelineno-45-13"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;/&amp;gmac0/ { N; s/status = &quot;disabled&quot;/status = &quot;okay&quot;/; }&#39;</span><span class="w"> </span>arch/arm/dts/socfpga_agilex5_socdk.dts
<a id="__codelineno-45-14" name="__codelineno-45-14" href="#__codelineno-45-14"></a><span class="c1"># link to atf</span>
<a id="__codelineno-45-15" name="__codelineno-45-15" href="#__codelineno-45-15"></a>ln<span class="w"> </span>-s<span class="w"> </span>../arm-trusted-firmware/build/agilex5/release/bl31.bin<span class="w"> </span>
<a id="__codelineno-45-16" name="__codelineno-45-16" href="#__codelineno-45-16"></a><span class="c1"># create configuration custom file. </span>
<a id="__codelineno-45-17" name="__codelineno-45-17" href="#__codelineno-45-17"></a>cat<span class="w"> </span><span class="s">&lt;&lt; EOF &gt; config-fragment</span>
<a id="__codelineno-45-18" name="__codelineno-45-18" href="#__codelineno-45-18"></a><span class="s"># use Image instead of kernel.itb</span>
<a id="__codelineno-45-19" name="__codelineno-45-19" href="#__codelineno-45-19"></a><span class="s">CONFIG_BOOTFILE=&quot;Image&quot;</span>
<a id="__codelineno-45-20" name="__codelineno-45-20" href="#__codelineno-45-20"></a><span class="s"># disable NAND/UBI related settings from defconfig. </span>
<a id="__codelineno-45-21" name="__codelineno-45-21" href="#__codelineno-45-21"></a><span class="s">CONFIG_NAND_BOOT=n</span>
<a id="__codelineno-45-22" name="__codelineno-45-22" href="#__codelineno-45-22"></a><span class="s">CONFIG_SPL_NAND_SUPPORT=n</span>
<a id="__codelineno-45-23" name="__codelineno-45-23" href="#__codelineno-45-23"></a><span class="s">CONFIG_CMD_NAND_TRIMFFS=n</span>
<a id="__codelineno-45-24" name="__codelineno-45-24" href="#__codelineno-45-24"></a><span class="s">CONFIG_CMD_NAND_LOCK_UNLOCK=n</span>
<a id="__codelineno-45-25" name="__codelineno-45-25" href="#__codelineno-45-25"></a><span class="s">CONFIG_NAND_DENALI_DT=n</span>
<a id="__codelineno-45-26" name="__codelineno-45-26" href="#__codelineno-45-26"></a><span class="s">CONFIG_SYS_NAND_U_BOOT_LOCATIONS=n</span>
<a id="__codelineno-45-27" name="__codelineno-45-27" href="#__codelineno-45-27"></a><span class="s">CONFIG_SPL_NAND_FRAMEWORK=n</span>
<a id="__codelineno-45-28" name="__codelineno-45-28" href="#__codelineno-45-28"></a><span class="s">CONFIG_CMD_NAND=n</span>
<a id="__codelineno-45-29" name="__codelineno-45-29" href="#__codelineno-45-29"></a><span class="s">CONFIG_MTD_RAW_NAND=n</span>
<a id="__codelineno-45-30" name="__codelineno-45-30" href="#__codelineno-45-30"></a><span class="s">CONFIG_CMD_UBI=n</span>
<a id="__codelineno-45-31" name="__codelineno-45-31" href="#__codelineno-45-31"></a><span class="s">CONFIG_CMD_UBIFS=n</span>
<a id="__codelineno-45-32" name="__codelineno-45-32" href="#__codelineno-45-32"></a><span class="s">CONFIG_MTD_UBI=n</span>
<a id="__codelineno-45-33" name="__codelineno-45-33" href="#__codelineno-45-33"></a><span class="s">CONFIG_ENV_IS_IN_UBI=n</span>
<a id="__codelineno-45-34" name="__codelineno-45-34" href="#__codelineno-45-34"></a><span class="s">CONFIG_UBI_SILENCE_MSG=n</span>
<a id="__codelineno-45-35" name="__codelineno-45-35" href="#__codelineno-45-35"></a><span class="s">CONFIG_UBIFS_SILENCE_MSG=n</span>
<a id="__codelineno-45-36" name="__codelineno-45-36" href="#__codelineno-45-36"></a><span class="s"># disable distroboot and use specific boot command. </span>
<a id="__codelineno-45-37" name="__codelineno-45-37" href="#__codelineno-45-37"></a><span class="s">CONFIG_DISTRO_DEFAULTS=n</span>
<a id="__codelineno-45-38" name="__codelineno-45-38" href="#__codelineno-45-38"></a><span class="s">CONFIG_HUSH_PARSER=y</span>
<a id="__codelineno-45-39" name="__codelineno-45-39" href="#__codelineno-45-39"></a><span class="s">CONFIG_SYS_PROMPT_HUSH_PS2=&quot;&gt; &quot;</span>
<a id="__codelineno-45-40" name="__codelineno-45-40" href="#__codelineno-45-40"></a><span class="s">CONFIG_USE_BOOTCOMMAND=y</span>
<a id="__codelineno-45-41" name="__codelineno-45-41" href="#__codelineno-45-41"></a><span class="s">CONFIG_BOOTCOMMAND=&quot;load mmc 0:1 \${loadaddr} ghrd.core.rbf; fpga load 0 \${loadaddr} \${filesize};bridge enable; mmc rescan; fatload mmc 0:1 82000000 Image;fatload mmc 0:1 86000000 socfpga_agilex5_socdk_debug.dtb;setenv bootargs console=ttyS0,115200 root=\${mmcroot} rw rootwait;booti 0x82000000 - 0x86000000&quot;</span>
<a id="__codelineno-45-42" name="__codelineno-45-42" href="#__codelineno-45-42"></a><span class="s">CONFIG_CMD_FAT=y</span>
<a id="__codelineno-45-43" name="__codelineno-45-43" href="#__codelineno-45-43"></a><span class="s">CONFIG_CMD_FS_GENERIC=y</span>
<a id="__codelineno-45-44" name="__codelineno-45-44" href="#__codelineno-45-44"></a><span class="s">CONFIG_DOS_PARTITION=y</span>
<a id="__codelineno-45-45" name="__codelineno-45-45" href="#__codelineno-45-45"></a><span class="s">CONFIG_SPL_DOS_PARTITION=y</span>
<a id="__codelineno-45-46" name="__codelineno-45-46" href="#__codelineno-45-46"></a><span class="s">CONFIG_CMD_PART=y</span>
<a id="__codelineno-45-47" name="__codelineno-45-47" href="#__codelineno-45-47"></a><span class="s">CONFIG_SPL_CRC32=y</span>
<a id="__codelineno-45-48" name="__codelineno-45-48" href="#__codelineno-45-48"></a><span class="s">CONFIG_LZO=y</span>
<a id="__codelineno-45-49" name="__codelineno-45-49" href="#__codelineno-45-49"></a><span class="s">CONFIG_CMD_DHCP=y</span>
<a id="__codelineno-45-50" name="__codelineno-45-50" href="#__codelineno-45-50"></a><span class="s"># enable more QSPI flash manufacturers</span>
<a id="__codelineno-45-51" name="__codelineno-45-51" href="#__codelineno-45-51"></a><span class="s">CONFIG_SPI_FLASH_MACRONIX=y</span>
<a id="__codelineno-45-52" name="__codelineno-45-52" href="#__codelineno-45-52"></a><span class="s">CONFIG_SPI_FLASH_GIGADEVICE=y</span>
<a id="__codelineno-45-53" name="__codelineno-45-53" href="#__codelineno-45-53"></a><span class="s">CONFIG_SPI_FLASH_WINBOND=y</span>
<a id="__codelineno-45-54" name="__codelineno-45-54" href="#__codelineno-45-54"></a><span class="s">CONFIG_SPI_FLASH_ISSI=y</span>
<a id="__codelineno-45-55" name="__codelineno-45-55" href="#__codelineno-45-55"></a><span class="s">EOF</span>
<a id="__codelineno-45-56" name="__codelineno-45-56" href="#__codelineno-45-56"></a><span class="c1"># build U-Boot</span>
<a id="__codelineno-45-57" name="__codelineno-45-57" href="#__codelineno-45-57"></a>make<span class="w"> </span>clean<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>make<span class="w"> </span>mrproper
<a id="__codelineno-45-58" name="__codelineno-45-58" href="#__codelineno-45-58"></a>make<span class="w"> </span>socfpga_agilex5_defconfig<span class="w"> </span>
<a id="__codelineno-45-59" name="__codelineno-45-59" href="#__codelineno-45-59"></a><span class="c1"># use created custom configuration file to merge with the default configuration obtained in .config file. </span>
<a id="__codelineno-45-60" name="__codelineno-45-60" href="#__codelineno-45-60"></a>./scripts/kconfig/merge_config.sh<span class="w"> </span>-O<span class="w"> </span>.<span class="w"> </span>-m<span class="w"> </span>.config<span class="w"> </span>config-fragment
<a id="__codelineno-45-61" name="__codelineno-45-61" href="#__codelineno-45-61"></a>make<span class="w"> </span>-j<span class="w"> </span><span class="m">64</span>
<a id="__codelineno-45-62" name="__codelineno-45-62" href="#__codelineno-45-62"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<p>The following files are created:</p>
<ul>
<li><code>$TOP_FOLDER/u-boot-socfpga/u-boot.itb</code></li>
<li><code>$TOP_FOLDER/u-boot-socfpga/spl/u-boot-spl-dtb.hex</code></li>
</ul>
<h4>Build QSPI Image</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>agilex5_soc_devkit_ghrd/output_files/legacy_baseline.sof<span class="w"> </span>ghrd.jic<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a>-o<span class="w"> </span><span class="nv">device</span><span class="o">=</span>MT25QU128<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a>-o<span class="w"> </span><span class="nv">flash_loader</span><span class="o">=</span>A5ED065BB32AE6SR0<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a>-o<span class="w"> </span><span class="nv">hps_path</span><span class="o">=</span><span class="nv">$TOP_FOLDER</span>/u-boot-socfpga/spl/u-boot-spl-dtb.hex<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a>-o<span class="w"> </span><span class="nv">mode</span><span class="o">=</span>ASX4<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a>-o<span class="w"> </span><span class="nv">hps</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li><code>$TOP_FOLDER/ghrd.hps.jic</code></li>
</ul>
<h4>Build HPS RBF</h4>

<p>This is an optional step, in which you can build an HPS RBF file, which can be used to configure the HPS through JTAG instead of QSPI though the JIC file.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>agilex5_soc_devkit_ghrd/output_files/legacy_baseline.sof<span class="w"> </span>ghrd.rbf<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a>-o<span class="w"> </span><span class="nv">hps_path</span><span class="o">=</span><span class="nv">$TOP_FOLDER</span>/u-boot-socfpga/spl/u-boot-spl-dtb.hex<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a>-o<span class="w"> </span><span class="nv">hps</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li>`$TOP_FOLDER/ghrd.hps.rbf</li>
</ul>
<h4>Build Linux</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>linux-socfpga
<a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS25.1.1_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-fpga/linux-socfpga
<a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a><span class="nb">cd</span><span class="w"> </span>linux-socfpga
<a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a>make<span class="w"> </span>defconfig<span class="w"> </span>
<a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a>make<span class="w"> </span>-j<span class="w"> </span><span class="m">64</span><span class="w"> </span>Image<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>make<span class="w"> </span>intel/socfpga_agilex5_socdk_debug.dtb<span class="w"> </span>
</code></pre></div>
<p>The following files are created:</p>
<ul>
<li><code>$TOP_FOLDER/linux-socfpga/arch/arm64/boot/dts/intel/socfpga_agilex5_socdk_debug.dtb</code></li>
<li><code>$TOP_FOLDER/linux-socfpga/arch/arm64/boot/Image</code></li>
</ul>
<h4>Build Rootfs</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>yocto<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>yocto<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>yocto
<a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>walnascar<span class="w"> </span>https://git.yoctoproject.org/poky
<a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>walnascar<span class="w"> </span>https://git.yoctoproject.org/meta-intel-fpga
<a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>walnascar<span class="w"> </span>https://github.com/openembedded/meta-openembedded
<a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a><span class="c1"># work around issue</span>
<a id="__codelineno-49-7" name="__codelineno-49-7" href="#__codelineno-49-7"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;do_package_qa[noexec] = &quot;1&quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="k">$(</span>find<span class="w"> </span>meta-intel-fpga<span class="w"> </span>-name<span class="w"> </span>linux-socfpga_6.6.bb<span class="k">)</span>
<a id="__codelineno-49-8" name="__codelineno-49-8" href="#__codelineno-49-8"></a><span class="nb">source</span><span class="w"> </span>poky/oe-init-build-env<span class="w"> </span>./build
<a id="__codelineno-49-9" name="__codelineno-49-9" href="#__codelineno-49-9"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;MACHINE = &quot;agilex5_dk_a5e065bb32aes1&quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>conf/local.conf
<a id="__codelineno-49-10" name="__codelineno-49-10" href="#__codelineno-49-10"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;BBLAYERS += &quot; ${TOPDIR}/../meta-intel-fpga &quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>conf/bblayers.conf
<a id="__codelineno-49-11" name="__codelineno-49-11" href="#__codelineno-49-11"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;BBLAYERS += &quot; ${TOPDIR}/../meta-openembedded/meta-oe &quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>conf/bblayers.conf
<a id="__codelineno-49-12" name="__codelineno-49-12" href="#__codelineno-49-12"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;CORE_IMAGE_EXTRA_INSTALL += &quot;openssh gdbserver&quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>conf/local.conf
<a id="__codelineno-49-13" name="__codelineno-49-13" href="#__codelineno-49-13"></a>bitbake<span class="w"> </span>core-image-minimal
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li><code>$TOP_FOLDER/yocto/build/tmp/deploy/images/agilex5_dk_a5e065bb32aes1/core-image-minimal-agilex5_dk_a5e065bb32aes1.rootfs.tar.gz</code></li>
</ul>
<h4>Create SD Card Image</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a>sudo<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>sd_card<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>sd_card<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>sd_card
<a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a>wget<span class="w"> </span>https://releases.rocketboards.org/release/2020.11/gsrd/tools/make_sdimage_p3.py
<a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/\&quot;\-F 32\&quot;,//g&#39;</span><span class="w"> </span>make_sdimage_p3.py
<a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a>chmod<span class="w"> </span>+x<span class="w"> </span>make_sdimage_p3.py
<a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a>mkdir<span class="w"> </span>fatfs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">  </span><span class="nb">cd</span><span class="w"> </span>fatfs
<a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a>cp<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/ghrd.core.rbf<span class="w"> </span>.
<a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a>cp<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/u-boot-socfpga/u-boot.itb<span class="w"> </span>.
<a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a>cp<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/linux-socfpga/arch/arm64/boot/Image<span class="w"> </span>.
<a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a>cp<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/linux-socfpga/arch/arm64/boot/dts/intel/socfpga_agilex5_socdk_debug.dtb<span class="w"> </span>.
<a id="__codelineno-50-11" name="__codelineno-50-11" href="#__codelineno-50-11"></a><span class="nb">cd</span><span class="w"> </span>..
<a id="__codelineno-50-12" name="__codelineno-50-12" href="#__codelineno-50-12"></a>mkdir<span class="w"> </span>rootfs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>rootfs
<a id="__codelineno-50-13" name="__codelineno-50-13" href="#__codelineno-50-13"></a>sudo<span class="w"> </span>tar<span class="w"> </span>xf<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/yocto/build/tmp/deploy/images/agilex5_dk_a5e065bb32aes1/core-image-minimal-agilex5_dk_a5e065bb32aes1.rootfs.tar.gz
<a id="__codelineno-50-14" name="__codelineno-50-14" href="#__codelineno-50-14"></a><span class="nb">cd</span><span class="w"> </span>..
<a id="__codelineno-50-15" name="__codelineno-50-15" href="#__codelineno-50-15"></a>sudo<span class="w"> </span>python3<span class="w"> </span>make_sdimage_p3.py<span class="w"> </span>-f<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-50-16" name="__codelineno-50-16" href="#__codelineno-50-16"></a>-P<span class="w"> </span>fatfs/*,num<span class="o">=</span><span class="m">1</span>,format<span class="o">=</span>fat32,size<span class="o">=</span>64M<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-50-17" name="__codelineno-50-17" href="#__codelineno-50-17"></a>-P<span class="w"> </span>rootfs/*,num<span class="o">=</span><span class="m">2</span>,format<span class="o">=</span>ext3,size<span class="o">=</span>64M<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-50-18" name="__codelineno-50-18" href="#__codelineno-50-18"></a>-s<span class="w"> </span>140M<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-50-19" name="__codelineno-50-19" href="#__codelineno-50-19"></a>-n<span class="w"> </span>sdcard.img
<a id="__codelineno-50-20" name="__codelineno-50-20" href="#__codelineno-50-20"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li><code>$TOP_FOLDER/sd_card/sdcard.img</code></li>
</ul>
<h4>Write SD Card</h4>

<p>Write the SD card image <code>sd_card/sdcard.img</code> to the micro SD card using the included USB writer:</p>
<ul>
<li>On Linux, use the <code>dd</code> utility as shown next:
<div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="w">    </span><span class="c1"># Determine the device asociated with the SD card on the host computer. </span>
<a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a><span class="w">    </span>cat<span class="w"> </span>/proc/partitions
<a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a><span class="w">    </span><span class="c1"># This will return for example /dev/sdx</span>
<a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a><span class="w">    </span><span class="c1"># Use dd to write the image in the corresponding device</span>
<a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a><span class="w">    </span>sudo<span class="w"> </span>dd<span class="w"> </span><span class="k">if</span><span class="o">=</span>sdcard.img<span class="w"> </span><span class="nv">of</span><span class="o">=</span>/dev/sdx<span class="w"> </span><span class="nv">bs</span><span class="o">=</span>1M
<a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a><span class="w">    </span><span class="c1"># Flush the changes to the SD card</span>
<a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a><span class="w">    </span>sync
</code></pre></div></li>
<li>On Windows, use the Win32DiskImager program, available at <a href="https://win32diskimager.org/">https://win32diskimager.org/</a>. Write the image as shown in the next figure:
<a class="glightbox" href="../images/win32diskimager.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/win32diskimager.png" /></a> </li>
</ul>
<h4>Write QSPI Flash</h4>

<p>1. Power down board</p>
<p>2. Set MSEL dipswitch SW27 to JTAG: OFF-OFF-OFF-OFF</p>
<p>3. Power up the board</p>
<p>4. Write JIC image to QSPI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a>jtagconfig<span class="w"> </span>--setparam<span class="w"> </span><span class="m">1</span><span class="w"> </span>JtagClock<span class="w"> </span>16M
<a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a>quartus_pgm<span class="w"> </span>-c<span class="w"> </span><span class="m">1</span><span class="w"> </span>-m<span class="w"> </span>jtag<span class="w"> </span>-o<span class="w"> </span><span class="s2">&quot;pvi;ghrd.hps.jic&quot;</span>
</code></pre></div>
<h4>Boot Linux</h4>

<p>1. Power down board</p>
<p>2. Set MSEL dipswitch SW27 to ASX4 (QSPi): OFF-ON-ON-OFF</p>
<p>3. Power up the board</p>
<p>4. Wait for Linux to boot, use <code>root</code> as user name, and no password wil be requested.</p>
<h2 id="direct-atf-to-linux-boot-on-hps-enablement-board">Direct ATF to Linux Boot on HPS Enablement Board<a class="headerlink" href="#direct-atf-to-linux-boot-on-hps-enablement-board" title="Permanent link">&para;</a></h2>
<p>Starting from 24.3.1 release, the Agilex™ 5 device is provided with the support of direct booting from ATF to Linux. In this boot flow, ATF acts as a First Stage Bootloader (BL2) and also as a Second Stage Bootloader (BL31). This last one is in charge of loading and launching Linux OS, so U-Boot is not used in this boot flow.</p>
<p><a class="glightbox" href="../images/ATF_Linux_bootflow.svg" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/ATF_Linux_bootflow.svg" /></a> </p>
<p>In this boot flow, the BL2 (FSBL) is included in the bitstream together with the SDM FW and hardware design (first phase only in HPS boot first mode). When booting from QSPI, this bitstream is stored in the QSPI memory. In this boot flow, the BL31 (SSBL) is packed with the Linux kernel and device tree into a FIP format image. This format provides to ATF the information about the components included in the image in a partition header. The resulting FIP image is added to the final flash image used to boot from (QSPI, SDCard, NAND or eMMC). </p>
<p>When creating the flash image, it's necessary to provide the location in where ATF expects to find the FIP image (fip.bin). This is hardcoded in the ATF code (<strong>plat/intel/soc/common/include/platform_def.h</strong>) for each one of the flash devices in which this boot flow is supported as indicated in the next table:</p>
<table>
<thead>
<tr>
<th align="left">Flash Device</th>
<th align="left">Definition</th>
<th align="left">Location in Flash device</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">QSPI</td>
<td align="left">PLAT_QSPI_DATA_BASE</td>
<td align="left">0x3C00000</td>
</tr>
<tr>
<td align="left">SDCard</td>
<td align="left">PLAT_SDMMC_DATA_BASE</td>
<td align="left">0x0</td>
</tr>
<tr>
<td align="left">eMMC</td>
<td align="left">PLAT_SDMMC_DATA_BASE</td>
<td align="left">0x0</td>
</tr>
</tbody>
</table>
<p>The following sections provide instructions about how to generate the binaries to exercise this boot flow booting from different boot sources.  The instructions provided to build the binaries to boot form any flash device are expected to be executed togheter becuase therre are some dependencies among them. In all the cases the environment set up is needed. For dependencies, check at the beggining of each one of the sections.</p>
<h3 id="boot-from-sd-card_2">Boot from SD Card<a class="headerlink" href="#boot-from-sd-card_2" title="Permanent link">&para;</a></h3>
<p>Here we provide all the steps needed to create the binaries that allow you to exercise the ATF to Linux boot flow from a SD Card device. This includes building the hardware design, ATF (BL2, BL31), Linux file system, and Linux. These are some notes about the build instructions:</p>
<ul>
<li>Excercise the HPS boot first flow.</li>
<li>When building ATF, we indicate the device used to boot from. We also indicate the SDRAM memory locations where the Linux kernel image and device tree will be loaded and launched from. In this boot flow, Linux is referred to as BL33.</li>
<li>The FIP image (fip.bin) is created using the ATF fiptool, indicating the binaries that integrate this image.</li>
<li>The SD Card created will include 2 partitions. One in which the fip.bin file is located (raw format and type A2) and the other for the file system (ext3 format).</li>
<li>
<p>If wanted to perform FPGA configuration (2<sup>nd</sup> phase from Linux) from Linux create overlays.dtb as indicated in <a href="https://altera-fpga.github.io/latest/embedded-designs/agilex-7/f-series/soc/fabric-config/ug-linux-fabric-config-agx7f-soc/">Agilex™ 7 SoC Fabric Configuration from Linux Example</a></p>
<p><a class="glightbox" href="../images/ATF_Linux_Image_SDCard.jpg" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/ATF_Linux_Image_SDCard.jpg" /></a> </p>
</li>
</ul>
<h4>Toolchain Setup (ATF-To-Linux)</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a>sudo<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>agilex5_boot.atf2linux_sd_qspi
<a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a>mkdir<span class="w"> </span>agilex5_boot.atf2linux_sd_qspi<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>agilex5_boot.atf2linux_sd_qspi
<a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">TOP_FOLDER</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
</code></pre></div>
<p>Download the compiler toolchain, add it to the PATH variable, to be used by the GHRD makefile to build the HPS Debug FSBL:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a>wget<span class="w"> </span>https://developer.arm.com/-/media/Files/downloads/gnu/14.3.rel1/binrel/<span class="se">\</span>
<a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a>arm-gnu-toolchain-14.3.rel1-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a>tar<span class="w"> </span>xf<span class="w"> </span>arm-gnu-toolchain-14.3.rel1-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-54-5" name="__codelineno-54-5" href="#__codelineno-54-5"></a>rm<span class="w"> </span>-f<span class="w"> </span>arm-gnu-toolchain-14.3.rel1-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-54-6" name="__codelineno-54-6" href="#__codelineno-54-6"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>/arm-gnu-toolchain-14.3.rel1-x86_64-aarch64-none-linux-gnu/bin/:<span class="nv">$PATH</span>
<a id="__codelineno-54-7" name="__codelineno-54-7" href="#__codelineno-54-7"></a><span class="nb">export</span><span class="w"> </span><span class="nv">ARCH</span><span class="o">=</span>arm64
<a id="__codelineno-54-8" name="__codelineno-54-8" href="#__codelineno-54-8"></a><span class="nb">export</span><span class="w"> </span><span class="nv">CROSS_COMPILE</span><span class="o">=</span>aarch64-none-linux-gnu-
</code></pre></div>
<p>Enable Quartus tools to be called from command line:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_ROOTDIR</span><span class="o">=</span>~/altera_pro/25.1.1/quartus/
<a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>/bin:<span class="nv">$QUARTUS_ROOTDIR</span>/linux64:<span class="nv">$QUARTUS_ROOTDIR</span>/../qsys/bin:<span class="nv">$PATH</span>
</code></pre></div>
<h4>Build Hardware Design</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>agilex5_soc_devkit_ghrd_sdqspi<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>agilex5_soc_devkit_ghrd_sdqspi<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>agilex5_soc_devkit_ghrd_sdqspi
<a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a>wget<span class="w"> </span>https://github.com/altera-fpga/agilex5e-ed-gsrd/releases/download/QPDS25.1.1_REL_GSRD_PR/a5ed065es-premium-devkit-oobe-legacy-baseline.zip
<a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a>unzip<span class="w"> </span>a5ed065es-premium-devkit-oobe-legacy-baseline.zip
<a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a>rm<span class="w"> </span>-f<span class="w"> </span>a5ed065es-premium-devkit-oobe-legacy-baseline.zip
<a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a>make<span class="w"> </span>legacy_baseline-build
<a id="__codelineno-56-7" name="__codelineno-56-7" href="#__codelineno-56-7"></a>make<span class="w"> </span>legacy_baseline-sw-build
<a id="__codelineno-56-8" name="__codelineno-56-8" href="#__codelineno-56-8"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>output_files/legacy_baseline.sof<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-56-9" name="__codelineno-56-9" href="#__codelineno-56-9"></a><span class="w">  </span>output_files/legacy_baseline_hps_debug.sof<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-56-10" name="__codelineno-56-10" href="#__codelineno-56-10"></a><span class="w">  </span>-o<span class="w"> </span><span class="nv">hps_path</span><span class="o">=</span>software/hps_debug/hps_wipe.ihex
<a id="__codelineno-56-11" name="__codelineno-56-11" href="#__codelineno-56-11"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li>$TOP_FOLDER/agilex5_soc_devkit_ghrd_sdqspi/output_files/legacy_baseline.sof</li>
</ul>
<h4>Build Arm Trusted Firmware</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>arm-trusted-firmware-sdcard
<a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS25.1.1_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-fpga/arm-trusted-firmware<span class="w"> </span>arm-trusted-firmware-sdcard
<a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a><span class="nb">cd</span><span class="w"> </span>arm-trusted-firmware-sdcard
<a id="__codelineno-57-5" name="__codelineno-57-5" href="#__codelineno-57-5"></a><span class="c1"># Workaround for HSD: 15018072763. Will be fixed in 25.3</span>
<a id="__codelineno-57-6" name="__codelineno-57-6" href="#__codelineno-57-6"></a>sed<span class="w"> </span>-i<span class="w">  </span><span class="s1">&#39;s/struct cdns_idmac_desc cdns_desc\[CONFIG_CDNS_DESC_COUNT\];/struct cdns_idmac_desc cdns_desc\[CONFIG_CDNS_DESC_COUNT\]  __aligned(8);/g&#39;</span><span class="w"> </span>drivers/cadence/emmc/cdns_sdmmc.c
<a id="__codelineno-57-7" name="__codelineno-57-7" href="#__codelineno-57-7"></a>make<span class="w"> </span>realclean
<a id="__codelineno-57-8" name="__codelineno-57-8" href="#__codelineno-57-8"></a><span class="c1"># Setting Bootsource as SDMMC</span>
<a id="__codelineno-57-9" name="__codelineno-57-9" href="#__codelineno-57-9"></a>make<span class="w"> </span>bl2<span class="w"> </span>bl31<span class="w"> </span><span class="nv">PLAT</span><span class="o">=</span>agilex5<span class="w"> </span><span class="nv">ARM_LINUX_KERNEL_AS_BL33</span><span class="o">=</span><span class="m">1</span><span class="w">  </span><span class="nv">PRELOADED_BL33_BASE</span><span class="o">=</span>0x82000000<span class="w"> </span><span class="nv">ARM_PRELOADED_DTB_BASE</span><span class="o">=</span>0x90000000<span class="w"> </span><span class="nv">SOCFPGA_BOOT_SOURCE_SDMMC</span><span class="o">=</span><span class="m">1</span>
<a id="__codelineno-57-10" name="__codelineno-57-10" href="#__codelineno-57-10"></a><span class="c1"># Create Fiptool tool</span>
<a id="__codelineno-57-11" name="__codelineno-57-11" href="#__codelineno-57-11"></a>make<span class="w"> </span>-C<span class="w"> </span>tools/fiptool<span class="w"> </span>clean
<a id="__codelineno-57-12" name="__codelineno-57-12" href="#__codelineno-57-12"></a>make<span class="w"> </span>fiptool
<a id="__codelineno-57-13" name="__codelineno-57-13" href="#__codelineno-57-13"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<p>The following files are created:</p>
<ul>
<li>$TOP_FOLDER/arm-trusted-firmware-sdcard/build/agilex5/release/bl2.bin</li>
<li>$TOP_FOLDER/arm-trusted-firmware-sdcard/build/agilex5/release/bl31.bin</li>
</ul>
<h4>Build Linux</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>linux-socfpga-sdcard
<a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS25.1.1_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-fpga/linux-socfpga<span class="w"> </span>linux-socfpga-sdcard
<a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a><span class="nb">cd</span><span class="w"> </span>linux-socfpga-sdcard
<a id="__codelineno-58-5" name="__codelineno-58-5" href="#__codelineno-58-5"></a><span class="c1"># Create a device tree for this flow</span>
<a id="__codelineno-58-6" name="__codelineno-58-6" href="#__codelineno-58-6"></a>cat<span class="w"> </span><span class="s">&lt;&lt; EOF &gt; arch/arm64/boot/dts/intel/socfpga_agilex5_socdk_atfboot.dts</span>
<a id="__codelineno-58-7" name="__codelineno-58-7" href="#__codelineno-58-7"></a><span class="s">#include &quot;socfpga_agilex5_socdk.dts&quot;</span>
<a id="__codelineno-58-8" name="__codelineno-58-8" href="#__codelineno-58-8"></a>
<a id="__codelineno-58-9" name="__codelineno-58-9" href="#__codelineno-58-9"></a><span class="s">/ {</span>
<a id="__codelineno-58-10" name="__codelineno-58-10" href="#__codelineno-58-10"></a>
<a id="__codelineno-58-11" name="__codelineno-58-11" href="#__codelineno-58-11"></a><span class="s">    model = &quot;SoCFPGA Agilex5 SoCDK&quot;;</span>
<a id="__codelineno-58-12" name="__codelineno-58-12" href="#__codelineno-58-12"></a><span class="s">  compatible = &quot;intel,socfpga-agilex5-socdk&quot;, &quot;intel,socfpga-agilex5&quot;;</span>
<a id="__codelineno-58-13" name="__codelineno-58-13" href="#__codelineno-58-13"></a>
<a id="__codelineno-58-14" name="__codelineno-58-14" href="#__codelineno-58-14"></a><span class="s">  chosen {</span>
<a id="__codelineno-58-15" name="__codelineno-58-15" href="#__codelineno-58-15"></a><span class="s">      stdout-path = &quot;serial0:115200n8&quot;;</span>
<a id="__codelineno-58-16" name="__codelineno-58-16" href="#__codelineno-58-16"></a><span class="s">      bootargs = &quot;console=ttys0,115200 earlycon panic=-1 root=/dev/mmcblk0p2 rw rootwait&quot;;</span>
<a id="__codelineno-58-17" name="__codelineno-58-17" href="#__codelineno-58-17"></a><span class="s">    };</span>
<a id="__codelineno-58-18" name="__codelineno-58-18" href="#__codelineno-58-18"></a>
<a id="__codelineno-58-19" name="__codelineno-58-19" href="#__codelineno-58-19"></a><span class="s">};</span>
<a id="__codelineno-58-20" name="__codelineno-58-20" href="#__codelineno-58-20"></a><span class="s">EOF</span>
<a id="__codelineno-58-21" name="__codelineno-58-21" href="#__codelineno-58-21"></a>
<a id="__codelineno-58-22" name="__codelineno-58-22" href="#__codelineno-58-22"></a><span class="c1"># Build socfpga_agilex5_socdk_atfboot.dtb</span>
<a id="__codelineno-58-23" name="__codelineno-58-23" href="#__codelineno-58-23"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;/socfpga_agilex5_socdk.dtb \\/a socfpga_agilex5_socdk_atfboot.dtb \\&#39;</span><span class="w"> </span>arch/arm64/boot/dts/intel/Makefile
<a id="__codelineno-58-24" name="__codelineno-58-24" href="#__codelineno-58-24"></a>
<a id="__codelineno-58-25" name="__codelineno-58-25" href="#__codelineno-58-25"></a>cat<span class="w"> </span><span class="s">&lt;&lt; EOF &gt; config-fragment-agilex5</span>
<a id="__codelineno-58-26" name="__codelineno-58-26" href="#__codelineno-58-26"></a><span class="s"># Enable DHCP </span>
<a id="__codelineno-58-27" name="__codelineno-58-27" href="#__codelineno-58-27"></a><span class="s">CONFIG_IP_PNP_DHCP=y</span>
<a id="__codelineno-58-28" name="__codelineno-58-28" href="#__codelineno-58-28"></a><span class="s"># enable kernel debugging with RiscFree</span>
<a id="__codelineno-58-29" name="__codelineno-58-29" href="#__codelineno-58-29"></a><span class="s">CONFIG_DEBUG_INFO=y</span>
<a id="__codelineno-58-30" name="__codelineno-58-30" href="#__codelineno-58-30"></a><span class="s">CONFIG_GDB_SCRIPTS=y</span>
<a id="__codelineno-58-31" name="__codelineno-58-31" href="#__codelineno-58-31"></a><span class="s">CONFIG_INITRAMFS_ROOT_UID=0</span>
<a id="__codelineno-58-32" name="__codelineno-58-32" href="#__codelineno-58-32"></a><span class="s">CONFIG_INITRAMFS_ROOT_GID=0</span>
<a id="__codelineno-58-33" name="__codelineno-58-33" href="#__codelineno-58-33"></a><span class="s">CONFIG_INITRAMFS_COMPRESSION_GZIP=y</span>
<a id="__codelineno-58-34" name="__codelineno-58-34" href="#__codelineno-58-34"></a>
<a id="__codelineno-58-35" name="__codelineno-58-35" href="#__codelineno-58-35"></a><span class="s"># Include these configs if wanted to perform fpga reconfiguration using overlays (enable device tree overlays and fpga bridges)</span>
<a id="__codelineno-58-36" name="__codelineno-58-36" href="#__codelineno-58-36"></a><span class="s"># Taken from https://altera-fpga.github.io/latest/embedded-designs/agilex-7/f-series/soc/fabric-config/ug-linux-fabric-config-agx7f-soc/</span>
<a id="__codelineno-58-37" name="__codelineno-58-37" href="#__codelineno-58-37"></a><span class="s">CONFIG_OF_RESOLVE=y</span>
<a id="__codelineno-58-38" name="__codelineno-58-38" href="#__codelineno-58-38"></a><span class="s">CONFIG_OF_OVERLAY=y</span>
<a id="__codelineno-58-39" name="__codelineno-58-39" href="#__codelineno-58-39"></a><span class="s">CONFIG_OF_CONFIGFS=y</span>
<a id="__codelineno-58-40" name="__codelineno-58-40" href="#__codelineno-58-40"></a><span class="s">CONFIG_FPGA_MGR_STRATIX10_SOC=y</span>
<a id="__codelineno-58-41" name="__codelineno-58-41" href="#__codelineno-58-41"></a><span class="s">CONFIG_FPGA_BRIDGE=y</span>
<a id="__codelineno-58-42" name="__codelineno-58-42" href="#__codelineno-58-42"></a><span class="s">CONFIG_FPGA_REGION=y</span>
<a id="__codelineno-58-43" name="__codelineno-58-43" href="#__codelineno-58-43"></a><span class="s">CONFIG_OF_FPGA_REGION=y</span>
<a id="__codelineno-58-44" name="__codelineno-58-44" href="#__codelineno-58-44"></a><span class="s">CONFIG_OVERLAY_FS=y</span>
<a id="__codelineno-58-45" name="__codelineno-58-45" href="#__codelineno-58-45"></a><span class="s">CONFIG_ALTERA_SYSID=y</span>
<a id="__codelineno-58-46" name="__codelineno-58-46" href="#__codelineno-58-46"></a>
<a id="__codelineno-58-47" name="__codelineno-58-47" href="#__codelineno-58-47"></a><span class="s"># Needed for netwrok connectivity</span>
<a id="__codelineno-58-48" name="__codelineno-58-48" href="#__codelineno-58-48"></a><span class="s">CONFIG_MARVELL_PHY=y</span>
<a id="__codelineno-58-49" name="__codelineno-58-49" href="#__codelineno-58-49"></a><span class="s">EOF</span>
<a id="__codelineno-58-50" name="__codelineno-58-50" href="#__codelineno-58-50"></a>
<a id="__codelineno-58-51" name="__codelineno-58-51" href="#__codelineno-58-51"></a>make<span class="w"> </span>clean<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>make<span class="w"> </span>mrproper
<a id="__codelineno-58-52" name="__codelineno-58-52" href="#__codelineno-58-52"></a>make<span class="w"> </span>defconfig
<a id="__codelineno-58-53" name="__codelineno-58-53" href="#__codelineno-58-53"></a><span class="c1"># Apply custom Configs in file</span>
<a id="__codelineno-58-54" name="__codelineno-58-54" href="#__codelineno-58-54"></a>./scripts/kconfig/merge_config.sh<span class="w"> </span>-O<span class="w"> </span>./<span class="w"> </span>./.config<span class="w"> </span>./config-fragment-agilex5
<a id="__codelineno-58-55" name="__codelineno-58-55" href="#__codelineno-58-55"></a>
<a id="__codelineno-58-56" name="__codelineno-58-56" href="#__codelineno-58-56"></a>make<span class="w"> </span>oldconfig
<a id="__codelineno-58-57" name="__codelineno-58-57" href="#__codelineno-58-57"></a>make<span class="w"> </span>-j<span class="w"> </span><span class="m">64</span><span class="w"> </span>Image<span class="w"> </span>dtbs
</code></pre></div>
<p>The following files are created:</p>
<ul>
<li>$TOP_FOLDER/linux-socfpga-sdcard/arch/arm64/boot/Image</li>
<li>$TOP_FOLDER/linux-socfpga-sdcard/arch/arm64/boot/dts/intel/socfpga_agilex5_socdk_atfboot.dtb</li>
</ul>
<h4>Build Rootfs</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>yocto<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>yocto<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>yocto
<a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>walnascar<span class="w"> </span>https://git.yoctoproject.org/poky
<a id="__codelineno-59-4" name="__codelineno-59-4" href="#__codelineno-59-4"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>walnascar<span class="w"> </span>https://git.yoctoproject.org/meta-intel-fpga
<a id="__codelineno-59-5" name="__codelineno-59-5" href="#__codelineno-59-5"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>walnascar<span class="w"> </span>https://github.com/openembedded/meta-openembedded
<a id="__codelineno-59-6" name="__codelineno-59-6" href="#__codelineno-59-6"></a><span class="c1"># work around issue</span>
<a id="__codelineno-59-7" name="__codelineno-59-7" href="#__codelineno-59-7"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;do_package_qa[noexec] = &quot;1&quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="k">$(</span>find<span class="w"> </span>meta-intel-fpga<span class="w"> </span>-name<span class="w"> </span>linux-socfpga_6.6.bb<span class="k">)</span>
<a id="__codelineno-59-8" name="__codelineno-59-8" href="#__codelineno-59-8"></a><span class="nb">source</span><span class="w"> </span>poky/oe-init-build-env<span class="w"> </span>./build
<a id="__codelineno-59-9" name="__codelineno-59-9" href="#__codelineno-59-9"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;MACHINE = &quot;agilex5_dk_a5e065bb32aes1&quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>conf/local.conf
<a id="__codelineno-59-10" name="__codelineno-59-10" href="#__codelineno-59-10"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;BBLAYERS += &quot; ${TOPDIR}/../meta-intel-fpga &quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>conf/bblayers.conf
<a id="__codelineno-59-11" name="__codelineno-59-11" href="#__codelineno-59-11"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;BBLAYERS += &quot; ${TOPDIR}/../meta-openembedded/meta-oe &quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>conf/bblayers.conf
<a id="__codelineno-59-12" name="__codelineno-59-12" href="#__codelineno-59-12"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;IMAGE_FSTYPES = &quot;tar.gz cpio jffs2&quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>conf/local.conf
<a id="__codelineno-59-13" name="__codelineno-59-13" href="#__codelineno-59-13"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;CORE_IMAGE_EXTRA_INSTALL += &quot;openssh gdbserver devmem2&quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>conf/local.conf
<a id="__codelineno-59-14" name="__codelineno-59-14" href="#__codelineno-59-14"></a>bitbake<span class="w"> </span>core-image-minimal
</code></pre></div>
<p>The following files are created:</p>
<ul>
<li>$TOP_FOLDER/yocto/build/tmp/deploy/images/agilex5_dk_a5e065bb32aes1/core-image-minimal-agilex5_dk_a5e065bb32aes1.rootfs.tar.gz</li>
<li>$TOP_FOLDER/yocto/build/tmp/deploy/images/agilex5_dk_a5e065bb32aes1/core-image-minimal-agilex5_dk_a5e065bb32aes1.rootfs.jffs2</li>
</ul>
<h4>Build QSPI Image</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>jic_sdcard
<a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a>mkdir<span class="w"> </span>jic_sdcard<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>jic_sdcard
<a id="__codelineno-60-4" name="__codelineno-60-4" href="#__codelineno-60-4"></a><span class="c1"># Convert fsbl</span>
<a id="__codelineno-60-5" name="__codelineno-60-5" href="#__codelineno-60-5"></a>aarch64-none-linux-gnu-objcopy<span class="w"> </span>-v<span class="w"> </span>-I<span class="w"> </span>binary<span class="w"> </span>-O<span class="w"> </span>ihex<span class="w"> </span>--change-addresses<span class="w"> </span>0x00000000<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/arm-trusted-firmware-sdcard/build/agilex5/release/bl2.bin<span class="w"> </span>fsbl.hex
<a id="__codelineno-60-6" name="__codelineno-60-6" href="#__codelineno-60-6"></a>ln<span class="w"> </span>-s<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/agilex5_soc_devkit_ghrd_sdqspi/output_files/legacy_baseline.sof<span class="w"> </span>legacy_baseline.sof
<a id="__codelineno-60-7" name="__codelineno-60-7" href="#__codelineno-60-7"></a><span class="c1"># Create .jic file</span>
<a id="__codelineno-60-8" name="__codelineno-60-8" href="#__codelineno-60-8"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>legacy_baseline.sof<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-60-9" name="__codelineno-60-9" href="#__codelineno-60-9"></a>design_atf.jic<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-60-10" name="__codelineno-60-10" href="#__codelineno-60-10"></a>-o<span class="w"> </span><span class="nv">hps_path</span><span class="o">=</span>fsbl.hex<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-60-11" name="__codelineno-60-11" href="#__codelineno-60-11"></a>-o<span class="w"> </span><span class="nv">device</span><span class="o">=</span>MT25QU128<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-60-12" name="__codelineno-60-12" href="#__codelineno-60-12"></a>-o<span class="w"> </span><span class="nv">flash_loader</span><span class="o">=</span>A5ED065BB32AE6SR0<span class="w">  </span><span class="se">\</span>
<a id="__codelineno-60-13" name="__codelineno-60-13" href="#__codelineno-60-13"></a>-o<span class="w"> </span><span class="nv">mode</span><span class="o">=</span>ASX4<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-60-14" name="__codelineno-60-14" href="#__codelineno-60-14"></a>-o<span class="w"> </span><span class="nv">hps</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
<p>The following files are created:</p>
<ul>
<li>$TOP_FOLDER/jic_sdcard/design_atf.hps.jic</li>
<li>$TOP_FOLDER/jic_sdcard/design_atf.core.rbf</li>
</ul>
<h4>Build SD Card Image</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a>sudo<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>sd_card
<a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a>mkdir<span class="w"> </span>sd_card<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>sd_card
<a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a><span class="c1">## Create FIP image</span>
<a id="__codelineno-61-5" name="__codelineno-61-5" href="#__codelineno-61-5"></a><span class="nv">$TOP_FOLDER</span>/arm-trusted-firmware-sdcard/tools/fiptool/fiptool<span class="w"> </span>create<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-61-6" name="__codelineno-61-6" href="#__codelineno-61-6"></a>--soc-fw<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/arm-trusted-firmware-sdcard/build/agilex5/release/bl31.bin<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-61-7" name="__codelineno-61-7" href="#__codelineno-61-7"></a>--nt-fw<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/linux-socfpga-sdcard/arch/arm64/boot/Image<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-61-8" name="__codelineno-61-8" href="#__codelineno-61-8"></a>--nt-fw-config<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/linux-socfpga-sdcard/arch/arm64/boot/dts/intel/socfpga_agilex5_socdk_atfboot.dtb<span class="w"> </span>fip.bin
<a id="__codelineno-61-9" name="__codelineno-61-9" href="#__codelineno-61-9"></a>
<a id="__codelineno-61-10" name="__codelineno-61-10" href="#__codelineno-61-10"></a><span class="c1"># Build now the SDCard</span>
<a id="__codelineno-61-11" name="__codelineno-61-11" href="#__codelineno-61-11"></a>wget<span class="w"> </span>https://releases.rocketboards.org/release/2020.11/gsrd/tools/make_sdimage_p3.py
<a id="__codelineno-61-12" name="__codelineno-61-12" href="#__codelineno-61-12"></a><span class="c1"># remove mkfs.fat parameter which has some issues on Ubuntu 22.04</span>
<a id="__codelineno-61-13" name="__codelineno-61-13" href="#__codelineno-61-13"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/\&quot;\-F 32\&quot;,//g&#39;</span><span class="w"> </span>make_sdimage_p3.py
<a id="__codelineno-61-14" name="__codelineno-61-14" href="#__codelineno-61-14"></a>chmod<span class="w"> </span>+x<span class="w"> </span>make_sdimage_p3.py
<a id="__codelineno-61-15" name="__codelineno-61-15" href="#__codelineno-61-15"></a>mkdir<span class="w"> </span>rootfs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>rootfs
<a id="__codelineno-61-16" name="__codelineno-61-16" href="#__codelineno-61-16"></a>sudo<span class="w"> </span>tar<span class="w"> </span>-xf<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/yocto/build/tmp/deploy/images/agilex5_dk_a5e065bb32aes1/core-image-minimal-agilex5_dk_a5e065bb32aes1.rootfs.tar.gz
<a id="__codelineno-61-17" name="__codelineno-61-17" href="#__codelineno-61-17"></a>sudo<span class="w"> </span>cp<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/jic_sdcard/design_atf.core.rbf<span class="w"> </span>home/root/
<a id="__codelineno-61-18" name="__codelineno-61-18" href="#__codelineno-61-18"></a>sudo<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>lib/modules/*
<a id="__codelineno-61-19" name="__codelineno-61-19" href="#__codelineno-61-19"></a><span class="nb">cd</span><span class="w"> </span>..
<a id="__codelineno-61-20" name="__codelineno-61-20" href="#__codelineno-61-20"></a>sudo<span class="w"> </span>python3<span class="w"> </span>make_sdimage_p3.py<span class="w"> </span>-f<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-61-21" name="__codelineno-61-21" href="#__codelineno-61-21"></a>-P<span class="w"> </span>fip.bin,num<span class="o">=</span><span class="m">1</span>,format<span class="o">=</span>raw,size<span class="o">=</span>64M,type<span class="o">=</span>a2<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-61-22" name="__codelineno-61-22" href="#__codelineno-61-22"></a>-P<span class="w"> </span>rootfs/*,num<span class="o">=</span><span class="m">2</span>,format<span class="o">=</span>ext3,size<span class="o">=</span>64M<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-61-23" name="__codelineno-61-23" href="#__codelineno-61-23"></a>-s<span class="w"> </span>128M<span class="w"> </span>-n<span class="w"> </span>sdimage_atf.img
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li>$TOP_FOLDER/sd_card/sdimage_atf.img</li>
</ul>
<p>You can exercise ATF to Linux boot flow from SD Card using the following binaries generated:</p>
<ul>
<li>$TOP_FOLDER/sd_card/sdimage_atf.img</li>
<li>$TOP_FOLDER/jic_sdcard/design_atf.hps.jic</li>
</ul>
<p>When booting with the binaries generated, this is the log that you will see. This is the log is just a refenrece and captured by the time the page was created and in the future the versions in the components may change.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a>NOTICE:  DDR: Reset type is &#39;Power-On&#39;
<a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a>NOTICE:  IOSSM: Calibration success status check...
<a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a>NOTICE:  IOSSM: All EMIF instances within the IO96 have calibrated successfully!
<a id="__codelineno-62-4" name="__codelineno-62-4" href="#__codelineno-62-4"></a>NOTICE:  DDR: Calibration success
<a id="__codelineno-62-5" name="__codelineno-62-5" href="#__codelineno-62-5"></a>NOTICE:  DDR: DDR size configured is (2048 MiB)
<a id="__codelineno-62-6" name="__codelineno-62-6" href="#__codelineno-62-6"></a>NOTICE:  DDR: Mismatch with hardware size (8192 MiB).
<a id="__codelineno-62-7" name="__codelineno-62-7" href="#__codelineno-62-7"></a>NOTICE:  ###DDR:init success###
<a id="__codelineno-62-8" name="__codelineno-62-8" href="#__codelineno-62-8"></a>NOTICE:  SOCFPGA: SDMMC boot
<a id="__codelineno-62-9" name="__codelineno-62-9" href="#__codelineno-62-9"></a>NOTICE:  BL2: v2.11.1(release):QPDS24.1STD_REL_GSRD_PR-dirty
<a id="__codelineno-62-10" name="__codelineno-62-10" href="#__codelineno-62-10"></a>NOTICE:  BL2: Built : 11:05:13, Mar 25 2025
<a id="__codelineno-62-11" name="__codelineno-62-11" href="#__codelineno-62-11"></a>NOTICE:  BL2: Booting BL31
<a id="__codelineno-62-12" name="__codelineno-62-12" href="#__codelineno-62-12"></a>NOTICE:  SOCFPGA: CPU ID = 0
<a id="__codelineno-62-13" name="__codelineno-62-13" href="#__codelineno-62-13"></a>NOTICE:  BL31: v2.11.1(release):QPDS24.1STD_REL_GSRD_PR-dirty
<a id="__codelineno-62-14" name="__codelineno-62-14" href="#__codelineno-62-14"></a>NOTICE:  BL31: Built : 11:05:18, Mar 25 2025
<a id="__codelineno-62-15" name="__codelineno-62-15" href="#__codelineno-62-15"></a>NOTICE:  BL31: Initializing runtime services
<a id="__codelineno-62-16" name="__codelineno-62-16" href="#__codelineno-62-16"></a>[    0.000000] Booting Linux on physical CPU 0x0000000000 [0x412fd050]
<a id="__codelineno-62-17" name="__codelineno-62-17" href="#__codelineno-62-17"></a>[    0.000000] Linux version 6.6.51-g7dddbad0a3a7-dirty (rolando@rolando3-linux-lab) (aarch64-none-linux-gnu-gcc (GNU Toolchain for the Arm Architecture 11.2-2022.02 (arm-11.14)) 11.2.1 20220111, GNU ld (GNU Toolchain for the Arm Architecture 11.2-2022.02 (arm-11.14)) 2.37.20220122) #1 SMP PREEMPT Mon Mar 31 17:31:03 CDT 2025
<a id="__codelineno-62-18" name="__codelineno-62-18" href="#__codelineno-62-18"></a>[    0.000000] KASLR disabled due to lack of seed
<a id="__codelineno-62-19" name="__codelineno-62-19" href="#__codelineno-62-19"></a>[    0.000000] Machine model: SoCFPGA Agilex5 SoCDK
<a id="__codelineno-62-20" name="__codelineno-62-20" href="#__codelineno-62-20"></a>[    0.000000] efi: UEFI not found.
<a id="__codelineno-62-21" name="__codelineno-62-21" href="#__codelineno-62-21"></a>[    0.000000] Reserved memory: created DMA memory pool at 0x0000000080000000, size 32 MiB
<a id="__codelineno-62-22" name="__codelineno-62-22" href="#__codelineno-62-22"></a>[    0.000000] OF: reserved mem: initialized node svcbuffer@0, compatible id shared-dma-pool
<a id="__codelineno-62-23" name="__codelineno-62-23" href="#__codelineno-62-23"></a>[    0.000000] OF: reserved mem: 0x0000000080000000..0x0000000081ffffff (32768 KiB) nomap non-reusable svcbuffer@0
<a id="__codelineno-62-24" name="__codelineno-62-24" href="#__codelineno-62-24"></a>[    0.000000] earlycon: uart0 at MMIO32 0x0000000010c02000 (options &#39;115200n8&#39;)
<a id="__codelineno-62-25" name="__codelineno-62-25" href="#__codelineno-62-25"></a>[    0.000000] printk: bootconsole [uart0] enabled
<a id="__codelineno-62-26" name="__codelineno-62-26" href="#__codelineno-62-26"></a>:
<a id="__codelineno-62-27" name="__codelineno-62-27" href="#__codelineno-62-27"></a>[    0.000000] Kernel command line: console=ttys0,115200 earlycon panic=-1 root=/dev/mmcblk0p2 rw rootwait
<a id="__codelineno-62-28" name="__codelineno-62-28" href="#__codelineno-62-28"></a>:
<a id="__codelineno-62-29" name="__codelineno-62-29" href="#__codelineno-62-29"></a>[    8.026580] socfpga-dwmac 10830000.ethernet eth0: No Safety Features support found
<a id="__codelineno-62-30" name="__codelineno-62-30" href="#__codelineno-62-30"></a>[    8.034175] socfpga-dwmac 10830000.ethernet eth0: IEEE 1588-2008 Advanced Timestamp supported
<a id="__codelineno-62-31" name="__codelineno-62-31" href="#__codelineno-62-31"></a>[    8.043140] socfpga-dwmac 10830000.ethernet eth0: registered PTP clock
<a id="__codelineno-62-32" name="__codelineno-62-32" href="#__codelineno-62-32"></a>[    8.050111] socfpga-dwmac 10830000.ethernet eth0: FPE workqueue start
<a id="__codelineno-62-33" name="__codelineno-62-33" href="#__codelineno-62-33"></a>[    8.056545] socfpga-dwmac 10830000.ethernet eth0: configuring for phy/rgmii link mode
<a id="__codelineno-62-34" name="__codelineno-62-34" href="#__codelineno-62-34"></a>[   12.156912] socfpga-dwmac 10830000.ethernet eth0: Link is Up - 1Gbps/Full - flow control rx/tx
<a id="__codelineno-62-35" name="__codelineno-62-35" href="#__codelineno-62-35"></a>[   18.401711] dw-apb-uart 10c02000.serial: failed to request DMA
<a id="__codelineno-62-36" name="__codelineno-62-36" href="#__codelineno-62-36"></a>
<a id="__codelineno-62-37" name="__codelineno-62-37" href="#__codelineno-62-37"></a>Poky (Yocto Project Reference Distro) 5.1.3 agilex5_dk_a5e065bb32aes1 /dev/ttyS0
<a id="__codelineno-62-38" name="__codelineno-62-38" href="#__codelineno-62-38"></a>
<a id="__codelineno-62-39" name="__codelineno-62-39" href="#__codelineno-62-39"></a>agilex5_dk_a5e065bb32aes1 login: root
<a id="__codelineno-62-40" name="__codelineno-62-40" href="#__codelineno-62-40"></a>
<a id="__codelineno-62-41" name="__codelineno-62-41" href="#__codelineno-62-41"></a>WARNING: Poky is a reference Yocto Project distribution that should be used for testing and development purposes only. It is recommended that you create your own distribution for production use.
<a id="__codelineno-62-42" name="__codelineno-62-42" href="#__codelineno-62-42"></a>
<a id="__codelineno-62-43" name="__codelineno-62-43" href="#__codelineno-62-43"></a>root@agilex5_dk_a5e065bb32aes1:~# 
</code></pre></div>
<h3 id="boot-from-qspi_1">Boot from QSPI<a class="headerlink" href="#boot-from-qspi_1" title="Permanent link">&para;</a></h3>
<p>This section provides instructions to build binaries to exercise ATF to Linux direct boot flow booting from a QSPI device.</p>
<p><strong>NOTE:</strong> This section depends on some steps from the <a href="#atf-to-linux-from-sd-card">ATF to Linux from SD Card</a> section. So, to build the binaries in this section, the instructions in the following sections need to be executed earlier:</p>
<ul>
<li><a href="#toolchain-setup-atf-to-linux">Toolchain Setup (ATF-To-Linux)</a></li>
<li><a href="#build-hardware-design-sd_qspi-atf-to-linux">Build Hardware Design SD_QSPI (ATF-To-Linux)</a></li>
<li><a href="#build-linux-file-system-atf-to-linux">Build Linux File System  (ATF-To-Linux)</a></li>
</ul>
<p>ATF requires to be rebuilt to enable booting from QSPI by setting SOCFPGA_BOOT_SOURCE_QSPI to '1'. Linux also need to be rebuild since this time we are including a JFFS2 file system and since booting from QSPI we need to change some parameters in the device tree. The FIP image is created in the same way but this time the FIP image is put into the QSPI image using a specific .pfg file. In this .pfg file, we are indicating that the fip file will be located at <strong>0x3C00000</strong> location in the QSPI since this is also indicated by the <strong>PLAT_QSPI_DATA_BASE</strong> definition in the ATF.</p>
<p><a class="glightbox" href="../images/ATF_Linux_Image_QSPI.jpg" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/ATF_Linux_Image_QSPI.jpg" /></a> </p>
<h4>Build Arm Trusted Firmware</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a><span class="c1"># Building ATF</span>
<a id="__codelineno-63-3" name="__codelineno-63-3" href="#__codelineno-63-3"></a>rm<span class="w"> </span>-rf<span class="w"> </span>arm-trusted-firmware-qspi
<a id="__codelineno-63-4" name="__codelineno-63-4" href="#__codelineno-63-4"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS25.1.1_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-fpga/arm-trusted-firmware<span class="w"> </span>arm-trusted-firmware-qspi
<a id="__codelineno-63-5" name="__codelineno-63-5" href="#__codelineno-63-5"></a><span class="nb">cd</span><span class="w"> </span>arm-trusted-firmware-qspi
<a id="__codelineno-63-6" name="__codelineno-63-6" href="#__codelineno-63-6"></a>
<a id="__codelineno-63-7" name="__codelineno-63-7" href="#__codelineno-63-7"></a>make<span class="w"> </span>realclean
<a id="__codelineno-63-8" name="__codelineno-63-8" href="#__codelineno-63-8"></a><span class="c1"># Setting Bootsource as QSPI</span>
<a id="__codelineno-63-9" name="__codelineno-63-9" href="#__codelineno-63-9"></a>make<span class="w"> </span>bl2<span class="w"> </span>bl31<span class="w"> </span><span class="nv">PLAT</span><span class="o">=</span>agilex5<span class="w"> </span><span class="nv">ARM_LINUX_KERNEL_AS_BL33</span><span class="o">=</span><span class="m">1</span><span class="w">  </span><span class="nv">PRELOADED_BL33_BASE</span><span class="o">=</span>0x82000000<span class="w"> </span><span class="nv">ARM_PRELOADED_DTB_BASE</span><span class="o">=</span>0x90000000<span class="w"> </span><span class="nv">SOCFPGA_BOOT_SOURCE_QSPI</span><span class="o">=</span><span class="m">1</span>
<a id="__codelineno-63-10" name="__codelineno-63-10" href="#__codelineno-63-10"></a>
<a id="__codelineno-63-11" name="__codelineno-63-11" href="#__codelineno-63-11"></a><span class="c1"># Create Fiptool tool</span>
<a id="__codelineno-63-12" name="__codelineno-63-12" href="#__codelineno-63-12"></a>make<span class="w"> </span>-C<span class="w"> </span>tools/fiptool<span class="w"> </span>clean
<a id="__codelineno-63-13" name="__codelineno-63-13" href="#__codelineno-63-13"></a>make<span class="w"> </span>fiptool
<a id="__codelineno-63-14" name="__codelineno-63-14" href="#__codelineno-63-14"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<p>The following files are created:</p>
<ul>
<li>$TOP_FOLDER/arm-trusted-firmware-qspi/build/agilex5/release/bl2.bin </li>
<li>$TOP_FOLDER/arm-trusted-firmware-qspi/build/agilex5/release/bl31.bin</li>
<li>$TOP_FOLDER/arm-trusted-firmware-qspi/tools/fiptool/fiptool</li>
</ul>
<h4>Build Linux</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>linux-socfpga-qspi
<a id="__codelineno-64-3" name="__codelineno-64-3" href="#__codelineno-64-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS25.1.1_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-fpga/linux-socfpga<span class="w"> </span>linux-socfpga-qspi
<a id="__codelineno-64-4" name="__codelineno-64-4" href="#__codelineno-64-4"></a><span class="nb">cd</span><span class="w"> </span>linux-socfpga-qspi
<a id="__codelineno-64-5" name="__codelineno-64-5" href="#__codelineno-64-5"></a>
<a id="__codelineno-64-6" name="__codelineno-64-6" href="#__codelineno-64-6"></a><span class="c1"># Create a device tree for this flow in which we create the command line to get the file system from QSPI</span>
<a id="__codelineno-64-7" name="__codelineno-64-7" href="#__codelineno-64-7"></a>cat<span class="w"> </span><span class="s">&lt;&lt; EOF &gt; arch/arm64/boot/dts/intel/socfpga_agilex5_socdk_atfboot.dts</span>
<a id="__codelineno-64-8" name="__codelineno-64-8" href="#__codelineno-64-8"></a><span class="s">#include &quot;socfpga_agilex5_socdk.dts&quot;</span>
<a id="__codelineno-64-9" name="__codelineno-64-9" href="#__codelineno-64-9"></a>
<a id="__codelineno-64-10" name="__codelineno-64-10" href="#__codelineno-64-10"></a><span class="s">/ {</span>
<a id="__codelineno-64-11" name="__codelineno-64-11" href="#__codelineno-64-11"></a>
<a id="__codelineno-64-12" name="__codelineno-64-12" href="#__codelineno-64-12"></a><span class="s">    model = &quot;SoCFPGA Agilex5 SoCDK&quot;;</span>
<a id="__codelineno-64-13" name="__codelineno-64-13" href="#__codelineno-64-13"></a><span class="s">    compatible = &quot;intel,socfpga-agilex5-socdk&quot;, &quot;intel,socfpga-agilex5&quot;;</span>
<a id="__codelineno-64-14" name="__codelineno-64-14" href="#__codelineno-64-14"></a>
<a id="__codelineno-64-15" name="__codelineno-64-15" href="#__codelineno-64-15"></a><span class="s">    chosen {</span>
<a id="__codelineno-64-16" name="__codelineno-64-16" href="#__codelineno-64-16"></a><span class="s">       stdout-path = &quot;serial0:115200n8&quot;;</span>
<a id="__codelineno-64-17" name="__codelineno-64-17" href="#__codelineno-64-17"></a><span class="s">       bootargs = &quot;console=ttys0,115200 earlycon panic=-1 root=/dev/mtdblock1 rw rootfstype=jffs2 rootwait&quot;;</span>
<a id="__codelineno-64-18" name="__codelineno-64-18" href="#__codelineno-64-18"></a><span class="s">    };</span>
<a id="__codelineno-64-19" name="__codelineno-64-19" href="#__codelineno-64-19"></a>
<a id="__codelineno-64-20" name="__codelineno-64-20" href="#__codelineno-64-20"></a><span class="s">};</span>
<a id="__codelineno-64-21" name="__codelineno-64-21" href="#__codelineno-64-21"></a><span class="s">EOF</span>
<a id="__codelineno-64-22" name="__codelineno-64-22" href="#__codelineno-64-22"></a>
<a id="__codelineno-64-23" name="__codelineno-64-23" href="#__codelineno-64-23"></a><span class="c1">## Modify QSPI clock frequency to 50 MHz to match ATF and modify the QSPI partitions ranges to fit the current images</span>
<a id="__codelineno-64-24" name="__codelineno-64-24" href="#__codelineno-64-24"></a>sed<span class="w"> </span>-i<span class="w">  </span><span class="s1">&#39;s/spi-max-frequency = &lt;100000000&gt;;/spi-max-frequency = &lt;50000000&gt;;/g&#39;</span><span class="w"> </span>arch/arm64/boot/dts/intel/socfpga_agilex5_socdk.dts
<a id="__codelineno-64-25" name="__codelineno-64-25" href="#__codelineno-64-25"></a>
<a id="__codelineno-64-26" name="__codelineno-64-26" href="#__codelineno-64-26"></a><span class="c1">## Adjust the partitions so the commponents in QSPI can fit</span>
<a id="__codelineno-64-27" name="__codelineno-64-27" href="#__codelineno-64-27"></a>sed<span class="w"> </span>-i<span class="w">  </span><span class="s1">&#39;s/reg = &lt;0x0 0x04200000&gt;;/reg = &lt;0x0 0x0700000&gt;;/g&#39;</span><span class="w"> </span>arch/arm64/boot/dts/intel/socfpga_agilex5_socdk.dts
<a id="__codelineno-64-28" name="__codelineno-64-28" href="#__codelineno-64-28"></a>sed<span class="w"> </span>-i<span class="w">  </span><span class="s1">&#39;s/root: partition@4200000/root: partition@7000000/g&#39;</span><span class="w"> </span>arch/arm64/boot/dts/intel/socfpga_agilex5_socdk.dts
<a id="__codelineno-64-29" name="__codelineno-64-29" href="#__codelineno-64-29"></a>sed<span class="w"> </span>-i<span class="w">  </span><span class="s1">&#39;s/reg = &lt;0x04200000 0x0be00000&gt;/reg = &lt;0x07000000 0x09000000&gt;/g&#39;</span><span class="w"> </span>arch/arm64/boot/dts/intel/socfpga_agilex5_socdk.dts
<a id="__codelineno-64-30" name="__codelineno-64-30" href="#__codelineno-64-30"></a>
<a id="__codelineno-64-31" name="__codelineno-64-31" href="#__codelineno-64-31"></a><span class="c1"># Include the build socfpga_agilex5_socdk_atfboot.dtb in the Makefile</span>
<a id="__codelineno-64-32" name="__codelineno-64-32" href="#__codelineno-64-32"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;/socfpga_agilex5_socdk.dtb \\/a socfpga_agilex5_socdk_atfboot.dtb \\&#39;</span><span class="w"> </span>arch/arm64/boot/dts/intel/Makefile
<a id="__codelineno-64-33" name="__codelineno-64-33" href="#__codelineno-64-33"></a>
<a id="__codelineno-64-34" name="__codelineno-64-34" href="#__codelineno-64-34"></a>cat<span class="w"> </span><span class="s">&lt;&lt; EOF &gt; config-fragment-agilex5</span>
<a id="__codelineno-64-35" name="__codelineno-64-35" href="#__codelineno-64-35"></a><span class="s"># Enable DHCP </span>
<a id="__codelineno-64-36" name="__codelineno-64-36" href="#__codelineno-64-36"></a><span class="s">CONFIG_IP_PNP_DHCP=y</span>
<a id="__codelineno-64-37" name="__codelineno-64-37" href="#__codelineno-64-37"></a><span class="s"># enable kernel debugging with RiscFree</span>
<a id="__codelineno-64-38" name="__codelineno-64-38" href="#__codelineno-64-38"></a><span class="s">CONFIG_DEBUG_INFO=y</span>
<a id="__codelineno-64-39" name="__codelineno-64-39" href="#__codelineno-64-39"></a><span class="s">CONFIG_GDB_SCRIPTS=y</span>
<a id="__codelineno-64-40" name="__codelineno-64-40" href="#__codelineno-64-40"></a><span class="s">CONFIG_INITRAMFS_ROOT_UID=0</span>
<a id="__codelineno-64-41" name="__codelineno-64-41" href="#__codelineno-64-41"></a><span class="s">CONFIG_INITRAMFS_ROOT_GID=0</span>
<a id="__codelineno-64-42" name="__codelineno-64-42" href="#__codelineno-64-42"></a><span class="s">CONFIG_INITRAMFS_COMPRESSION_GZIP=y</span>
<a id="__codelineno-64-43" name="__codelineno-64-43" href="#__codelineno-64-43"></a>
<a id="__codelineno-64-44" name="__codelineno-64-44" href="#__codelineno-64-44"></a><span class="s"># Include these configs if wanted to perform fpga reconfiguration using overlays (enable device tree overlays and fpga bridges)</span>
<a id="__codelineno-64-45" name="__codelineno-64-45" href="#__codelineno-64-45"></a><span class="s"># Taken from https://altera-fpga.github.io/latest/embedded-designs/agilex-7/f-series/soc/fabric-config/ug-linux-fabric-config-agx7f-soc/</span>
<a id="__codelineno-64-46" name="__codelineno-64-46" href="#__codelineno-64-46"></a><span class="s">CONFIG_OF_RESOLVE=y</span>
<a id="__codelineno-64-47" name="__codelineno-64-47" href="#__codelineno-64-47"></a><span class="s">CONFIG_OF_OVERLAY=y</span>
<a id="__codelineno-64-48" name="__codelineno-64-48" href="#__codelineno-64-48"></a><span class="s">CONFIG_OF_CONFIGFS=y</span>
<a id="__codelineno-64-49" name="__codelineno-64-49" href="#__codelineno-64-49"></a><span class="s">CONFIG_FPGA_MGR_STRATIX10_SOC=y</span>
<a id="__codelineno-64-50" name="__codelineno-64-50" href="#__codelineno-64-50"></a><span class="s">CONFIG_FPGA_BRIDGE=y</span>
<a id="__codelineno-64-51" name="__codelineno-64-51" href="#__codelineno-64-51"></a><span class="s">CONFIG_FPGA_REGION=y</span>
<a id="__codelineno-64-52" name="__codelineno-64-52" href="#__codelineno-64-52"></a><span class="s">CONFIG_OF_FPGA_REGION=y</span>
<a id="__codelineno-64-53" name="__codelineno-64-53" href="#__codelineno-64-53"></a><span class="s">CONFIG_OVERLAY_FS=y</span>
<a id="__codelineno-64-54" name="__codelineno-64-54" href="#__codelineno-64-54"></a><span class="s">CONFIG_ALTERA_SYSID=y</span>
<a id="__codelineno-64-55" name="__codelineno-64-55" href="#__codelineno-64-55"></a><span class="s"># Enabling JFFS2 File system</span>
<a id="__codelineno-64-56" name="__codelineno-64-56" href="#__codelineno-64-56"></a><span class="s">CONFIG_JFFS2_FS=y</span>
<a id="__codelineno-64-57" name="__codelineno-64-57" href="#__codelineno-64-57"></a>
<a id="__codelineno-64-58" name="__codelineno-64-58" href="#__codelineno-64-58"></a><span class="s"># Needed for netwrok connectivity</span>
<a id="__codelineno-64-59" name="__codelineno-64-59" href="#__codelineno-64-59"></a><span class="s">CONFIG_MARVELL_PHY=y</span>
<a id="__codelineno-64-60" name="__codelineno-64-60" href="#__codelineno-64-60"></a><span class="s">EOF</span>
<a id="__codelineno-64-61" name="__codelineno-64-61" href="#__codelineno-64-61"></a>
<a id="__codelineno-64-62" name="__codelineno-64-62" href="#__codelineno-64-62"></a>make<span class="w"> </span>clean<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>make<span class="w"> </span>mrproper
<a id="__codelineno-64-63" name="__codelineno-64-63" href="#__codelineno-64-63"></a>make<span class="w"> </span>defconfig
<a id="__codelineno-64-64" name="__codelineno-64-64" href="#__codelineno-64-64"></a><span class="c1"># Apply custom Configs in file</span>
<a id="__codelineno-64-65" name="__codelineno-64-65" href="#__codelineno-64-65"></a>./scripts/kconfig/merge_config.sh<span class="w"> </span>-O<span class="w"> </span>./<span class="w"> </span>./.config<span class="w"> </span>./config-fragment-agilex5
<a id="__codelineno-64-66" name="__codelineno-64-66" href="#__codelineno-64-66"></a>
<a id="__codelineno-64-67" name="__codelineno-64-67" href="#__codelineno-64-67"></a>make<span class="w"> </span>oldconfig
<a id="__codelineno-64-68" name="__codelineno-64-68" href="#__codelineno-64-68"></a>make<span class="w"> </span>-j<span class="w"> </span><span class="m">64</span><span class="w"> </span>Image<span class="w"> </span>dtbs
</code></pre></div>
<p>The output files from this stage are:</p>
<ul>
<li>$TOP_FOLDER/linux-socfpga-qspi/arch/arm64/boot/Image</li>
<li>$TOP_FOLDER/linux-socfpga-qspi/arch/arm64/boot/dts/intel/socfpga_agilex_socdk_atfboot.dtb</li>
</ul>
<h4>Buid QSPI Image</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>jic_qspi
<a id="__codelineno-65-3" name="__codelineno-65-3" href="#__codelineno-65-3"></a>mkdir<span class="w"> </span>jic_qspi<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>jic_qspi
<a id="__codelineno-65-4" name="__codelineno-65-4" href="#__codelineno-65-4"></a>
<a id="__codelineno-65-5" name="__codelineno-65-5" href="#__codelineno-65-5"></a><span class="c1">## Create .pfg to create the .jic</span>
<a id="__codelineno-65-6" name="__codelineno-65-6" href="#__codelineno-65-6"></a>cat<span class="w"> </span><span class="s">&lt;&lt; EOF &gt; qspi_flash_image_agilex_boot.pfg</span>
<a id="__codelineno-65-7" name="__codelineno-65-7" href="#__codelineno-65-7"></a><span class="s">&lt;pfg version=&quot;1&quot;&gt;</span>
<a id="__codelineno-65-8" name="__codelineno-65-8" href="#__codelineno-65-8"></a><span class="s">  &lt;settings custom_db_dir=&quot;./&quot; mode=&quot;ASX4&quot;/&gt;</span>
<a id="__codelineno-65-9" name="__codelineno-65-9" href="#__codelineno-65-9"></a><span class="s">  &lt;output_files&gt;</span>
<a id="__codelineno-65-10" name="__codelineno-65-10" href="#__codelineno-65-10"></a><span class="s">      &lt;output_file name=&quot;flash_image_atf_qspi&quot; directory=&quot;.&quot; type=&quot;JIC&quot;&gt;</span>
<a id="__codelineno-65-11" name="__codelineno-65-11" href="#__codelineno-65-11"></a><span class="s">          &lt;file_options/&gt;</span>
<a id="__codelineno-65-12" name="__codelineno-65-12" href="#__codelineno-65-12"></a><span class="s">          &lt;secondary_file type=&quot;MAP&quot; name=&quot;flash_image_atf_qspi_jic&quot;&gt;</span>
<a id="__codelineno-65-13" name="__codelineno-65-13" href="#__codelineno-65-13"></a><span class="s">              &lt;file_options/&gt;</span>
<a id="__codelineno-65-14" name="__codelineno-65-14" href="#__codelineno-65-14"></a><span class="s">          &lt;/secondary_file&gt;</span>
<a id="__codelineno-65-15" name="__codelineno-65-15" href="#__codelineno-65-15"></a><span class="s">          &lt;secondary_file type=&quot;SEC_RPD&quot; name=&quot;flash_image_atf_qspi_jic&quot;&gt;</span>
<a id="__codelineno-65-16" name="__codelineno-65-16" href="#__codelineno-65-16"></a><span class="s">              &lt;file_options bitswap=&quot;1&quot;/&gt;</span>
<a id="__codelineno-65-17" name="__codelineno-65-17" href="#__codelineno-65-17"></a><span class="s">          &lt;/secondary_file&gt;</span>
<a id="__codelineno-65-18" name="__codelineno-65-18" href="#__codelineno-65-18"></a><span class="s">          &lt;flash_device_id&gt;Flash_Device_1&lt;/flash_device_id&gt;</span>
<a id="__codelineno-65-19" name="__codelineno-65-19" href="#__codelineno-65-19"></a><span class="s">      &lt;/output_file&gt;</span>
<a id="__codelineno-65-20" name="__codelineno-65-20" href="#__codelineno-65-20"></a><span class="s">  &lt;/output_files&gt;</span>
<a id="__codelineno-65-21" name="__codelineno-65-21" href="#__codelineno-65-21"></a><span class="s">  &lt;bitstreams&gt;</span>
<a id="__codelineno-65-22" name="__codelineno-65-22" href="#__codelineno-65-22"></a><span class="s">      &lt;bitstream id=&quot;Bitstream_1&quot;&gt;</span>
<a id="__codelineno-65-23" name="__codelineno-65-23" href="#__codelineno-65-23"></a><span class="s">          &lt;path hps_path=&quot;./fsbl.hex&quot;&gt;./legacy_baseline.sof&lt;/path&gt;</span>
<a id="__codelineno-65-24" name="__codelineno-65-24" href="#__codelineno-65-24"></a><span class="s">      &lt;/bitstream&gt;</span>
<a id="__codelineno-65-25" name="__codelineno-65-25" href="#__codelineno-65-25"></a><span class="s">  &lt;/bitstreams&gt;</span>
<a id="__codelineno-65-26" name="__codelineno-65-26" href="#__codelineno-65-26"></a><span class="s">  &lt;raw_files&gt;</span>
<a id="__codelineno-65-27" name="__codelineno-65-27" href="#__codelineno-65-27"></a><span class="s">      &lt;raw_file bitswap=&quot;1&quot; type=&quot;RBF&quot; id=&quot;Raw_File_1&quot;&gt;fip.bin&lt;/raw_file&gt;</span>
<a id="__codelineno-65-28" name="__codelineno-65-28" href="#__codelineno-65-28"></a><span class="s">      &lt;raw_file bitswap=&quot;1&quot; type=&quot;RBF&quot; id=&quot;Raw_File_2&quot;&gt;rootfs.bin&lt;/raw_file&gt;</span>
<a id="__codelineno-65-29" name="__codelineno-65-29" href="#__codelineno-65-29"></a><span class="s">  &lt;/raw_files&gt;</span>
<a id="__codelineno-65-30" name="__codelineno-65-30" href="#__codelineno-65-30"></a><span class="s">  &lt;flash_devices&gt;</span>
<a id="__codelineno-65-31" name="__codelineno-65-31" href="#__codelineno-65-31"></a><span class="s">      &lt;flash_device type=&quot;MT25QU02G&quot; id=&quot;Flash_Device_1&quot;&gt;</span>
<a id="__codelineno-65-32" name="__codelineno-65-32" href="#__codelineno-65-32"></a><span class="s">          &lt;partition reserved=&quot;1&quot; fixed_s_addr=&quot;1&quot; s_addr=&quot;0x00000000&quot; e_addr=&quot;0x001FFFFF&quot; fixed_e_addr=&quot;1&quot; id=&quot;BOOT_INFO&quot; size=&quot;0&quot;/&gt;</span>
<a id="__codelineno-65-33" name="__codelineno-65-33" href="#__codelineno-65-33"></a><span class="s">          &lt;partition reserved=&quot;0&quot; fixed_s_addr=&quot;0&quot; s_addr=&quot;auto&quot; e_addr=&quot;auto&quot; fixed_e_addr=&quot;0&quot; id=&quot;P1&quot; size=&quot;0&quot;/&gt;</span>
<a id="__codelineno-65-34" name="__codelineno-65-34" href="#__codelineno-65-34"></a><span class="s">          &lt;partition reserved=&quot;0&quot; fixed_s_addr=&quot;0&quot; s_addr=&quot;0x03C00000&quot; e_addr=&quot;auto&quot; fixed_e_addr=&quot;0&quot; id=&quot;fip&quot; size=&quot;0&quot;/&gt;</span>
<a id="__codelineno-65-35" name="__codelineno-65-35" href="#__codelineno-65-35"></a><span class="s">          &lt;partition reserved=&quot;0&quot; fixed_s_addr=&quot;0&quot; s_addr=&quot;0x07000000&quot; e_addr=&quot;auto&quot; fixed_e_addr=&quot;0&quot; id=&quot;Rootfs&quot; size=&quot;0&quot;/&gt;</span>
<a id="__codelineno-65-36" name="__codelineno-65-36" href="#__codelineno-65-36"></a><span class="s">      &lt;/flash_device&gt;</span>
<a id="__codelineno-65-37" name="__codelineno-65-37" href="#__codelineno-65-37"></a><span class="s">      &lt;flash_loader&gt;A5ED065BB32AE6SR0&lt;/flash_loader&gt;</span>
<a id="__codelineno-65-38" name="__codelineno-65-38" href="#__codelineno-65-38"></a><span class="s">  &lt;/flash_devices&gt;</span>
<a id="__codelineno-65-39" name="__codelineno-65-39" href="#__codelineno-65-39"></a><span class="s">  &lt;assignments&gt;</span>
<a id="__codelineno-65-40" name="__codelineno-65-40" href="#__codelineno-65-40"></a><span class="s">      &lt;assignment page=&quot;0&quot; partition_id=&quot;P1&quot;&gt;</span>
<a id="__codelineno-65-41" name="__codelineno-65-41" href="#__codelineno-65-41"></a><span class="s">          &lt;bitstream_id&gt;Bitstream_1&lt;/bitstream_id&gt;</span>
<a id="__codelineno-65-42" name="__codelineno-65-42" href="#__codelineno-65-42"></a><span class="s">      &lt;/assignment&gt;</span>
<a id="__codelineno-65-43" name="__codelineno-65-43" href="#__codelineno-65-43"></a><span class="s">      &lt;assignment page=&quot;0&quot; partition_id=&quot;fip&quot;&gt;</span>
<a id="__codelineno-65-44" name="__codelineno-65-44" href="#__codelineno-65-44"></a><span class="s">          &lt;raw_file_id&gt;Raw_File_1&lt;/raw_file_id&gt;</span>
<a id="__codelineno-65-45" name="__codelineno-65-45" href="#__codelineno-65-45"></a><span class="s">      &lt;/assignment&gt;</span>
<a id="__codelineno-65-46" name="__codelineno-65-46" href="#__codelineno-65-46"></a><span class="s">      &lt;assignment page=&quot;0&quot; partition_id=&quot;Rootfs&quot;&gt;</span>
<a id="__codelineno-65-47" name="__codelineno-65-47" href="#__codelineno-65-47"></a><span class="s">          &lt;raw_file_id&gt;Raw_File_2&lt;/raw_file_id&gt;</span>
<a id="__codelineno-65-48" name="__codelineno-65-48" href="#__codelineno-65-48"></a><span class="s">      &lt;/assignment&gt;</span>
<a id="__codelineno-65-49" name="__codelineno-65-49" href="#__codelineno-65-49"></a><span class="s">  &lt;/assignments&gt;</span>
<a id="__codelineno-65-50" name="__codelineno-65-50" href="#__codelineno-65-50"></a><span class="s">&lt;/pfg&gt;</span>
<a id="__codelineno-65-51" name="__codelineno-65-51" href="#__codelineno-65-51"></a><span class="s">EOF</span>
<a id="__codelineno-65-52" name="__codelineno-65-52" href="#__codelineno-65-52"></a>
<a id="__codelineno-65-53" name="__codelineno-65-53" href="#__codelineno-65-53"></a><span class="c1"># Convert bl2.bin</span>
<a id="__codelineno-65-54" name="__codelineno-65-54" href="#__codelineno-65-54"></a>aarch64-none-linux-gnu-objcopy<span class="w"> </span>-v<span class="w"> </span>-I<span class="w"> </span>binary<span class="w"> </span>-O<span class="w"> </span>ihex<span class="w"> </span>--change-addresses<span class="w"> </span>0x00000000<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/arm-trusted-firmware-qspi/build/agilex5/release/bl2.bin<span class="w"> </span>fsbl.hex
<a id="__codelineno-65-55" name="__codelineno-65-55" href="#__codelineno-65-55"></a>
<a id="__codelineno-65-56" name="__codelineno-65-56" href="#__codelineno-65-56"></a><span class="c1"># Build FIP Image  </span>
<a id="__codelineno-65-57" name="__codelineno-65-57" href="#__codelineno-65-57"></a><span class="nv">$TOP_FOLDER</span>/arm-trusted-firmware-qspi/tools/fiptool/fiptool<span class="w"> </span>create<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-65-58" name="__codelineno-65-58" href="#__codelineno-65-58"></a>--soc-fw<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/arm-trusted-firmware-qspi/build/agilex5/release/bl31.bin<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-65-59" name="__codelineno-65-59" href="#__codelineno-65-59"></a>--nt-fw<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/linux-socfpga-qspi/arch/arm64/boot/Image<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-65-60" name="__codelineno-65-60" href="#__codelineno-65-60"></a>--nt-fw-config<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/linux-socfpga-qspi/arch/arm64/boot/dts/intel/socfpga_agilex5_socdk_atfboot.dtb<span class="w"> </span>fip.bin
<a id="__codelineno-65-61" name="__codelineno-65-61" href="#__codelineno-65-61"></a>
<a id="__codelineno-65-62" name="__codelineno-65-62" href="#__codelineno-65-62"></a><span class="c1"># Create the jic file</span>
<a id="__codelineno-65-63" name="__codelineno-65-63" href="#__codelineno-65-63"></a>ln<span class="w"> </span>-s<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/agilex5_soc_devkit_ghrd_sdqspi/output_files/legacy_baseline.sof<span class="w"> </span>legacy_baseline.sof
<a id="__codelineno-65-64" name="__codelineno-65-64" href="#__codelineno-65-64"></a>ln<span class="w"> </span>-s<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/yocto/build/tmp/deploy/images/agilex5_dk_a5e065bb32aes1/core-image-minimal-agilex5_dk_a5e065bb32aes1.rootfs.jffs2<span class="w"> </span>rootfs.bin
<a id="__codelineno-65-65" name="__codelineno-65-65" href="#__codelineno-65-65"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>qspi_flash_image_agilex_boot.pfg
</code></pre></div>
<p>After building, you can use the following binary to exercise the ATF to Linux boot flow booting from QSPI:</p>
<ul>
<li>$TOP_FOLDER/jic_qspi/flash_image_atf_qspi.jic</li>
</ul>
<p>When booting with the binaries generated, this is the log that you will see. This is the log is just a refenrece and captured by the time the page was created and in the future the versions in the components may change.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a>NOTICE:  DDR: Reset type is &#39;Power-On&#39;
<a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a>NOTICE:  IOSSM: Calibration success status check...
<a id="__codelineno-66-3" name="__codelineno-66-3" href="#__codelineno-66-3"></a>NOTICE:  IOSSM: All EMIF instances within the IO96 have calibrated successfully!
<a id="__codelineno-66-4" name="__codelineno-66-4" href="#__codelineno-66-4"></a>NOTICE:  DDR: Calibration success
<a id="__codelineno-66-5" name="__codelineno-66-5" href="#__codelineno-66-5"></a>NOTICE:  ###DDR:init success###
<a id="__codelineno-66-6" name="__codelineno-66-6" href="#__codelineno-66-6"></a>NOTICE:  SOCFPGA: QSPI boot
<a id="__codelineno-66-7" name="__codelineno-66-7" href="#__codelineno-66-7"></a>NOTICE:  BL2: v2.11.1(release):QPDS24.1STD_REL_GSRD_PR-dirty
<a id="__codelineno-66-8" name="__codelineno-66-8" href="#__codelineno-66-8"></a>NOTICE:  BL2: Built : 13:04:50, Mar 25 2025
<a id="__codelineno-66-9" name="__codelineno-66-9" href="#__codelineno-66-9"></a>NOTICE:  BL2: Booting BL31
<a id="__codelineno-66-10" name="__codelineno-66-10" href="#__codelineno-66-10"></a>NOTICE:  SOCFPGA: Boot Core = 0
<a id="__codelineno-66-11" name="__codelineno-66-11" href="#__codelineno-66-11"></a>NOTICE:  SOCFPGA: CPU ID = 0
<a id="__codelineno-66-12" name="__codelineno-66-12" href="#__codelineno-66-12"></a>NOTICE:  BL31: v2.11.1(release):QPDS24.1STD_REL_GSRD_PR-dirty
<a id="__codelineno-66-13" name="__codelineno-66-13" href="#__codelineno-66-13"></a>NOTICE:  BL31: Built : 13:04:57, Mar 25 2025
<a id="__codelineno-66-14" name="__codelineno-66-14" href="#__codelineno-66-14"></a>[    0.000000] Booting Linux on physical CPU 0x0000000000 [0x412fd050]
<a id="__codelineno-66-15" name="__codelineno-66-15" href="#__codelineno-66-15"></a>[    0.000000] Linux version 6.6.51-g7dddbad0a3a7-dirty (rolando@rolando3-linux-lab) (aarch64-none-linux-gnu-gcc (GNU Toolchain for the Arm Architecture 11.2-2022.02 (arm-11.14)) 11.2.1 20220111, GNU ld (GNU Toolchain for the Arm Architecture 11.2-2022.02 (arm-11.14)) 2.37.20220122) #1 SMP PREEMPT Mon Mar 31 17:55:55 CDT 2025
<a id="__codelineno-66-16" name="__codelineno-66-16" href="#__codelineno-66-16"></a>[    0.000000] KASLR disabled due to lack of seed
<a id="__codelineno-66-17" name="__codelineno-66-17" href="#__codelineno-66-17"></a>[    0.000000] Machine model: SoCFPGA Agilex5 SoCDK
<a id="__codelineno-66-18" name="__codelineno-66-18" href="#__codelineno-66-18"></a>[    0.000000] efi: UEFI not found.
<a id="__codelineno-66-19" name="__codelineno-66-19" href="#__codelineno-66-19"></a>[    0.000000] Reserved memory: created DMA memory pool at 0x0000000080000000, size 32 MiB
<a id="__codelineno-66-20" name="__codelineno-66-20" href="#__codelineno-66-20"></a>[    0.000000] OF: reserved mem: initialized node svcbuffer@0, compatible id shared-dma-pool
<a id="__codelineno-66-21" name="__codelineno-66-21" href="#__codelineno-66-21"></a>[    0.000000] OF: reserved mem: 0x0000000080000000..0x0000000081ffffff (32768 KiB) nomap non-reusable svcbuffer@0
<a id="__codelineno-66-22" name="__codelineno-66-22" href="#__codelineno-66-22"></a>[    0.000000] earlycon: uart0 at MMIO32 0x0000000010c02000 (options &#39;115200n8&#39;)
<a id="__codelineno-66-23" name="__codelineno-66-23" href="#__codelineno-66-23"></a>[    0.000000] printk: bootconsole [uart0] enabled
<a id="__codelineno-66-24" name="__codelineno-66-24" href="#__codelineno-66-24"></a>:
<a id="__codelineno-66-25" name="__codelineno-66-25" href="#__codelineno-66-25"></a>[    0.000000] Kernel command line: console=ttys0,115200 earlycon panic=-1 root=/dev/mtdblock1 rw rootfstype=jffs2 rootwait
<a id="__codelineno-66-26" name="__codelineno-66-26" href="#__codelineno-66-26"></a>:
<a id="__codelineno-66-27" name="__codelineno-66-27" href="#__codelineno-66-27"></a>[    5.420883] socfpga-dwmac 10830000.ethernet eth0: PHY [stmmac-2:00] driver [Generic PHY] (irq=POLL)
<a id="__codelineno-66-28" name="__codelineno-66-28" href="#__codelineno-66-28"></a>[    5.430051] socfpga-dwmac 10830000.ethernet eth0: No Safety Features support found
<a id="__codelineno-66-29" name="__codelineno-66-29" href="#__codelineno-66-29"></a>[    5.437626] socfpga-dwmac 10830000.ethernet eth0: IEEE 1588-2008 Advanced Timestamp supported
<a id="__codelineno-66-30" name="__codelineno-66-30" href="#__codelineno-66-30"></a>[    5.446552] socfpga-dwmac 10830000.ethernet eth0: registered PTP clock
<a id="__codelineno-66-31" name="__codelineno-66-31" href="#__codelineno-66-31"></a>[    5.453515] socfpga-dwmac 10830000.ethernet eth0: FPE workqueue start
<a id="__codelineno-66-32" name="__codelineno-66-32" href="#__codelineno-66-32"></a>[    5.459947] socfpga-dwmac 10830000.ethernet eth0: configuring for phy/rgmii link mode
<a id="__codelineno-66-33" name="__codelineno-66-33" href="#__codelineno-66-33"></a>[    9.565492] socfpga-dwmac 10830000.ethernet eth0: Link is Up - 1Gbps/Full - flow control rx/tx
<a id="__codelineno-66-34" name="__codelineno-66-34" href="#__codelineno-66-34"></a>[   15.047704] dw-apb-uart 10c02000.serial: failed to request DMA
<a id="__codelineno-66-35" name="__codelineno-66-35" href="#__codelineno-66-35"></a>
<a id="__codelineno-66-36" name="__codelineno-66-36" href="#__codelineno-66-36"></a>Poky (Yocto Project Reference Distro) 5.1.3 agilex5_dk_a5e065bb32aes1 /dev/ttyS0
<a id="__codelineno-66-37" name="__codelineno-66-37" href="#__codelineno-66-37"></a>
<a id="__codelineno-66-38" name="__codelineno-66-38" href="#__codelineno-66-38"></a>agilex5_dk_a5e065bb32aes1 login: root
<a id="__codelineno-66-39" name="__codelineno-66-39" href="#__codelineno-66-39"></a>
<a id="__codelineno-66-40" name="__codelineno-66-40" href="#__codelineno-66-40"></a>WARNING: Poky is a reference Yocto Project distribution that should be used for testing and development purposes only. It is recommended that you create your own distribution for production use.
<a id="__codelineno-66-41" name="__codelineno-66-41" href="#__codelineno-66-41"></a>
<a id="__codelineno-66-42" name="__codelineno-66-42" href="#__codelineno-66-42"></a>root@agilex5_dk_a5e065bb32aes1:~# 
</code></pre></div>
<h3 id="boot-from-emmc_1">Boot from eMMC<a class="headerlink" href="#boot-from-emmc_1" title="Permanent link">&para;</a></h3>
<p>This section provides instructions to build binaries to exercise ATF to Linux direct boot flow booting from a eMMC card.</p>
<p>The GHRD must be re-built as this time it's required a hardware design specific to boot from eMMC.  ATF also requires to be rebuilt to enable booting from eMMC by setting SOCFPGA_BOOT_SOURCE_SDMMC to '1' and setting MMC_DEVICE_TYPE to '0' (eMMC used instead of SD Card). Linux also need to be re-built because we need to addapt the device tree to use the correct configuration to boot from eMMC. The FIP image and the eMMC image are created in the same way than for the SD Card use case.</p>
<p><a class="glightbox" href="../images/ATF_Linux_Image_eMMC.jpg" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="" src="../images/ATF_Linux_Image_eMMC.jpg" /></a> </p>
<h4>Toolchain Setup (ATF-To-Linux)</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a>sudo<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>agilex5_boot.atf2linux_emmc
<a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a>mkdir<span class="w"> </span>agilex5_boot.atf2linux_emmc<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>agilex5_boot.atf2linux_emmc
<a id="__codelineno-67-3" name="__codelineno-67-3" href="#__codelineno-67-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">TOP_FOLDER</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
</code></pre></div>
<p>Download the compiler toolchain, add it to the PATH variable, to be used by the GHRD makefile to build the HPS Debug FSBL:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a>wget<span class="w"> </span>https://developer.arm.com/-/media/Files/downloads/gnu/14.3.rel1/binrel/<span class="se">\</span>
<a id="__codelineno-68-3" name="__codelineno-68-3" href="#__codelineno-68-3"></a>arm-gnu-toolchain-14.3.rel1-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-68-4" name="__codelineno-68-4" href="#__codelineno-68-4"></a>tar<span class="w"> </span>xf<span class="w"> </span>arm-gnu-toolchain-14.3.rel1-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-68-5" name="__codelineno-68-5" href="#__codelineno-68-5"></a>rm<span class="w"> </span>-f<span class="w"> </span>arm-gnu-toolchain-14.3.rel1-x86_64-aarch64-none-linux-gnu.tar.xz
<a id="__codelineno-68-6" name="__codelineno-68-6" href="#__codelineno-68-6"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>/arm-gnu-toolchain-14.3.rel1-x86_64-aarch64-none-linux-gnu/bin/:<span class="nv">$PATH</span>
<a id="__codelineno-68-7" name="__codelineno-68-7" href="#__codelineno-68-7"></a><span class="nb">export</span><span class="w"> </span><span class="nv">ARCH</span><span class="o">=</span>arm64
<a id="__codelineno-68-8" name="__codelineno-68-8" href="#__codelineno-68-8"></a><span class="nb">export</span><span class="w"> </span><span class="nv">CROSS_COMPILE</span><span class="o">=</span>aarch64-none-linux-gnu-
</code></pre></div>
<p>Enable Quartus tools to be called from command line:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">QUARTUS_ROOTDIR</span><span class="o">=</span>~/altera_pro/25.1.1/quartus/
<a id="__codelineno-69-2" name="__codelineno-69-2" href="#__codelineno-69-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$QUARTUS_ROOTDIR</span>/bin:<span class="nv">$QUARTUS_ROOTDIR</span>/linux64:<span class="nv">$QUARTUS_ROOTDIR</span>/../qsys/bin:<span class="nv">$PATH</span>
</code></pre></div>
<h4>Build Hardware Design</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-70-2" name="__codelineno-70-2" href="#__codelineno-70-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>agilex5_soc_devkit_ghrd_emmc<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>agilex5_soc_devkit_ghrd_emmc<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>agilex5_soc_devkit_ghrd_emmc
<a id="__codelineno-70-3" name="__codelineno-70-3" href="#__codelineno-70-3"></a>wget<span class="w"> </span>https://github.com/altera-fpga/agilex5e-ed-gsrd/releases/download/QPDS25.1.1_REL_GSRD_PR/a5ed065es-premium-devkit-emmc-legacy-baseline.zip
<a id="__codelineno-70-4" name="__codelineno-70-4" href="#__codelineno-70-4"></a>unzip<span class="w"> </span>a5ed065es-premium-devkit-emmc-legacy-baseline.zip
<a id="__codelineno-70-5" name="__codelineno-70-5" href="#__codelineno-70-5"></a>rm<span class="w"> </span>-f<span class="w"> </span>a5ed065es-premium-devkit-emmc-legacy-baseline.zip
<a id="__codelineno-70-6" name="__codelineno-70-6" href="#__codelineno-70-6"></a>make<span class="w"> </span>legacy_baseline-build
<a id="__codelineno-70-7" name="__codelineno-70-7" href="#__codelineno-70-7"></a>make<span class="w"> </span>legacy_baseline-sw-build
<a id="__codelineno-70-8" name="__codelineno-70-8" href="#__codelineno-70-8"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li>$TOP_FOLDER/agilex5_soc_devkit_ghrd_emmc/output_files/legacy_baseline.sof</li>
</ul>
<h4>Build Arm Trusted Firmware</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-71-2" name="__codelineno-71-2" href="#__codelineno-71-2"></a><span class="c1"># Building ATF</span>
<a id="__codelineno-71-3" name="__codelineno-71-3" href="#__codelineno-71-3"></a>rm<span class="w"> </span>-rf<span class="w"> </span>arm-trusted-firmware-emmc
<a id="__codelineno-71-4" name="__codelineno-71-4" href="#__codelineno-71-4"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS25.1.1_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-fpga/arm-trusted-firmware<span class="w"> </span>arm-trusted-firmware-emmc
<a id="__codelineno-71-5" name="__codelineno-71-5" href="#__codelineno-71-5"></a><span class="nb">cd</span><span class="w"> </span>arm-trusted-firmware-emmc
<a id="__codelineno-71-6" name="__codelineno-71-6" href="#__codelineno-71-6"></a><span class="c1"># Indicate that we will boot from eMMC instead of SDCard</span>
<a id="__codelineno-71-7" name="__codelineno-71-7" href="#__codelineno-71-7"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/\#define MMC_DEVICE_TYPE.*/\#define MMC_DEVICE_TYPE                       0  \/\* MMC = 0, SD = 1 \*\//g&#39;</span><span class="w"> </span>plat/intel/soc/agilex5/include/socfpga_plat_def.h
<a id="__codelineno-71-8" name="__codelineno-71-8" href="#__codelineno-71-8"></a><span class="c1"># Workaround for HSD: 15018072763. Will be fixed in 25.3</span>
<a id="__codelineno-71-9" name="__codelineno-71-9" href="#__codelineno-71-9"></a>sed<span class="w"> </span>-i<span class="w">  </span><span class="s1">&#39;s/struct cdns_idmac_desc cdns_desc\[CONFIG_CDNS_DESC_COUNT\];/struct cdns_idmac_desc cdns_desc\[CONFIG_CDNS_DESC_COUNT\]  __aligned(8);/g&#39;</span><span class="w"> </span>drivers/cadence/emmc/cdns_sdmmc.c
<a id="__codelineno-71-10" name="__codelineno-71-10" href="#__codelineno-71-10"></a>
<a id="__codelineno-71-11" name="__codelineno-71-11" href="#__codelineno-71-11"></a>make<span class="w"> </span>realclean
<a id="__codelineno-71-12" name="__codelineno-71-12" href="#__codelineno-71-12"></a><span class="c1"># Setting Bootsource as SDMMC</span>
<a id="__codelineno-71-13" name="__codelineno-71-13" href="#__codelineno-71-13"></a>make<span class="w"> </span>bl2<span class="w"> </span>bl31<span class="w"> </span><span class="nv">PLAT</span><span class="o">=</span>agilex5<span class="w"> </span><span class="nv">ARM_LINUX_KERNEL_AS_BL33</span><span class="o">=</span><span class="m">1</span><span class="w">  </span><span class="nv">PRELOADED_BL33_BASE</span><span class="o">=</span>0x82000000<span class="w"> </span><span class="nv">ARM_PRELOADED_DTB_BASE</span><span class="o">=</span>0x90000000<span class="w"> </span><span class="nv">SOCFPGA_BOOT_SOURCE_SDMMC</span><span class="o">=</span><span class="m">1</span>
<a id="__codelineno-71-14" name="__codelineno-71-14" href="#__codelineno-71-14"></a>
<a id="__codelineno-71-15" name="__codelineno-71-15" href="#__codelineno-71-15"></a><span class="c1"># Create Fiptool tool</span>
<a id="__codelineno-71-16" name="__codelineno-71-16" href="#__codelineno-71-16"></a>make<span class="w"> </span>-C<span class="w"> </span>tools/fiptool<span class="w"> </span>clean
<a id="__codelineno-71-17" name="__codelineno-71-17" href="#__codelineno-71-17"></a>make<span class="w"> </span>fiptool
<a id="__codelineno-71-18" name="__codelineno-71-18" href="#__codelineno-71-18"></a><span class="nb">cd</span><span class="w"> </span>..
</code></pre></div>
<p>The following files are created:</p>
<ul>
<li>$TOP_FOLDER/arm-trusted-firmware-emmc/build/agilex5/release/bl2.bin </li>
<li>$TOP_FOLDER/arm-trusted-firmware-emmc/build/agilex5/release/bl31.bin</li>
<li>$TOP_FOLDER/arm-trusted-firmware-emmc/tools/fiptool/fiptool</li>
</ul>
<h4>Build Linux</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-72-2" name="__codelineno-72-2" href="#__codelineno-72-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>linux-socfpga-emmc
<a id="__codelineno-72-3" name="__codelineno-72-3" href="#__codelineno-72-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>QPDS25.1.1_REL_GSRD_PR<span class="w"> </span>https://github.com/altera-fpga/linux-socfpga<span class="w"> </span>linux-socfpga-emmc
<a id="__codelineno-72-4" name="__codelineno-72-4" href="#__codelineno-72-4"></a><span class="nb">cd</span><span class="w"> </span>linux-socfpga-emmc
<a id="__codelineno-72-5" name="__codelineno-72-5" href="#__codelineno-72-5"></a>
<a id="__codelineno-72-6" name="__codelineno-72-6" href="#__codelineno-72-6"></a><span class="c1"># Create a device tree for this flow in which we create the command line to get the file system from QSPI</span>
<a id="__codelineno-72-7" name="__codelineno-72-7" href="#__codelineno-72-7"></a>cat<span class="w"> </span><span class="s">&lt;&lt; EOF &gt; arch/arm64/boot/dts/intel/socfpga_agilex5_socdk_atfboot.dts</span>
<a id="__codelineno-72-8" name="__codelineno-72-8" href="#__codelineno-72-8"></a><span class="s">#include &quot;socfpga_agilex5_socdk_emmc.dts&quot;</span>
<a id="__codelineno-72-9" name="__codelineno-72-9" href="#__codelineno-72-9"></a>
<a id="__codelineno-72-10" name="__codelineno-72-10" href="#__codelineno-72-10"></a><span class="s">/ {</span>
<a id="__codelineno-72-11" name="__codelineno-72-11" href="#__codelineno-72-11"></a>
<a id="__codelineno-72-12" name="__codelineno-72-12" href="#__codelineno-72-12"></a><span class="s">    model = &quot;SoCFPGA Agilex5 SoCDK&quot;;</span>
<a id="__codelineno-72-13" name="__codelineno-72-13" href="#__codelineno-72-13"></a><span class="s">    compatible = &quot;intel,socfpga-agilex5-socdk&quot;, &quot;intel,socfpga-agilex5&quot;;</span>
<a id="__codelineno-72-14" name="__codelineno-72-14" href="#__codelineno-72-14"></a>
<a id="__codelineno-72-15" name="__codelineno-72-15" href="#__codelineno-72-15"></a><span class="s">    chosen {</span>
<a id="__codelineno-72-16" name="__codelineno-72-16" href="#__codelineno-72-16"></a><span class="s">       stdout-path = &quot;serial0:115200n8&quot;;</span>
<a id="__codelineno-72-17" name="__codelineno-72-17" href="#__codelineno-72-17"></a><span class="s">       bootargs = &quot;console=ttys0,115200 earlycon panic=-1 root=/dev/mmcblk0p2 rw rootwait&quot;;</span>
<a id="__codelineno-72-18" name="__codelineno-72-18" href="#__codelineno-72-18"></a>
<a id="__codelineno-72-19" name="__codelineno-72-19" href="#__codelineno-72-19"></a><span class="s">    };</span>
<a id="__codelineno-72-20" name="__codelineno-72-20" href="#__codelineno-72-20"></a>
<a id="__codelineno-72-21" name="__codelineno-72-21" href="#__codelineno-72-21"></a><span class="s">};</span>
<a id="__codelineno-72-22" name="__codelineno-72-22" href="#__codelineno-72-22"></a><span class="s">EOF</span>
<a id="__codelineno-72-23" name="__codelineno-72-23" href="#__codelineno-72-23"></a>
<a id="__codelineno-72-24" name="__codelineno-72-24" href="#__codelineno-72-24"></a><span class="c1"># Build socfpga_agilex5_socdk_atfboot.dtb</span>
<a id="__codelineno-72-25" name="__codelineno-72-25" href="#__codelineno-72-25"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;/socfpga_agilex5_socdk.dtb \\/a socfpga_agilex5_socdk_atfboot.dtb \\&#39;</span><span class="w"> </span>arch/arm64/boot/dts/intel/Makefile
<a id="__codelineno-72-26" name="__codelineno-72-26" href="#__codelineno-72-26"></a>
<a id="__codelineno-72-27" name="__codelineno-72-27" href="#__codelineno-72-27"></a>cat<span class="w"> </span><span class="s">&lt;&lt; EOF &gt; config-fragment-agilex5</span>
<a id="__codelineno-72-28" name="__codelineno-72-28" href="#__codelineno-72-28"></a><span class="s"># Enable DHCP </span>
<a id="__codelineno-72-29" name="__codelineno-72-29" href="#__codelineno-72-29"></a><span class="s">CONFIG_IP_PNP_DHCP=y</span>
<a id="__codelineno-72-30" name="__codelineno-72-30" href="#__codelineno-72-30"></a><span class="s"># enable kernel debugging with RiscFree</span>
<a id="__codelineno-72-31" name="__codelineno-72-31" href="#__codelineno-72-31"></a><span class="s">CONFIG_DEBUG_INFO=y</span>
<a id="__codelineno-72-32" name="__codelineno-72-32" href="#__codelineno-72-32"></a><span class="s">CONFIG_GDB_SCRIPTS=y</span>
<a id="__codelineno-72-33" name="__codelineno-72-33" href="#__codelineno-72-33"></a><span class="s">CONFIG_INITRAMFS_ROOT_UID=0</span>
<a id="__codelineno-72-34" name="__codelineno-72-34" href="#__codelineno-72-34"></a><span class="s">CONFIG_INITRAMFS_ROOT_GID=0</span>
<a id="__codelineno-72-35" name="__codelineno-72-35" href="#__codelineno-72-35"></a><span class="s">CONFIG_INITRAMFS_COMPRESSION_GZIP=y</span>
<a id="__codelineno-72-36" name="__codelineno-72-36" href="#__codelineno-72-36"></a>
<a id="__codelineno-72-37" name="__codelineno-72-37" href="#__codelineno-72-37"></a><span class="s"># Include these configs if wanted to perform fpga reconfiguration using overlays (enable device tree overlays and fpga bridges)</span>
<a id="__codelineno-72-38" name="__codelineno-72-38" href="#__codelineno-72-38"></a><span class="s"># Taken from https://altera-fpga.github.io/latest/embedded-designs/agilex-7/f-series/soc/fabric-config/ug-linux-fabric-config-agx7f-soc/</span>
<a id="__codelineno-72-39" name="__codelineno-72-39" href="#__codelineno-72-39"></a><span class="s">CONFIG_OF_RESOLVE=y</span>
<a id="__codelineno-72-40" name="__codelineno-72-40" href="#__codelineno-72-40"></a><span class="s">CONFIG_OF_OVERLAY=y</span>
<a id="__codelineno-72-41" name="__codelineno-72-41" href="#__codelineno-72-41"></a><span class="s">CONFIG_OF_CONFIGFS=y</span>
<a id="__codelineno-72-42" name="__codelineno-72-42" href="#__codelineno-72-42"></a><span class="s">CONFIG_FPGA_MGR_STRATIX10_SOC=y</span>
<a id="__codelineno-72-43" name="__codelineno-72-43" href="#__codelineno-72-43"></a><span class="s">CONFIG_FPGA_BRIDGE=y</span>
<a id="__codelineno-72-44" name="__codelineno-72-44" href="#__codelineno-72-44"></a><span class="s">CONFIG_FPGA_REGION=y</span>
<a id="__codelineno-72-45" name="__codelineno-72-45" href="#__codelineno-72-45"></a><span class="s">CONFIG_OF_FPGA_REGION=y</span>
<a id="__codelineno-72-46" name="__codelineno-72-46" href="#__codelineno-72-46"></a><span class="s">CONFIG_OVERLAY_FS=y</span>
<a id="__codelineno-72-47" name="__codelineno-72-47" href="#__codelineno-72-47"></a><span class="s">CONFIG_ALTERA_SYSID=y</span>
<a id="__codelineno-72-48" name="__codelineno-72-48" href="#__codelineno-72-48"></a>
<a id="__codelineno-72-49" name="__codelineno-72-49" href="#__codelineno-72-49"></a><span class="s"># Needed for netwrok connectivity</span>
<a id="__codelineno-72-50" name="__codelineno-72-50" href="#__codelineno-72-50"></a><span class="s">CONFIG_MARVELL_PHY=y</span>
<a id="__codelineno-72-51" name="__codelineno-72-51" href="#__codelineno-72-51"></a><span class="s">EOF</span>
<a id="__codelineno-72-52" name="__codelineno-72-52" href="#__codelineno-72-52"></a>
<a id="__codelineno-72-53" name="__codelineno-72-53" href="#__codelineno-72-53"></a>make<span class="w"> </span>clean<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>make<span class="w"> </span>mrproper
<a id="__codelineno-72-54" name="__codelineno-72-54" href="#__codelineno-72-54"></a>make<span class="w"> </span>defconfig
<a id="__codelineno-72-55" name="__codelineno-72-55" href="#__codelineno-72-55"></a><span class="c1"># Apply custom Configs in file</span>
<a id="__codelineno-72-56" name="__codelineno-72-56" href="#__codelineno-72-56"></a>./scripts/kconfig/merge_config.sh<span class="w"> </span>-O<span class="w"> </span>./<span class="w"> </span>./.config<span class="w"> </span>./config-fragment-agilex5
<a id="__codelineno-72-57" name="__codelineno-72-57" href="#__codelineno-72-57"></a>
<a id="__codelineno-72-58" name="__codelineno-72-58" href="#__codelineno-72-58"></a>make<span class="w"> </span>oldconfig
<a id="__codelineno-72-59" name="__codelineno-72-59" href="#__codelineno-72-59"></a>make<span class="w"> </span>-j<span class="w"> </span><span class="m">64</span><span class="w"> </span>Image<span class="w"> </span>dtbs
</code></pre></div>
<p>The output files from this stage are:</p>
<ul>
<li>$TOP_FOLDER/linux-socfpga-emmc/arch/arm64/boot/Image</li>
<li>$TOP_FOLDER/linux-socfpga-emmc/arch/arm64/boot/dts/intel/socfpga_agilex_socdk_atfboot.dtb</li>
</ul>
<h4>Build QSPI Image</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>jic_emmc
<a id="__codelineno-73-3" name="__codelineno-73-3" href="#__codelineno-73-3"></a>mkdir<span class="w"> </span>jic_emmc<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>jic_emmc
<a id="__codelineno-73-4" name="__codelineno-73-4" href="#__codelineno-73-4"></a><span class="c1"># Convert fsbl</span>
<a id="__codelineno-73-5" name="__codelineno-73-5" href="#__codelineno-73-5"></a>aarch64-none-linux-gnu-objcopy<span class="w"> </span>-v<span class="w"> </span>-I<span class="w"> </span>binary<span class="w"> </span>-O<span class="w"> </span>ihex<span class="w"> </span>--change-addresses<span class="w"> </span>0x00000000<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/arm-trusted-firmware-emmc/build/agilex5/release/bl2.bin<span class="w"> </span>fsbl.hex
<a id="__codelineno-73-6" name="__codelineno-73-6" href="#__codelineno-73-6"></a>ln<span class="w"> </span>-s<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/agilex5_soc_devkit_ghrd_emmc/output_files/legacy_baseline.sof<span class="w"> </span>legacy_baseline.sof
<a id="__codelineno-73-7" name="__codelineno-73-7" href="#__codelineno-73-7"></a><span class="c1"># Create .jic file</span>
<a id="__codelineno-73-8" name="__codelineno-73-8" href="#__codelineno-73-8"></a>quartus_pfg<span class="w"> </span>-c<span class="w"> </span>legacy_baseline.sof<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-73-9" name="__codelineno-73-9" href="#__codelineno-73-9"></a>emmc_atf.jic<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-73-10" name="__codelineno-73-10" href="#__codelineno-73-10"></a>-o<span class="w"> </span><span class="nv">hps_path</span><span class="o">=</span>fsbl.hex<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-73-11" name="__codelineno-73-11" href="#__codelineno-73-11"></a>-o<span class="w"> </span><span class="nv">device</span><span class="o">=</span>MT25QU128<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-73-12" name="__codelineno-73-12" href="#__codelineno-73-12"></a>-o<span class="w"> </span><span class="nv">flash_loader</span><span class="o">=</span>A5ED065BB32AE6SR0<span class="w">  </span><span class="se">\</span>
<a id="__codelineno-73-13" name="__codelineno-73-13" href="#__codelineno-73-13"></a>-o<span class="w"> </span><span class="nv">mode</span><span class="o">=</span>ASX4<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-73-14" name="__codelineno-73-14" href="#__codelineno-73-14"></a>-o<span class="w"> </span><span class="nv">hps</span><span class="o">=</span><span class="m">1</span>
</code></pre></div>
<p>The following files are created:</p>
<ul>
<li>$TOP_FOLDER/jic_emmc/emmc_atf.hps.jic</li>
<li>$TOP_FOLDER/jic_emmc/emmc_atf.core.rbf</li>
</ul>
<h4>Build Rootfs</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-74-2" name="__codelineno-74-2" href="#__codelineno-74-2"></a>rm<span class="w"> </span>-rf<span class="w"> </span>yocto<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>yocto<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>yocto
<a id="__codelineno-74-3" name="__codelineno-74-3" href="#__codelineno-74-3"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>walnascar<span class="w"> </span>https://git.yoctoproject.org/poky
<a id="__codelineno-74-4" name="__codelineno-74-4" href="#__codelineno-74-4"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>walnascar<span class="w"> </span>https://git.yoctoproject.org/meta-intel-fpga
<a id="__codelineno-74-5" name="__codelineno-74-5" href="#__codelineno-74-5"></a>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>walnascar<span class="w"> </span>https://github.com/openembedded/meta-openembedded
<a id="__codelineno-74-6" name="__codelineno-74-6" href="#__codelineno-74-6"></a><span class="c1"># work around issue</span>
<a id="__codelineno-74-7" name="__codelineno-74-7" href="#__codelineno-74-7"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;do_package_qa[noexec] = &quot;1&quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="k">$(</span>find<span class="w"> </span>meta-intel-fpga<span class="w"> </span>-name<span class="w"> </span>linux-socfpga_6.6.bb<span class="k">)</span>
<a id="__codelineno-74-8" name="__codelineno-74-8" href="#__codelineno-74-8"></a><span class="nb">source</span><span class="w"> </span>poky/oe-init-build-env<span class="w"> </span>./build
<a id="__codelineno-74-9" name="__codelineno-74-9" href="#__codelineno-74-9"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;MACHINE = &quot;agilex5_dk_a5e065bb32aes1&quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>conf/local.conf
<a id="__codelineno-74-10" name="__codelineno-74-10" href="#__codelineno-74-10"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;BBLAYERS += &quot; ${TOPDIR}/../meta-intel-fpga &quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>conf/bblayers.conf
<a id="__codelineno-74-11" name="__codelineno-74-11" href="#__codelineno-74-11"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;BBLAYERS += &quot; ${TOPDIR}/../meta-openembedded/meta-oe &quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>conf/bblayers.conf
<a id="__codelineno-74-12" name="__codelineno-74-12" href="#__codelineno-74-12"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;IMAGE_FSTYPES = &quot;tar.gz cpio jffs2&quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>conf/local.conf
<a id="__codelineno-74-13" name="__codelineno-74-13" href="#__codelineno-74-13"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;CORE_IMAGE_EXTRA_INSTALL += &quot;openssh gdbserver devmem2&quot;&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>conf/local.conf
<a id="__codelineno-74-14" name="__codelineno-74-14" href="#__codelineno-74-14"></a>bitbake<span class="w"> </span>core-image-minimal
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li>$TOP_FOLDER/yocto/build/tmp/deploy/images/agilex5_dk_a5e065bb32aes1/core-image-minimal-agilex5_dk_a5e065bb32aes1.rootfs.tar.gz</li>
</ul>
<h4>Build eMMC Image</h4>

<div class="highlight"><pre><span></span><code><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a><span class="nb">cd</span><span class="w"> </span><span class="nv">$TOP_FOLDER</span>
<a id="__codelineno-75-2" name="__codelineno-75-2" href="#__codelineno-75-2"></a>sudo<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>emmc_image
<a id="__codelineno-75-3" name="__codelineno-75-3" href="#__codelineno-75-3"></a>mkdir<span class="w"> </span>emmc_image<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>emmc_image
<a id="__codelineno-75-4" name="__codelineno-75-4" href="#__codelineno-75-4"></a><span class="c1">## Create FIP image</span>
<a id="__codelineno-75-5" name="__codelineno-75-5" href="#__codelineno-75-5"></a><span class="nv">$TOP_FOLDER</span>/arm-trusted-firmware-emmc/tools/fiptool/fiptool<span class="w"> </span>create<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-75-6" name="__codelineno-75-6" href="#__codelineno-75-6"></a>--soc-fw<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/arm-trusted-firmware-emmc/build/agilex5/release/bl31.bin<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-75-7" name="__codelineno-75-7" href="#__codelineno-75-7"></a>--nt-fw<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/linux-socfpga-emmc/arch/arm64/boot/Image<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-75-8" name="__codelineno-75-8" href="#__codelineno-75-8"></a>--nt-fw-config<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/linux-socfpga-emmc/arch/arm64/boot/dts/intel/socfpga_agilex5_socdk_atfboot.dtb<span class="w"> </span>fip.bin
<a id="__codelineno-75-9" name="__codelineno-75-9" href="#__codelineno-75-9"></a>
<a id="__codelineno-75-10" name="__codelineno-75-10" href="#__codelineno-75-10"></a><span class="c1"># Build now the SDCard</span>
<a id="__codelineno-75-11" name="__codelineno-75-11" href="#__codelineno-75-11"></a>wget<span class="w"> </span>https://releases.rocketboards.org/release/2020.11/gsrd/tools/make_sdimage_p3.py
<a id="__codelineno-75-12" name="__codelineno-75-12" href="#__codelineno-75-12"></a><span class="c1"># remove mkfs.fat parameter which has some issues on Ubuntu 22.04</span>
<a id="__codelineno-75-13" name="__codelineno-75-13" href="#__codelineno-75-13"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/\&quot;\-F 32\&quot;,//g&#39;</span><span class="w"> </span>make_sdimage_p3.py
<a id="__codelineno-75-14" name="__codelineno-75-14" href="#__codelineno-75-14"></a>chmod<span class="w"> </span>+x<span class="w"> </span>make_sdimage_p3.py
<a id="__codelineno-75-15" name="__codelineno-75-15" href="#__codelineno-75-15"></a>mkdir<span class="w"> </span>rootfs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>rootfs
<a id="__codelineno-75-16" name="__codelineno-75-16" href="#__codelineno-75-16"></a>sudo<span class="w"> </span>tar<span class="w"> </span>-xf<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/yocto/build/tmp/deploy/images/agilex5_dk_a5e065bb32aes1/core-image-minimal-agilex5_dk_a5e065bb32aes1.rootfs.tar.gz
<a id="__codelineno-75-17" name="__codelineno-75-17" href="#__codelineno-75-17"></a>sudo<span class="w"> </span>cp<span class="w"> </span><span class="nv">$TOP_FOLDER</span>/jic_emmc/emmc_atf.core.rbf<span class="w"> </span>home/root/
<a id="__codelineno-75-18" name="__codelineno-75-18" href="#__codelineno-75-18"></a>sudo<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>lib/modules/*
<a id="__codelineno-75-19" name="__codelineno-75-19" href="#__codelineno-75-19"></a><span class="nb">cd</span><span class="w"> </span>..
<a id="__codelineno-75-20" name="__codelineno-75-20" href="#__codelineno-75-20"></a>sudo<span class="w"> </span>python3<span class="w"> </span>make_sdimage_p3.py<span class="w"> </span>-f<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-75-21" name="__codelineno-75-21" href="#__codelineno-75-21"></a>-P<span class="w"> </span>fip.bin,num<span class="o">=</span><span class="m">1</span>,format<span class="o">=</span>raw,size<span class="o">=</span>64M,type<span class="o">=</span>a2<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-75-22" name="__codelineno-75-22" href="#__codelineno-75-22"></a>-P<span class="w"> </span>rootfs/*,num<span class="o">=</span><span class="m">2</span>,format<span class="o">=</span>ext3,size<span class="o">=</span>64M<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-75-23" name="__codelineno-75-23" href="#__codelineno-75-23"></a>-s<span class="w"> </span>128M<span class="w"> </span>-n<span class="w"> </span>emmc_atf.img
</code></pre></div>
<p>The following file is created:</p>
<ul>
<li>$TOP_FOLDER/emmc_image/emmc_atf.img</li>
</ul>
<p>You can exercise ATF to Linux boot flow from SD Card using the following binaries generated:</p>
<ul>
<li>$TOP_FOLDER/emmc_image/emmc_atf.img</li>
<li>$TOP_FOLDER/jic_emmc/emmc_atf.hps.jic</li>
</ul>
<p>When booting with the binaries generated, this is the log that you will see. This is the log is just a refenrece and captured by the time the page was created and in the future the versions in the components may change.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a>NOTICE:  DDR: Reset type is &#39;Power-On&#39;
<a id="__codelineno-76-2" name="__codelineno-76-2" href="#__codelineno-76-2"></a>NOTICE:  IOSSM: Calibration success status check...
<a id="__codelineno-76-3" name="__codelineno-76-3" href="#__codelineno-76-3"></a>NOTICE:  IOSSM: All EMIF instances within the IO96 have calibrated successfully!
<a id="__codelineno-76-4" name="__codelineno-76-4" href="#__codelineno-76-4"></a>NOTICE:  DDR: Calibration success
<a id="__codelineno-76-5" name="__codelineno-76-5" href="#__codelineno-76-5"></a>NOTICE:  DDR: ECC is enabled
<a id="__codelineno-76-6" name="__codelineno-76-6" href="#__codelineno-76-6"></a>NOTICE:  IOSSM: Memory initialized successfully on IO96B
<a id="__codelineno-76-7" name="__codelineno-76-7" href="#__codelineno-76-7"></a>NOTICE:  ###DDR:init success###
<a id="__codelineno-76-8" name="__codelineno-76-8" href="#__codelineno-76-8"></a>NOTICE:  DFI interface selected successfully to SDEMMC
<a id="__codelineno-76-9" name="__codelineno-76-9" href="#__codelineno-76-9"></a>NOTICE:  SOCFPGA: SDMMC boot
<a id="__codelineno-76-10" name="__codelineno-76-10" href="#__codelineno-76-10"></a>NOTICE:  BL2: v2.12.1(release):410b93702-dirty
<a id="__codelineno-76-11" name="__codelineno-76-11" href="#__codelineno-76-11"></a>NOTICE:  BL2: Built : 20:10:16, Jul 31 2025
<a id="__codelineno-76-12" name="__codelineno-76-12" href="#__codelineno-76-12"></a>NOTICE:  BL2: Booting BL31
<a id="__codelineno-76-13" name="__codelineno-76-13" href="#__codelineno-76-13"></a>NOTICE:  SOCFPGA: Boot Core = 0
<a id="__codelineno-76-14" name="__codelineno-76-14" href="#__codelineno-76-14"></a>NOTICE:  SOCFPGA: CPU ID = 0
<a id="__codelineno-76-15" name="__codelineno-76-15" href="#__codelineno-76-15"></a>NOTICE:  SOCFPGA: Setting CLUSTERECTRL_EL1
<a id="__codelineno-76-16" name="__codelineno-76-16" href="#__codelineno-76-16"></a>NOTICE:  BL31: v2.12.1(release):410b93702-dirty
<a id="__codelineno-76-17" name="__codelineno-76-17" href="#__codelineno-76-17"></a>NOTICE:  BL31: Built : 20:10:21, Jul 31 2025
<a id="__codelineno-76-18" name="__codelineno-76-18" href="#__codelineno-76-18"></a>[    0.000000] Booting Linux on physical CPU 0x0000000000 [0x412fd050]
<a id="__codelineno-76-19" name="__codelineno-76-19" href="#__codelineno-76-19"></a>[    0.000000] Linux version 6.12.19-g7b497655d942-dirty (rolando@rolando3-linux-lab) (aarch64-none-linux-gnu-gcc (GNU Toolchain for the Arm Architecture 11.2-2022.02 (arm-11.14)) 11.2.1 20220111, GNU ld (GNU Toolchain for the Arm Architecture 11.2-2022.02 (arm-11.14)) 2.37.20220122) #1 SMP PREEMPT Thu Jul 31 19:25:32 CDT 2025
<a id="__codelineno-76-20" name="__codelineno-76-20" href="#__codelineno-76-20"></a>[    0.000000] KASLR disabled due to lack of seed
<a id="__codelineno-76-21" name="__codelineno-76-21" href="#__codelineno-76-21"></a>[    0.000000] Machine model: SoCFPGA Agilex5 SoCDK
<a id="__codelineno-76-22" name="__codelineno-76-22" href="#__codelineno-76-22"></a>[    0.000000] efi: UEFI not found.
<a id="__codelineno-76-23" name="__codelineno-76-23" href="#__codelineno-76-23"></a>[    0.000000] earlycon: uart0 at MMIO32 0x0000000010c02000 (options &#39;115200n8&#39;)
<a id="__codelineno-76-24" name="__codelineno-76-24" href="#__codelineno-76-24"></a>[    0.000000] printk: legacy bootconsole [uart0] enabled
<a id="__codelineno-76-25" name="__codelineno-76-25" href="#__codelineno-76-25"></a>[    0.000000] Reserved memory: created DMA memory pool at 0x0000000080000000, size 32 MiB
<a id="__codelineno-76-26" name="__codelineno-76-26" href="#__codelineno-76-26"></a>[    0.000000] OF: reserved mem: initialized node svcbuffer@0, compatible id shared-dma-pool
<a id="__codelineno-76-27" name="__codelineno-76-27" href="#__codelineno-76-27"></a>[    0.000000] OF: reserved mem: 0x0000000080000000..0x0000000081ffffff (32768 KiB) nomap non-reusable svcbuffer@0
<a id="__codelineno-76-28" name="__codelineno-76-28" href="#__codelineno-76-28"></a>[    0.000000] NUMA: Faking a node at [mem 0x0000000080000000-0x00000000ffffffff]
<a id="__codelineno-76-29" name="__codelineno-76-29" href="#__codelineno-76-29"></a>[    0.000000] NODE_DATA(0) allocated [mem 0xffbf1bc0-0xffbf41ff]
<a id="__codelineno-76-30" name="__codelineno-76-30" href="#__codelineno-76-30"></a>[    0.000000] Zone ranges:
<a id="__codelineno-76-31" name="__codelineno-76-31" href="#__codelineno-76-31"></a>[    0.000000]   DMA      [mem 0x0000000080000000-0x00000000ffffffff]
<a id="__codelineno-76-32" name="__codelineno-76-32" href="#__codelineno-76-32"></a>[    0.000000]   DMA32    empty
<a id="__codelineno-76-33" name="__codelineno-76-33" href="#__codelineno-76-33"></a>[    0.000000]   Normal   empty
<a id="__codelineno-76-34" name="__codelineno-76-34" href="#__codelineno-76-34"></a>[    0.000000] Movable zone start for each node
<a id="__codelineno-76-35" name="__codelineno-76-35" href="#__codelineno-76-35"></a>[    0.000000] Early memory node ranges
<a id="__codelineno-76-36" name="__codelineno-76-36" href="#__codelineno-76-36"></a>[    0.000000]   node   0: [mem 0x0000000080000000-0x0000000081ffffff]
<a id="__codelineno-76-37" name="__codelineno-76-37" href="#__codelineno-76-37"></a>[    0.000000]   node   0: [mem 0x0000000082000000-0x00000000ffffffff]
<a id="__codelineno-76-38" name="__codelineno-76-38" href="#__codelineno-76-38"></a>[    0.000000] Initmem setup node 0 [mem 0x0000000080000000-0x00000000ffffffff]
<a id="__codelineno-76-39" name="__codelineno-76-39" href="#__codelineno-76-39"></a>[    0.000000] cma: Reserved 32 MiB at 0x00000000fba00000 on node -1
<a id="__codelineno-76-40" name="__codelineno-76-40" href="#__codelineno-76-40"></a>[    0.000000] psci: probing for conduit method from DT.
<a id="__codelineno-76-41" name="__codelineno-76-41" href="#__codelineno-76-41"></a>[    0.000000] psci: PSCIv1.1 detected in firmware.
<a id="__codelineno-76-42" name="__codelineno-76-42" href="#__codelineno-76-42"></a>[    0.000000] psci: Using standard PSCI v0.2 function IDs
<a id="__codelineno-76-43" name="__codelineno-76-43" href="#__codelineno-76-43"></a>[    0.000000] psci: MIGRATE_INFO_TYPE not supported.
<a id="__codelineno-76-44" name="__codelineno-76-44" href="#__codelineno-76-44"></a>[    0.000000] psci: SMC Calling Convention v1.5
<a id="__codelineno-76-45" name="__codelineno-76-45" href="#__codelineno-76-45"></a>[    0.000000] percpu: Embedded 25 pages/cpu s61720 r8192 d32488 u102400
<a id="__codelineno-76-46" name="__codelineno-76-46" href="#__codelineno-76-46"></a>[    0.000000] Detected VIPT I-cache on CPU0
<a id="__codelineno-76-47" name="__codelineno-76-47" href="#__codelineno-76-47"></a>[    0.000000] CPU features: detected: GIC system register CPU interface
<a id="__codelineno-76-48" name="__codelineno-76-48" href="#__codelineno-76-48"></a>[    0.000000] CPU features: detected: Virtualization Host Extensions
<a id="__codelineno-76-49" name="__codelineno-76-49" href="#__codelineno-76-49"></a>[    0.000000] CPU features: detected: ARM errata 1165522, 1319367, or 1530923
<a id="__codelineno-76-50" name="__codelineno-76-50" href="#__codelineno-76-50"></a>[    0.000000] alternatives: applying boot alternatives
<a id="__codelineno-76-51" name="__codelineno-76-51" href="#__codelineno-76-51"></a>[    0.000000] Kernel command line: console=ttys0,115200 earlycon panic=-1 root=/dev/mmcblk0p2 rw rootwait
<a id="__codelineno-76-52" name="__codelineno-76-52" href="#__codelineno-76-52"></a>:
<a id="__codelineno-76-53" name="__codelineno-76-53" href="#__codelineno-76-53"></a>[    1.666798] EXT4-fs (mmcblk0p2): mounting ext3 file system using the ext4 subsystem
<a id="__codelineno-76-54" name="__codelineno-76-54" href="#__codelineno-76-54"></a>[    1.682241] EXT4-fs (mmcblk0p2): mounted filesystem c3b5fe0a-760b-4d2d-89dc-022dc29cde2f r/w with ordered data mode. Quota mode: none.
<a id="__codelineno-76-55" name="__codelineno-76-55" href="#__codelineno-76-55"></a>[    1.694467] VFS: Mounted root (ext3 filesystem) on device 179:2.
<a id="__codelineno-76-56" name="__codelineno-76-56" href="#__codelineno-76-56"></a>[    1.703706] devtmpfs: mounted
<a id="__codelineno-76-57" name="__codelineno-76-57" href="#__codelineno-76-57"></a>[    1.718302] Freeing unused kernel memory: 10496K
<a id="__codelineno-76-58" name="__codelineno-76-58" href="#__codelineno-76-58"></a>[    1.723362] Run /sbin/init as init process
<a id="__codelineno-76-59" name="__codelineno-76-59" href="#__codelineno-76-59"></a>[    2.063314] udevd[108]: starting version 3.2.14
<a id="__codelineno-76-60" name="__codelineno-76-60" href="#__codelineno-76-60"></a>[    3.807993] random: crng init done
<a id="__codelineno-76-61" name="__codelineno-76-61" href="#__codelineno-76-61"></a>[    3.849113] udevd[109]: starting eudev-3.2.14
<a id="__codelineno-76-62" name="__codelineno-76-62" href="#__codelineno-76-62"></a>[    4.124172] EXT4-fs (mmcblk0p2): re-mounted c3b5fe0a-760b-4d2d-89dc-022dc29cde2f r/w. Quota mode: none.
<a id="__codelineno-76-63" name="__codelineno-76-63" href="#__codelineno-76-63"></a>[    4.785687] socfpga-dwmac 10810000.ethernet eth0: Register MEM_TYPE_PAGE_POOL RxQ-0
<a id="__codelineno-76-64" name="__codelineno-76-64" href="#__codelineno-76-64"></a>[    4.796266] socfpga-dwmac 10810000.ethernet eth0: Register MEM_TYPE_PAGE_POOL RxQ-1
<a id="__codelineno-76-65" name="__codelineno-76-65" href="#__codelineno-76-65"></a>[    4.807002] socfpga-dwmac 10810000.ethernet eth0: Register MEM_TYPE_PAGE_POOL RxQ-2
<a id="__codelineno-76-66" name="__codelineno-76-66" href="#__codelineno-76-66"></a>[    4.818280] socfpga-dwmac 10810000.ethernet eth0: Register MEM_TYPE_PAGE_POOL RxQ-3
<a id="__codelineno-76-67" name="__codelineno-76-67" href="#__codelineno-76-67"></a>[    4.829721] socfpga-dwmac 10810000.ethernet eth0: Register MEM_TYPE_PAGE_POOL RxQ-4
<a id="__codelineno-76-68" name="__codelineno-76-68" href="#__codelineno-76-68"></a>[    4.840131] socfpga-dwmac 10810000.ethernet eth0: Register MEM_TYPE_PAGE_POOL RxQ-5
<a id="__codelineno-76-69" name="__codelineno-76-69" href="#__codelineno-76-69"></a>[    4.851595] socfpga-dwmac 10810000.ethernet eth0: Register MEM_TYPE_PAGE_POOL RxQ-6
<a id="__codelineno-76-70" name="__codelineno-76-70" href="#__codelineno-76-70"></a>[    4.862012] socfpga-dwmac 10810000.ethernet eth0: Register MEM_TYPE_PAGE_POOL RxQ-7
<a id="__codelineno-76-71" name="__codelineno-76-71" href="#__codelineno-76-71"></a>[    5.044042] socfpga-dwmac 10810000.ethernet eth0: PHY [stmmac-0:00] driver [Marvell 88E1510] (irq=POLL)
<a id="__codelineno-76-72" name="__codelineno-76-72" href="#__codelineno-76-72"></a>[    5.054381] socfpga-dwmac 10810000.ethernet eth0: No Safety Features support found
<a id="__codelineno-76-73" name="__codelineno-76-73" href="#__codelineno-76-73"></a>[    5.062117] socfpga-dwmac 10810000.ethernet eth0: IEEE 1588-2008 Advanced Timestamp supported
<a id="__codelineno-76-74" name="__codelineno-76-74" href="#__codelineno-76-74"></a>[    5.071233] socfpga-dwmac 10810000.ethernet eth0: registered PTP clock
<a id="__codelineno-76-75" name="__codelineno-76-75" href="#__codelineno-76-75"></a>[    5.077845] socfpga-dwmac 10810000.ethernet eth0: configuring for phy/rgmii link mode
<a id="__codelineno-76-76" name="__codelineno-76-76" href="#__codelineno-76-76"></a>[    9.345961] socfpga-dwmac 10810000.ethernet eth0: Link is Up - 1Gbps/Full - flow control rx/tx
<a id="__codelineno-76-77" name="__codelineno-76-77" href="#__codelineno-76-77"></a>[   15.171626] dw-apb-uart 10c02000.serial: failed to request DMA
<a id="__codelineno-76-78" name="__codelineno-76-78" href="#__codelineno-76-78"></a>
<a id="__codelineno-76-79" name="__codelineno-76-79" href="#__codelineno-76-79"></a>Poky (Yocto Project Reference Distro) 5.1.4 agilex5_dk_a5e065bb32aes1 /dev/ttyS0
<a id="__codelineno-76-80" name="__codelineno-76-80" href="#__codelineno-76-80"></a>
<a id="__codelineno-76-81" name="__codelineno-76-81" href="#__codelineno-76-81"></a>agilex5_dk_a5e065bb32aes1 login: 
</code></pre></div>
<h2 id="notices-disclaimers">Notices &amp; Disclaimers<a class="headerlink" href="#notices-disclaimers" title="Permanent link">&para;</a></h2>
<p>Altera<sup>&reg;</sup> Corporation technologies may require enabled hardware, software or service activation.
No product or component can be absolutely secure. 
Performance varies by use, configuration and other factors.
Your costs and results may vary. 
You may not use or facilitate the use of this document in connection with any infringement or other legal analysis concerning Altera or Intel products described herein. You agree to grant Altera Corporation a non-exclusive, royalty-free license to any patent claim thereafter drafted which includes subject matter disclosed herein.
No license (express or implied, by estoppel or otherwise) to any intellectual property rights is granted by this document, with the sole exception that you may publish an unmodified copy. You may create software implementations based on this document and in compliance with the foregoing that are intended to execute on the Altera or Intel product(s) referenced in this document. No rights are granted to create modifications or derivatives of this document.
The products described may contain design defects or errors known as errata which may cause the product to deviate from published specifications.  Current characterized errata are available on request.
Altera disclaims all express and implied warranties, including without limitation, the implied warranties of merchantability, fitness for a particular purpose, and non-infringement, as well as any warranty arising from course of performance, course of dealing, or usage in trade.
You are responsible for safety of the overall system, including compliance with applicable safety-related requirements or standards. 
<sup>&copy;</sup> Altera Corporation.  Altera, the Altera logo, and other Altera marks are trademarks of Altera Corporation.  Other names and brands may be claimed as the property of others. </p>
<p>OpenCL* and the OpenCL* logo are trademarks of Apple Inc. used by permission of the Khronos Group™. </p>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">August 25, 2025</span>
      
        <br>
        Created:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">June 1, 2024</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../gsrd_zephyr/ug-zgsrd-agx5e-premium/" class="md-footer__link md-footer__link--prev" aria-label="Previous: HPS Zephyr GSRD User Guide" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                HPS Zephyr GSRD User Guide
              </div>
            </div>
          </a>
        
        
          
          <a href="../../tsn/rgmii-hps/ug-tsncfg1-agx5e-premium/" class="md-footer__link md-footer__link--next" aria-label="Next: TSN - HPS RGMII System" rel="next">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                TSN - HPS RGMII System
              </div>
            </div>
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.altera.com" target="_blank" rel="noopener" title="www.altera.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2m-5.15 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95a8.03 8.03 0 0 1-4.33 3.56M14.34 14H9.66c-.1-.66-.16-1.32-.16-2 0-.68.06-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2M12 19.96c-.83-1.2-1.5-2.53-1.91-3.96h3.82c-.41 1.43-1.08 2.76-1.91 3.96M8 8H5.08A7.923 7.923 0 0 1 9.4 4.44C8.8 5.55 8.35 6.75 8 8m-2.92 8H8c.35 1.25.8 2.45 1.4 3.56A8.008 8.008 0 0 1 5.08 16m-.82-2C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2M12 4.03c.83 1.2 1.5 2.54 1.91 3.97h-3.82c.41-1.43 1.08-2.77 1.91-3.97M18.92 8h-2.95a15.65 15.65 0 0 0-1.38-3.56c1.84.63 3.37 1.9 4.33 3.56M12 2C6.47 2 2 6.5 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2Z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/altera-fpga" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/altera-fpga/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://community.intel.com/t5/FPGA/ct-p/fpga" target="_blank" rel="noopener" title="Need Help" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11 18h2v-2h-2v2m1-16A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m0-14a4 4 0 0 0-4 4h2a2 2 0 0 1 2-2 2 2 0 0 1 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5a4 4 0 0 0-4-4Z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.top", "navigation.indexes", "navigation.footer", "navigation.path", "navigation.tabs", "navigation.tabs.sticky", "search.suggest", "search.highlight", "content.code.copy", "navigation.indexes", "toc.follow"], "search": "../../../../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
  <script defer src="https://cloud.umami.is/script.js" data-website-id="95a45ca2-f7f4-47e3-ab82-76a7057c6f0f"></script>
  
      <script src="../../../../../../assets/javascripts/bundle.fac441b0.min.js"></script>
      
        <script src="https://unpkg.com/tablefilter@0.7.3/dist/tablefilter/tablefilter.js"></script>
      
        <script src="../../../../../../assets/tables.js"></script>
      
        <script src="../../../../../../assets/extra.js"></script>
      
    
  <!-- Floating Need Help Button -->
  <a href="https://community.intel.com/t5/FPGA/ct-p/fpga" class="floating-help-button" target="_blank" aria-label="Ask a question in the FPGA Forum">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="10"></circle>
      <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
      <line x1="12" y1="17" x2="12.01" y2="17"></line>
    </svg>
    <span>Ask in the Forum</span>
  </a>

  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>